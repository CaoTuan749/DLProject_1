PYTHONPATH=~/tmp/miniconda3/envs/MaProject/bin/python:
[I 2025-03-01 00:18:34,198] A new study created in memory with name: no-name-e2304319-ceb3-44b3-93f2-5fa21b0990dd
[I 2025-03-01 00:24:55,892] Trial 0 finished with value: 0.03757668381172513 and parameters: {'lr': 1.965214645613721e-05, 'weight_decay': 0.00018814080933920354}. Best is trial 0 with value: 0.03757668381172513.
[I 2025-03-01 00:31:16,772] Trial 1 finished with value: 0.01583357877444498 and parameters: {'lr': 0.0005886277755814633, 'weight_decay': 0.00019198548266638642}. Best is trial 1 with value: 0.01583357877444498.
[I 2025-03-01 00:37:36,633] Trial 2 finished with value: 0.01694708357645718 and parameters: {'lr': 0.0006962214228611041, 'weight_decay': 6.0420438555052504e-05}. Best is trial 1 with value: 0.01583357877444498.
[I 2025-03-01 00:43:56,904] Trial 3 finished with value: 0.006062990253566466 and parameters: {'lr': 0.00025293507668518287, 'weight_decay': 3.771799844483477e-06}. Best is trial 3 with value: 0.006062990253566466.
[I 2025-03-01 00:50:18,159] Trial 4 finished with value: 0.009866360154052334 and parameters: {'lr': 0.0003399623257310327, 'weight_decay': 2.4852197475589082e-05}. Best is trial 3 with value: 0.006062990253566466.
[I 2025-03-01 00:56:38,773] Trial 5 finished with value: 0.009251966458014934 and parameters: {'lr': 0.0001280539800733957, 'weight_decay': 2.338749806430255e-06}. Best is trial 3 with value: 0.006062990253566466.
[I 2025-03-01 01:02:59,850] Trial 6 finished with value: 0.013757869014784414 and parameters: {'lr': 8.531598287045723e-05, 'weight_decay': 2.3380973060684593e-05}. Best is trial 3 with value: 0.006062990253566466.
[I 2025-03-01 01:09:20,914] Trial 7 finished with value: 0.046558546998153726 and parameters: {'lr': 0.0007726001549515403, 'weight_decay': 0.0014513621971354584}. Best is trial 3 with value: 0.006062990253566466.
[I 2025-03-01 01:15:40,729] Trial 8 finished with value: 0.011295785017344835 and parameters: {'lr': 0.0001395552766331619, 'weight_decay': 0.00015743022825588635}. Best is trial 3 with value: 0.006062990253566466.
[I 2025-03-01 01:22:00,686] Trial 9 finished with value: 0.024358617511415295 and parameters: {'lr': 0.00029010156359094693, 'weight_decay': 0.004385393076565819}. Best is trial 3 with value: 0.006062990253566466.
[I 2025-03-01 01:25:48,693] A new study created in memory with name: no-name-4cee5064-14d6-4459-aa50-158ba7430934
[I 2025-03-01 01:43:46,666] Trial 0 finished with value: 0.02637477489766078 and parameters: {'lr': 0.00015006283219029526, 'weight_decay': 3.207667131744955e-05}. Best is trial 0 with value: 0.02637477489766078.
[I 2025-03-01 02:01:39,812] Trial 1 finished with value: 0.025350210603834578 and parameters: {'lr': 0.0005320426576742785, 'weight_decay': 1.2776143711441979e-05}. Best is trial 1 with value: 0.025350210603834578.
[I 2025-03-01 02:19:28,905] Trial 2 finished with value: 0.029008843595770537 and parameters: {'lr': 5.9956254049937906e-05, 'weight_decay': 0.00028982591222671356}. Best is trial 1 with value: 0.025350210603834578.
[I 2025-03-01 02:37:19,371] Trial 3 finished with value: 0.028059036767512546 and parameters: {'lr': 0.0004692162583141367, 'weight_decay': 3.832788634797089e-05}. Best is trial 1 with value: 0.025350210603834578.
[I 2025-03-01 02:55:09,386] Trial 4 finished with value: 0.030823379136176943 and parameters: {'lr': 9.020281956159569e-05, 'weight_decay': 0.00016116191739324435}. Best is trial 1 with value: 0.025350210603834578.
[I 2025-03-01 03:12:50,788] Trial 5 finished with value: 0.09127704773082174 and parameters: {'lr': 0.0008566721791982127, 'weight_decay': 0.006316320709395388}. Best is trial 1 with value: 0.025350210603834578.
[I 2025-03-01 03:30:38,345] Trial 6 finished with value: 0.044180420614061765 and parameters: {'lr': 1.20235179918085e-05, 'weight_decay': 0.00015947595505417893}. Best is trial 1 with value: 0.025350210603834578.
[I 2025-03-01 03:48:26,225] Trial 7 finished with value: 0.034795040118872 and parameters: {'lr': 1.256417947822955e-05, 'weight_decay': 7.70003668489113e-05}. Best is trial 1 with value: 0.025350210603834578.
[I 2025-03-01 04:06:16,109] Trial 8 finished with value: 0.028653309822360848 and parameters: {'lr': 3.5710025383279234e-05, 'weight_decay': 0.000510083894319613}. Best is trial 1 with value: 0.025350210603834578.
[I 2025-03-01 04:24:08,608] Trial 9 finished with value: 0.02868401942262493 and parameters: {'lr': 4.052666063212486e-05, 'weight_decay': 1.3499684770290673e-05}. Best is trial 1 with value: 0.025350210603834578.
Loaded configuration:
{'experiment': {'reproducibility': True, 'seed': 42, 'num_trials': 10, 'num_epochs': 10, 'final_epochs': 5, 'save_model': True, 'model_save_path': 'final_model.pth', 'continual_learning': True, 'continual_method': 'baseline', 'task_list': [[0, 1], [2, 3]], 'suggest': {'lr': {'low': '1e-5', 'high': '1e-3', 'log': True}, 'weight_decay': {'low': '1e-6', 'high': '1e-2', 'log': True}}}, 'model': {'type': 'resnet50', 'lr': '1e-4', 'weight_decay': '1e-4'}, 'dataset': {'path': '/home/anhcao/tmp/Dataset/Wafermap-dataset/WM811K.pkl'}}
[INFO] Reproducibility enabled. Seed set to 42
[INFO] Using device: cuda
[INFO] Number of classes: 8
[INFO] Classes: ['Center' 'Donut' 'Edge-Loc' 'Edge-Ring' 'Loc' 'Near-full' 'Random'
 'Scratch']
[INFO] Running continual learning training with HPO per task...
[INFO] Starting Task 0 with classes: [0, 1]
[DEBUG] Creating ResNet50 with lr=1.965214645613721e-05, weight_decay=0.00018814080933920354
[DEBUG] Creating ResNet50 with lr=1.965214645613721e-05, weight_decay=0.00018814080933920354
[DEBUG] Creating ResNet50 with lr=1.965214645613721e-05, weight_decay=0.00018814080933920354
[DEBUG] Creating ResNet50 with lr=0.0005886277755814633, weight_decay=0.00019198548266638642
[DEBUG] Creating ResNet50 with lr=0.0005886277755814633, weight_decay=0.00019198548266638642
[DEBUG] Creating ResNet50 with lr=0.0005886277755814633, weight_decay=0.00019198548266638642
[DEBUG] Creating ResNet50 with lr=0.0006962214228611041, weight_decay=6.0420438555052504e-05
[DEBUG] Creating ResNet50 with lr=0.0006962214228611041, weight_decay=6.0420438555052504e-05
[DEBUG] Creating ResNet50 with lr=0.0006962214228611041, weight_decay=6.0420438555052504e-05
[DEBUG] Creating ResNet50 with lr=0.00025293507668518287, weight_decay=3.771799844483477e-06
[DEBUG] Creating ResNet50 with lr=0.00025293507668518287, weight_decay=3.771799844483477e-06
[DEBUG] Creating ResNet50 with lr=0.00025293507668518287, weight_decay=3.771799844483477e-06
[DEBUG] Creating ResNet50 with lr=0.0003399623257310327, weight_decay=2.4852197475589082e-05
[DEBUG] Creating ResNet50 with lr=0.0003399623257310327, weight_decay=2.4852197475589082e-05
[DEBUG] Creating ResNet50 with lr=0.0003399623257310327, weight_decay=2.4852197475589082e-05
[DEBUG] Creating ResNet50 with lr=0.0001280539800733957, weight_decay=2.338749806430255e-06
[DEBUG] Creating ResNet50 with lr=0.0001280539800733957, weight_decay=2.338749806430255e-06
[DEBUG] Creating ResNet50 with lr=0.0001280539800733957, weight_decay=2.338749806430255e-06
[DEBUG] Creating ResNet50 with lr=8.531598287045723e-05, weight_decay=2.3380973060684593e-05
[DEBUG] Creating ResNet50 with lr=8.531598287045723e-05, weight_decay=2.3380973060684593e-05
[DEBUG] Creating ResNet50 with lr=8.531598287045723e-05, weight_decay=2.3380973060684593e-05
[DEBUG] Creating ResNet50 with lr=0.0007726001549515403, weight_decay=0.0014513621971354584
[DEBUG] Creating ResNet50 with lr=0.0007726001549515403, weight_decay=0.0014513621971354584
[DEBUG] Creating ResNet50 with lr=0.0007726001549515403, weight_decay=0.0014513621971354584
[DEBUG] Creating ResNet50 with lr=0.0001395552766331619, weight_decay=0.00015743022825588635
[DEBUG] Creating ResNet50 with lr=0.0001395552766331619, weight_decay=0.00015743022825588635
[DEBUG] Creating ResNet50 with lr=0.0001395552766331619, weight_decay=0.00015743022825588635
[DEBUG] Creating ResNet50 with lr=0.00029010156359094693, weight_decay=0.004385393076565819
[DEBUG] Creating ResNet50 with lr=0.00029010156359094693, weight_decay=0.004385393076565819
[DEBUG] Creating ResNet50 with lr=0.00029010156359094693, weight_decay=0.004385393076565819
[INFO] Best hyperparameters for Task 0: lr=0.00025293507668518287, weight_decay=3.771799844483477e-06
[DEBUG] Creating ResNet50 with lr=0.00025293507668518287, weight_decay=3.771799844483477e-06
[Task 0 Final Epoch 1] Train Loss: 0.0808 | Val Loss: 0.2136
[Task 0 Final Epoch 2] Train Loss: 0.0120 | Val Loss: 0.0948
[Task 0 Final Epoch 3] Train Loss: 0.0092 | Val Loss: 0.0921
[Task 0 Final Epoch 4] Train Loss: 0.0028 | Val Loss: 0.1641
[Task 0 Final Epoch 5] Train Loss: 0.0055 | Val Loss: 0.1298
[Task 0 Final Epoch 6] Train Loss: 0.0243 | Val Loss: 0.1550
[Task 0 Final Epoch 7] Train Loss: 0.0039 | Val Loss: 0.1980
[Task 0 Final Epoch 8] Train Loss: 0.0009 | Val Loss: 0.2054
[Task 0 Final Epoch 9] Train Loss: 0.0002 | Val Loss: 0.1797
[Task 0 Final Epoch 10] Train Loss: 0.0001 | Val Loss: 0.1894
[INFO] Model checkpoint saved to networkModel/baseline/20250301_012457/task0/model_20250301_012457.pth
[INFO] Starting Task 1 with new classes: [2, 3]
[DEBUG] Creating ResNet50 with lr=0.00015006283219029526, weight_decay=3.207667131744955e-05
[DEBUG] Creating ResNet50 with lr=0.00015006283219029526, weight_decay=3.207667131744955e-05
[DEBUG] Creating ResNet50 with lr=0.00015006283219029526, weight_decay=3.207667131744955e-05
[DEBUG] Creating ResNet50 with lr=0.0005320426576742785, weight_decay=1.2776143711441979e-05
[DEBUG] Creating ResNet50 with lr=0.0005320426576742785, weight_decay=1.2776143711441979e-05
[DEBUG] Creating ResNet50 with lr=0.0005320426576742785, weight_decay=1.2776143711441979e-05
[DEBUG] Creating ResNet50 with lr=5.9956254049937906e-05, weight_decay=0.00028982591222671356
[DEBUG] Creating ResNet50 with lr=5.9956254049937906e-05, weight_decay=0.00028982591222671356
[DEBUG] Creating ResNet50 with lr=5.9956254049937906e-05, weight_decay=0.00028982591222671356
[DEBUG] Creating ResNet50 with lr=0.0004692162583141367, weight_decay=3.832788634797089e-05
[DEBUG] Creating ResNet50 with lr=0.0004692162583141367, weight_decay=3.832788634797089e-05
[DEBUG] Creating ResNet50 with lr=0.0004692162583141367, weight_decay=3.832788634797089e-05
[DEBUG] Creating ResNet50 with lr=9.020281956159569e-05, weight_decay=0.00016116191739324435
[DEBUG] Creating ResNet50 with lr=9.020281956159569e-05, weight_decay=0.00016116191739324435
[DEBUG] Creating ResNet50 with lr=9.020281956159569e-05, weight_decay=0.00016116191739324435
[DEBUG] Creating ResNet50 with lr=0.0008566721791982127, weight_decay=0.006316320709395388
[DEBUG] Creating ResNet50 with lr=0.0008566721791982127, weight_decay=0.006316320709395388
[DEBUG] Creating ResNet50 with lr=0.0008566721791982127, weight_decay=0.006316320709395388
[DEBUG] Creating ResNet50 with lr=1.20235179918085e-05, weight_decay=0.00015947595505417893
[DEBUG] Creating ResNet50 with lr=1.20235179918085e-05, weight_decay=0.00015947595505417893
[DEBUG] Creating ResNet50 with lr=1.20235179918085e-05, weight_decay=0.00015947595505417893
[DEBUG] Creating ResNet50 with lr=1.256417947822955e-05, weight_decay=7.70003668489113e-05
[DEBUG] Creating ResNet50 with lr=1.256417947822955e-05, weight_decay=7.70003668489113e-05
[DEBUG] Creating ResNet50 with lr=1.256417947822955e-05, weight_decay=7.70003668489113e-05
[DEBUG] Creating ResNet50 with lr=3.5710025383279234e-05, weight_decay=0.000510083894319613
[DEBUG] Creating ResNet50 with lr=3.5710025383279234e-05, weight_decay=0.000510083894319613
[DEBUG] Creating ResNet50 with lr=3.5710025383279234e-05, weight_decay=0.000510083894319613
[DEBUG] Creating ResNet50 with lr=4.052666063212486e-05, weight_decay=1.3499684770290673e-05
[DEBUG] Creating ResNet50 with lr=4.052666063212486e-05, weight_decay=1.3499684770290673e-05
[DEBUG] Creating ResNet50 with lr=4.052666063212486e-05, weight_decay=1.3499684770290673e-05
[INFO] Best hyperparameters for Task 1: lr=0.0005320426576742785, weight_decay=1.2776143711441979e-05
[Task 1 Final Epoch 1] Train Loss: 1.1004 | Val Loss: 0.5748
[Task 1 Final Epoch 2] Train Loss: 0.2354 | Val Loss: 0.4820
[Task 1 Final Epoch 3] Train Loss: 0.1883 | Val Loss: 0.4364
[Task 1 Final Epoch 4] Train Loss: 0.1668 | Val Loss: 0.4125
[Task 1 Final Epoch 5] Train Loss: 0.1500 | Val Loss: 0.3928
[Task 1 Final Epoch 6] Train Loss: 0.1368 | Val Loss: 0.3834
[Task 1 Final Epoch 7] Train Loss: 0.1294 | Val Loss: 0.3750
[Task 1 Final Epoch 8] Train Loss: 0.1227 | Val Loss: 0.3642
[Task 1 Final Epoch 9] Train Loss: 0.1188 | Val Loss: 0.3582
[Task 1 Final Epoch 10] Train Loss: 0.1124 | Val Loss: 0.3523
[INFO] Model checkpoint saved to networkModel/baseline/20250301_043236/task1/model_20250301_043236.pth
[INFO] Continual learning training complete.
