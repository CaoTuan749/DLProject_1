PYTHONPATH=~/tmp/miniconda3/envs/MaProject/bin/python:
[I 2025-03-01 21:44:56,102] A new study created in memory with name: no-name-bfe21391-72eb-4d64-8c4c-0494d01c5a32
[I 2025-03-01 21:47:25,307] Trial 0 finished with value: 0.03673586377962714 and parameters: {'lr': 2.1256991224881815e-05, 'weight_decay': 1.0999564170023402e-06}. Best is trial 0 with value: 0.03673586377962714.
[I 2025-03-01 21:49:53,562] Trial 1 finished with value: 0.04270817118415993 and parameters: {'lr': 1.582486107075411e-05, 'weight_decay': 0.0010601107036182541}. Best is trial 0 with value: 0.03673586377962714.
[I 2025-03-01 21:52:21,557] Trial 2 finished with value: 0.01775158619432385 and parameters: {'lr': 7.617382381416862e-05, 'weight_decay': 8.024820150800609e-05}. Best is trial 2 with value: 0.01775158619432385.
[I 2025-03-01 21:54:49,451] Trial 3 finished with value: 0.011496946180924415 and parameters: {'lr': 0.00024302409626857397, 'weight_decay': 0.000216235920471775}. Best is trial 3 with value: 0.011496946180924415.
[I 2025-03-01 21:57:17,291] Trial 4 finished with value: 0.042784484214193765 and parameters: {'lr': 2.138383979743938e-05, 'weight_decay': 0.004502842219767888}. Best is trial 3 with value: 0.011496946180924415.
[I 2025-03-01 21:59:45,218] Trial 5 finished with value: 0.03685231461367083 and parameters: {'lr': 3.107646081540568e-05, 'weight_decay': 6.75025621626315e-05}. Best is trial 3 with value: 0.011496946180924415.
[I 2025-03-01 22:02:13,163] Trial 6 finished with value: 0.04279451237414919 and parameters: {'lr': 1.4387056932591172e-05, 'weight_decay': 0.0005300143303642368}. Best is trial 3 with value: 0.011496946180924415.
[I 2025-03-01 22:04:41,237] Trial 7 finished with value: 0.014985298676341094 and parameters: {'lr': 0.0009014420890072354, 'weight_decay': 1.100699429008875e-06}. Best is trial 3 with value: 0.011496946180924415.
[I 2025-03-01 22:07:09,250] Trial 8 finished with value: 0.005131062421862716 and parameters: {'lr': 0.00011562226651096382, 'weight_decay': 0.00012985655739872367}. Best is trial 8 with value: 0.005131062421862716.
[I 2025-03-01 22:09:37,248] Trial 9 finished with value: 0.021260871751038062 and parameters: {'lr': 5.4059087996232404e-05, 'weight_decay': 6.441566607134929e-05}. Best is trial 8 with value: 0.005131062421862716.
[I 2025-03-01 22:11:17,865] A new study created in memory with name: no-name-8032432f-5e5b-4e17-bd04-b06792399dc7
[I 2025-03-01 22:18:16,326] Trial 0 finished with value: 0.03888157969099823 and parameters: {'lr': 1.1002531334472477e-05, 'weight_decay': 0.006445761979597775}. Best is trial 0 with value: 0.03888157969099823.
[I 2025-03-01 22:25:13,926] Trial 1 finished with value: 0.038589704013697206 and parameters: {'lr': 1.3796776408622606e-05, 'weight_decay': 0.0004600115342126069}. Best is trial 1 with value: 0.038589704013697206.
[I 2025-03-01 22:32:11,474] Trial 2 finished with value: 0.035114443750554246 and parameters: {'lr': 2.2140077755843727e-05, 'weight_decay': 0.008411435579297877}. Best is trial 2 with value: 0.035114443750554246.
[I 2025-03-01 22:39:08,535] Trial 3 finished with value: 0.05161373954952434 and parameters: {'lr': 0.00044925360427483106, 'weight_decay': 0.0033573566952859995}. Best is trial 2 with value: 0.035114443750554246.
[I 2025-03-01 22:46:05,962] Trial 4 finished with value: 0.03239699943665544 and parameters: {'lr': 2.187219752013044e-05, 'weight_decay': 1.1985711863014666e-06}. Best is trial 4 with value: 0.03239699943665544.
[I 2025-03-01 22:53:03,412] Trial 5 finished with value: 0.027764306103092856 and parameters: {'lr': 7.220571004077061e-05, 'weight_decay': 1.5426722884475603e-06}. Best is trial 5 with value: 0.027764306103092856.
[I 2025-03-01 23:00:01,015] Trial 6 finished with value: 0.02832204561247803 and parameters: {'lr': 7.735202887764905e-05, 'weight_decay': 1.7288076836967535e-06}. Best is trial 5 with value: 0.027764306103092856.
[I 2025-03-01 23:06:58,348] Trial 7 finished with value: 0.041383408530613265 and parameters: {'lr': 0.0008488914869314243, 'weight_decay': 0.0004886574416483139}. Best is trial 5 with value: 0.027764306103092856.
[I 2025-03-01 23:13:55,826] Trial 8 finished with value: 0.026430227046879463 and parameters: {'lr': 0.0002721678436374287, 'weight_decay': 4.337233605681799e-06}. Best is trial 8 with value: 0.026430227046879463.
[I 2025-03-01 23:20:53,264] Trial 9 finished with value: 0.03382982284960107 and parameters: {'lr': 0.0008982032012219941, 'weight_decay': 1.5123705632193478e-06}. Best is trial 8 with value: 0.026430227046879463.
Loaded configuration:
{'experiment': {'reproducibility': True, 'seed': 42, 'num_trials': 10, 'num_epochs': 10, 'final_epochs': 5, 'save_model': True, 'model_save_path': 'final_model.pth', 'continual_learning': True, 'continual_method': 'baseline', 'task_list': [[0, 1], [2, 3]], 'suggest': {'lr': {'low': '1e-5', 'high': '1e-3', 'log': True}, 'weight_decay': {'low': '1e-6', 'high': '1e-2', 'log': True}}}, 'model': {'type': 'resnet50', 'lr': '1e-4', 'weight_decay': '1e-4'}, 'dataset': {'path': '/home/anhcao/tmp/Dataset/Wafermap-dataset/WM811K.pkl'}}
[INFO] Reproducibility enabled. Seed set to 42
[INFO] Using device: cuda
[INFO] Number of classes: 8
[INFO] Classes: ['Center' 'Donut' 'Edge-Loc' 'Edge-Ring' 'Loc' 'Near-full' 'Random'
 'Scratch']
[INFO] Running continual learning training with HPO per task...
[INFO] Starting Task 0 with classes: [0, 1]
[DEBUG] Creating ResNet50 with lr=2.1256991224881815e-05, weight_decay=1.0999564170023402e-06
[DEBUG] Creating ResNet50 with lr=2.1256991224881815e-05, weight_decay=1.0999564170023402e-06
[DEBUG] Creating ResNet50 with lr=2.1256991224881815e-05, weight_decay=1.0999564170023402e-06
[DEBUG] Creating ResNet50 with lr=1.582486107075411e-05, weight_decay=0.0010601107036182541
[DEBUG] Creating ResNet50 with lr=1.582486107075411e-05, weight_decay=0.0010601107036182541
[DEBUG] Creating ResNet50 with lr=1.582486107075411e-05, weight_decay=0.0010601107036182541
[DEBUG] Creating ResNet50 with lr=7.617382381416862e-05, weight_decay=8.024820150800609e-05
[DEBUG] Creating ResNet50 with lr=7.617382381416862e-05, weight_decay=8.024820150800609e-05
[DEBUG] Creating ResNet50 with lr=7.617382381416862e-05, weight_decay=8.024820150800609e-05
[DEBUG] Creating ResNet50 with lr=0.00024302409626857397, weight_decay=0.000216235920471775
[DEBUG] Creating ResNet50 with lr=0.00024302409626857397, weight_decay=0.000216235920471775
[DEBUG] Creating ResNet50 with lr=0.00024302409626857397, weight_decay=0.000216235920471775
[DEBUG] Creating ResNet50 with lr=2.138383979743938e-05, weight_decay=0.004502842219767888
[DEBUG] Creating ResNet50 with lr=2.138383979743938e-05, weight_decay=0.004502842219767888
[DEBUG] Creating ResNet50 with lr=2.138383979743938e-05, weight_decay=0.004502842219767888
[DEBUG] Creating ResNet50 with lr=3.107646081540568e-05, weight_decay=6.75025621626315e-05
[DEBUG] Creating ResNet50 with lr=3.107646081540568e-05, weight_decay=6.75025621626315e-05
[DEBUG] Creating ResNet50 with lr=3.107646081540568e-05, weight_decay=6.75025621626315e-05
[DEBUG] Creating ResNet50 with lr=1.4387056932591172e-05, weight_decay=0.0005300143303642368
[DEBUG] Creating ResNet50 with lr=1.4387056932591172e-05, weight_decay=0.0005300143303642368
[DEBUG] Creating ResNet50 with lr=1.4387056932591172e-05, weight_decay=0.0005300143303642368
[DEBUG] Creating ResNet50 with lr=0.0009014420890072354, weight_decay=1.100699429008875e-06
[DEBUG] Creating ResNet50 with lr=0.0009014420890072354, weight_decay=1.100699429008875e-06
[DEBUG] Creating ResNet50 with lr=0.0009014420890072354, weight_decay=1.100699429008875e-06
[DEBUG] Creating ResNet50 with lr=0.00011562226651096382, weight_decay=0.00012985655739872367
[DEBUG] Creating ResNet50 with lr=0.00011562226651096382, weight_decay=0.00012985655739872367
[DEBUG] Creating ResNet50 with lr=0.00011562226651096382, weight_decay=0.00012985655739872367
[DEBUG] Creating ResNet50 with lr=5.4059087996232404e-05, weight_decay=6.441566607134929e-05
[DEBUG] Creating ResNet50 with lr=5.4059087996232404e-05, weight_decay=6.441566607134929e-05
[DEBUG] Creating ResNet50 with lr=5.4059087996232404e-05, weight_decay=6.441566607134929e-05
[INFO] Best hyperparameters for Task 0: lr=0.00011562226651096382, weight_decay=0.00012985655739872367
[DEBUG] Creating ResNet50 with lr=0.00011562226651096382, weight_decay=0.00012985655739872367
[Task 0 Final Epoch 1] Train Loss: 0.0852 | Val Loss: 0.1498
[Task 0 Final Epoch 2] Train Loss: 0.0096 | Val Loss: 0.0984
[Task 0 Final Epoch 3] Train Loss: 0.0118 | Val Loss: 0.0803
[Task 0 Final Epoch 4] Train Loss: 0.0117 | Val Loss: 0.1131
[Task 0 Final Epoch 5] Train Loss: 0.0089 | Val Loss: 0.1963
[Task 0 Final Epoch 6] Train Loss: 0.0054 | Val Loss: 0.1320
[Task 0 Final Epoch 7] Train Loss: 0.0006 | Val Loss: 0.1904
[Task 0 Final Epoch 8] Train Loss: 0.0002 | Val Loss: 0.2110
[Task 0 Final Epoch 9] Train Loss: 0.0002 | Val Loss: 0.1674
[Task 0 Final Epoch 10] Train Loss: 0.0002 | Val Loss: 0.1849
[INFO] Model checkpoint saved to networkModel/baseline/20250301_221045/task0/model_20250301_221045.pth
[INFO] Starting Task 1 with new classes: [2, 3]
[DEBUG] Creating ResNet50 with lr=1.1002531334472477e-05, weight_decay=0.006445761979597775
[DEBUG] Creating ResNet50 with lr=1.1002531334472477e-05, weight_decay=0.006445761979597775
[DEBUG] Creating ResNet50 with lr=1.1002531334472477e-05, weight_decay=0.006445761979597775
[DEBUG] Creating ResNet50 with lr=1.3796776408622606e-05, weight_decay=0.0004600115342126069
[DEBUG] Creating ResNet50 with lr=1.3796776408622606e-05, weight_decay=0.0004600115342126069
[DEBUG] Creating ResNet50 with lr=1.3796776408622606e-05, weight_decay=0.0004600115342126069
[DEBUG] Creating ResNet50 with lr=2.2140077755843727e-05, weight_decay=0.008411435579297877
[DEBUG] Creating ResNet50 with lr=2.2140077755843727e-05, weight_decay=0.008411435579297877
[DEBUG] Creating ResNet50 with lr=2.2140077755843727e-05, weight_decay=0.008411435579297877
[DEBUG] Creating ResNet50 with lr=0.00044925360427483106, weight_decay=0.0033573566952859995
[DEBUG] Creating ResNet50 with lr=0.00044925360427483106, weight_decay=0.0033573566952859995
[DEBUG] Creating ResNet50 with lr=0.00044925360427483106, weight_decay=0.0033573566952859995
[DEBUG] Creating ResNet50 with lr=2.187219752013044e-05, weight_decay=1.1985711863014666e-06
[DEBUG] Creating ResNet50 with lr=2.187219752013044e-05, weight_decay=1.1985711863014666e-06
[DEBUG] Creating ResNet50 with lr=2.187219752013044e-05, weight_decay=1.1985711863014666e-06
[DEBUG] Creating ResNet50 with lr=7.220571004077061e-05, weight_decay=1.5426722884475603e-06
[DEBUG] Creating ResNet50 with lr=7.220571004077061e-05, weight_decay=1.5426722884475603e-06
[DEBUG] Creating ResNet50 with lr=7.220571004077061e-05, weight_decay=1.5426722884475603e-06
[DEBUG] Creating ResNet50 with lr=7.735202887764905e-05, weight_decay=1.7288076836967535e-06
[DEBUG] Creating ResNet50 with lr=7.735202887764905e-05, weight_decay=1.7288076836967535e-06
[DEBUG] Creating ResNet50 with lr=7.735202887764905e-05, weight_decay=1.7288076836967535e-06
[DEBUG] Creating ResNet50 with lr=0.0008488914869314243, weight_decay=0.0004886574416483139
[DEBUG] Creating ResNet50 with lr=0.0008488914869314243, weight_decay=0.0004886574416483139
[DEBUG] Creating ResNet50 with lr=0.0008488914869314243, weight_decay=0.0004886574416483139
[DEBUG] Creating ResNet50 with lr=0.0002721678436374287, weight_decay=4.337233605681799e-06
[DEBUG] Creating ResNet50 with lr=0.0002721678436374287, weight_decay=4.337233605681799e-06
[DEBUG] Creating ResNet50 with lr=0.0002721678436374287, weight_decay=4.337233605681799e-06
[DEBUG] Creating ResNet50 with lr=0.0008982032012219941, weight_decay=1.5123705632193478e-06
[DEBUG] Creating ResNet50 with lr=0.0008982032012219941, weight_decay=1.5123705632193478e-06
[DEBUG] Creating ResNet50 with lr=0.0008982032012219941, weight_decay=1.5123705632193478e-06
[INFO] Best hyperparameters for Task 1: lr=0.0002721678436374287, weight_decay=4.337233605681799e-06
[Task 1 Final Epoch 1] Train Loss: 1.1938 | Val Loss: 0.5120
[Task 1 Final Epoch 2] Train Loss: 0.2111 | Val Loss: 0.4552
[Task 1 Final Epoch 3] Train Loss: 0.1723 | Val Loss: 0.4204
[Task 1 Final Epoch 4] Train Loss: 0.1546 | Val Loss: 0.4054
[Task 1 Final Epoch 5] Train Loss: 0.1407 | Val Loss: 0.3870
[Task 1 Final Epoch 6] Train Loss: 0.1281 | Val Loss: 0.3740
[Task 1 Final Epoch 7] Train Loss: 0.1215 | Val Loss: 0.3668
[Task 1 Final Epoch 8] Train Loss: 0.1139 | Val Loss: 0.3567
[Task 1 Final Epoch 9] Train Loss: 0.1091 | Val Loss: 0.3432
[Task 1 Final Epoch 10] Train Loss: 0.1035 | Val Loss: 0.3412
[INFO] Model checkpoint saved to networkModel/baseline/20250301_232410/task1/model_20250301_232410.pth
[INFO] Continual learning training complete.
