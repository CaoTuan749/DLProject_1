PYTHONPATH=~/tmp/miniconda3/envs/MaProject/bin/python:
[I 2025-02-22 23:49:40,956] A new study created in RDB with name: resnet_wafer_1740264580
[I 2025-02-23 00:15:09,906] Trial 0 finished with value: 0.9548936170212766 and parameters: {'lr': 0.000421069349754321, 'weight_decay': 0.00014094693395159822}. Best is trial 0 with value: 0.9548936170212766.
[I 2025-02-23 00:39:19,898] Trial 1 finished with value: 0.9446808510638298 and parameters: {'lr': 0.0007299645908074111, 'weight_decay': 4.0050075043898644e-05}. Best is trial 0 with value: 0.9548936170212766.
[I 2025-02-23 01:09:00,300] Trial 2 finished with value: 0.9693617021276595 and parameters: {'lr': 4.96916008831858e-05, 'weight_decay': 0.0013546423468316035}. Best is trial 2 with value: 0.9693617021276595.
[I 2025-02-23 01:38:49,180] Trial 3 finished with value: 0.9538156028368794 and parameters: {'lr': 0.0003295929250116923, 'weight_decay': 0.0011092883352107762}. Best is trial 2 with value: 0.9693617021276595.
[I 2025-02-23 02:07:19,661] Trial 4 finished with value: 0.969872340425532 and parameters: {'lr': 0.00013018976271633227, 'weight_decay': 6.654772060284443e-06}. Best is trial 4 with value: 0.969872340425532.
[I 2025-02-23 02:36:56,854] Trial 5 finished with value: 0.9704964539007094 and parameters: {'lr': 4.305581303186559e-05, 'weight_decay': 0.0006753988845576691}. Best is trial 5 with value: 0.9704964539007094.
[I 2025-02-23 03:04:27,380] Trial 6 finished with value: 0.9707801418439717 and parameters: {'lr': 0.00011072245468859834, 'weight_decay': 9.098464974651897e-05}. Best is trial 6 with value: 0.9707801418439717.
[I 2025-02-23 03:31:54,979] Trial 7 finished with value: 0.9691347517730498 and parameters: {'lr': 3.121708199355511e-05, 'weight_decay': 7.083744795626563e-06}. Best is trial 6 with value: 0.9707801418439717.
[I 2025-02-23 03:57:02,825] Trial 8 finished with value: 0.96822695035461 and parameters: {'lr': 0.00012906033021524275, 'weight_decay': 0.0001742430552590706}. Best is trial 6 with value: 0.9707801418439717.
[I 2025-02-23 04:20:05,018] Trial 9 pruned. 
Loaded configuration:
{'experiment': {'reproducibility': True, 'seed': 42, 'num_trials': 10, 'num_epochs': 10, 'final_epochs': 5, 'save_model': True, 'model_save_path': 'final_model.pth', 'suggest': {'lr': {'low': '1e-5', 'high': '1e-3', 'log': True}, 'weight_decay': {'low': '1e-6', 'high': '1e-2', 'log': True}}}, 'model': {'type': 'resnet50', 'lr': '1e-4', 'weight_decay': '1e-4'}, 'dataset': {'path': '/home/anhcao/tmp/Dataset/Wafermap-dataset/WM811K.pkl'}}
[INFO] Reproducibility enabled. Seed set to 42
[INFO] Using device: cuda
[INFO] Number of classes: 8
[INFO] Classes: ['Center' 'Donut' 'Edge-Loc' 'Edge-Ring' 'Loc' 'Near-full' 'Random'
 'Scratch']
[INFO] Creating Optuna study 'resnet_wafer_1740264580' with DB file: resnet_wafer_v2.db
[INFO] Starting study.optimize with 10 trials...


[OPTUNA] Starting Trial #0 with lr=0.000421, weight_decay=0.000141
[OPTUNA] Trial #0: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.000421069349754321, weight_decay=0.00014094693395159822
[INFO] >>> Starting fold 1 training (Trial #0) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3098, Train Acc: 0.8921 | Val Loss: 0.2784, Val Acc: 0.9001
[Fold 1 Epoch 2/10] Train Loss: 0.1579, Train Acc: 0.9477 | Val Loss: 0.1643, Val Acc: 0.9455
[Fold 1 Epoch 3/10] Train Loss: 0.1218, Train Acc: 0.9591 | Val Loss: 0.1325, Val Acc: 0.9600
[Fold 1 Epoch 4/10] Train Loss: 0.1044, Train Acc: 0.9655 | Val Loss: 0.1327, Val Acc: 0.9626
[Fold 1 Epoch 5/10] Train Loss: 0.0916, Train Acc: 0.9691 | Val Loss: 0.1643, Val Acc: 0.9475
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9626

[OPTUNA] Trial #0: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.000421069349754321, weight_decay=0.00014094693395159822
[INFO] >>> Starting fold 2 training (Trial #0) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2865, Train Acc: 0.9015 | Val Loss: 0.1911, Val Acc: 0.9322
[Fold 2 Epoch 2/10] Train Loss: 0.1569, Train Acc: 0.9462 | Val Loss: 0.2619, Val Acc: 0.9132
[Fold 2 Epoch 3/10] Train Loss: 0.1189, Train Acc: 0.9589 | Val Loss: 0.2264, Val Acc: 0.9322
[INFO] Early stopping on fold 2 at epoch 3
[INFO] <<< Finished fold 2, best val acc = 0.9322

[OPTUNA] Trial #0: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.000421069349754321, weight_decay=0.00014094693395159822
[INFO] >>> Starting fold 3 training (Trial #0) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.2905, Train Acc: 0.8962 | Val Loss: 0.2751, Val Acc: 0.9089
[Fold 3 Epoch 2/10] Train Loss: 0.1449, Train Acc: 0.9518 | Val Loss: 0.1969, Val Acc: 0.9501
[Fold 3 Epoch 3/10] Train Loss: 0.1103, Train Acc: 0.9630 | Val Loss: 0.1238, Val Acc: 0.9580
[Fold 3 Epoch 4/10] Train Loss: 0.0954, Train Acc: 0.9687 | Val Loss: 0.1360, Val Acc: 0.9549
[Fold 3 Epoch 5/10] Train Loss: 0.0779, Train Acc: 0.9735 | Val Loss: 0.2691, Val Acc: 0.9274
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9580

[OPTUNA] Trial #0: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.000421069349754321, weight_decay=0.00014094693395159822
[INFO] >>> Starting fold 4 training (Trial #0) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3046, Train Acc: 0.8959 | Val Loss: 0.2388, Val Acc: 0.9274
[Fold 4 Epoch 2/10] Train Loss: 0.1518, Train Acc: 0.9499 | Val Loss: 0.1563, Val Acc: 0.9450
[Fold 4 Epoch 3/10] Train Loss: 0.1054, Train Acc: 0.9648 | Val Loss: 0.1228, Val Acc: 0.9603
[Fold 4 Epoch 4/10] Train Loss: 0.0909, Train Acc: 0.9693 | Val Loss: 0.2223, Val Acc: 0.9302
[Fold 4 Epoch 5/10] Train Loss: 0.0805, Train Acc: 0.9726 | Val Loss: 0.1438, Val Acc: 0.9529
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9603

[OPTUNA] Trial #0: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.000421069349754321, weight_decay=0.00014094693395159822
[INFO] >>> Starting fold 5 training (Trial #0) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2707, Train Acc: 0.9072 | Val Loss: 0.3624, Val Acc: 0.8721
[Fold 5 Epoch 2/10] Train Loss: 0.1531, Train Acc: 0.9501 | Val Loss: 0.1300, Val Acc: 0.9614
[Fold 5 Epoch 3/10] Train Loss: 0.1161, Train Acc: 0.9604 | Val Loss: 0.1168, Val Acc: 0.9597
[Fold 5 Epoch 4/10] Train Loss: 0.0802, Train Acc: 0.9720 | Val Loss: 0.1620, Val Acc: 0.9455
[Fold 5 Epoch 5/10] Train Loss: 0.0921, Train Acc: 0.9689 | Val Loss: 0.1240, Val Acc: 0.9677
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9614

[OPTUNA] Trial #0 done. Fold Accuracies: [0.9625531914893617, 0.9321985815602837, 0.9580141843971631, 0.9602836879432625, 0.961418439716312]. Avg Acc=0.9549

[OPTUNA] Starting Trial #1 with lr=0.000730, weight_decay=0.000040
[OPTUNA] Trial #1: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0007299645908074111, weight_decay=4.0050075043898644e-05
[INFO] >>> Starting fold 1 training (Trial #1) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3457, Train Acc: 0.8796 | Val Loss: 2.9924, Val Acc: 0.6403
[Fold 1 Epoch 2/10] Train Loss: 0.1935, Train Acc: 0.9339 | Val Loss: 0.1599, Val Acc: 0.9475
[Fold 1 Epoch 3/10] Train Loss: 0.1364, Train Acc: 0.9552 | Val Loss: 0.1499, Val Acc: 0.9498
[Fold 1 Epoch 4/10] Train Loss: 0.1183, Train Acc: 0.9597 | Val Loss: 0.2308, Val Acc: 0.9313
[Fold 1 Epoch 5/10] Train Loss: 0.1060, Train Acc: 0.9645 | Val Loss: 0.1932, Val Acc: 0.9458
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9498

[OPTUNA] Trial #1: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0007299645908074111, weight_decay=4.0050075043898644e-05
[INFO] >>> Starting fold 2 training (Trial #1) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3386, Train Acc: 0.8830 | Val Loss: 0.2189, Val Acc: 0.9288
[Fold 2 Epoch 2/10] Train Loss: 0.1843, Train Acc: 0.9350 | Val Loss: 0.1489, Val Acc: 0.9458
[Fold 2 Epoch 3/10] Train Loss: 0.1408, Train Acc: 0.9523 | Val Loss: 0.2203, Val Acc: 0.9325
[Fold 2 Epoch 4/10] Train Loss: 0.1260, Train Acc: 0.9567 | Val Loss: 0.1789, Val Acc: 0.9387
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9458

[OPTUNA] Trial #1: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0007299645908074111, weight_decay=4.0050075043898644e-05
[INFO] >>> Starting fold 3 training (Trial #1) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3381, Train Acc: 0.8823 | Val Loss: 0.2074, Val Acc: 0.9384
[Fold 3 Epoch 2/10] Train Loss: 0.1786, Train Acc: 0.9405 | Val Loss: 0.3035, Val Acc: 0.9072
[Fold 3 Epoch 3/10] Train Loss: 0.1492, Train Acc: 0.9495 | Val Loss: 0.2208, Val Acc: 0.9316
[INFO] Early stopping on fold 3 at epoch 3
[INFO] <<< Finished fold 3, best val acc = 0.9384

[OPTUNA] Trial #1: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0007299645908074111, weight_decay=4.0050075043898644e-05
[INFO] >>> Starting fold 4 training (Trial #1) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3373, Train Acc: 0.8811 | Val Loss: 0.4465, Val Acc: 0.8406
[Fold 4 Epoch 2/10] Train Loss: 0.1889, Train Acc: 0.9348 | Val Loss: 0.2445, Val Acc: 0.9271
[Fold 4 Epoch 3/10] Train Loss: 0.1332, Train Acc: 0.9548 | Val Loss: 0.2313, Val Acc: 0.9260
[Fold 4 Epoch 4/10] Train Loss: 0.1175, Train Acc: 0.9611 | Val Loss: 0.1432, Val Acc: 0.9523
[Fold 4 Epoch 5/10] Train Loss: 0.0998, Train Acc: 0.9671 | Val Loss: 0.1907, Val Acc: 0.9438
[Fold 4 Epoch 6/10] Train Loss: 0.0979, Train Acc: 0.9677 | Val Loss: 0.1664, Val Acc: 0.9481
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9523

[OPTUNA] Trial #1: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0007299645908074111, weight_decay=4.0050075043898644e-05
[INFO] >>> Starting fold 5 training (Trial #1) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3213, Train Acc: 0.8848 | Val Loss: 0.4010, Val Acc: 0.8777
[Fold 5 Epoch 2/10] Train Loss: 0.1846, Train Acc: 0.9350 | Val Loss: 0.1728, Val Acc: 0.9370
[Fold 5 Epoch 3/10] Train Loss: 0.1258, Train Acc: 0.9582 | Val Loss: 0.4173, Val Acc: 0.8712
[Fold 5 Epoch 4/10] Train Loss: 0.1216, Train Acc: 0.9576 | Val Loss: 0.1770, Val Acc: 0.9393
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9370

[OPTUNA] Trial #1 done. Fold Accuracies: [0.9497872340425532, 0.9458156028368795, 0.9384397163120567, 0.9523404255319149, 0.9370212765957446]. Avg Acc=0.9447

[OPTUNA] Starting Trial #2 with lr=0.000050, weight_decay=0.001355
[OPTUNA] Trial #2: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=4.96916008831858e-05, weight_decay=0.0013546423468316035
[INFO] >>> Starting fold 1 training (Trial #2) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3288, Train Acc: 0.8921 | Val Loss: 0.1548, Val Acc: 0.9560
[Fold 1 Epoch 2/10] Train Loss: 0.0744, Train Acc: 0.9779 | Val Loss: 0.1244, Val Acc: 0.9611
[Fold 1 Epoch 3/10] Train Loss: 0.0379, Train Acc: 0.9882 | Val Loss: 0.1047, Val Acc: 0.9699
[Fold 1 Epoch 4/10] Train Loss: 0.0238, Train Acc: 0.9931 | Val Loss: 0.1222, Val Acc: 0.9674
[Fold 1 Epoch 5/10] Train Loss: 0.0164, Train Acc: 0.9955 | Val Loss: 0.0996, Val Acc: 0.9705
[Fold 1 Epoch 6/10] Train Loss: 0.0225, Train Acc: 0.9933 | Val Loss: 0.1554, Val Acc: 0.9569
[Fold 1 Epoch 7/10] Train Loss: 0.0202, Train Acc: 0.9941 | Val Loss: 0.1056, Val Acc: 0.9711
[INFO] Early stopping on fold 1 at epoch 7
[INFO] <<< Finished fold 1, best val acc = 0.9705

[OPTUNA] Trial #2: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=4.96916008831858e-05, weight_decay=0.0013546423468316035
[INFO] >>> Starting fold 2 training (Trial #2) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3345, Train Acc: 0.8869 | Val Loss: 0.1390, Val Acc: 0.9532
[Fold 2 Epoch 2/10] Train Loss: 0.0806, Train Acc: 0.9760 | Val Loss: 0.0943, Val Acc: 0.9671
[Fold 2 Epoch 3/10] Train Loss: 0.0357, Train Acc: 0.9894 | Val Loss: 0.1028, Val Acc: 0.9674
[Fold 2 Epoch 4/10] Train Loss: 0.0298, Train Acc: 0.9919 | Val Loss: 0.0772, Val Acc: 0.9730
[Fold 2 Epoch 5/10] Train Loss: 0.0129, Train Acc: 0.9965 | Val Loss: 0.1289, Val Acc: 0.9645
[Fold 2 Epoch 6/10] Train Loss: 0.0145, Train Acc: 0.9957 | Val Loss: 0.1130, Val Acc: 0.9643
[INFO] Early stopping on fold 2 at epoch 6
[INFO] <<< Finished fold 2, best val acc = 0.9730

[OPTUNA] Trial #2: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=4.96916008831858e-05, weight_decay=0.0013546423468316035
[INFO] >>> Starting fold 3 training (Trial #2) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3287, Train Acc: 0.8909 | Val Loss: 0.1258, Val Acc: 0.9617
[Fold 3 Epoch 2/10] Train Loss: 0.0782, Train Acc: 0.9753 | Val Loss: 0.1170, Val Acc: 0.9643
[Fold 3 Epoch 3/10] Train Loss: 0.0383, Train Acc: 0.9885 | Val Loss: 0.1030, Val Acc: 0.9662
[Fold 3 Epoch 4/10] Train Loss: 0.0218, Train Acc: 0.9940 | Val Loss: 0.1044, Val Acc: 0.9739
[Fold 3 Epoch 5/10] Train Loss: 0.0154, Train Acc: 0.9957 | Val Loss: 0.1067, Val Acc: 0.9682
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9739

[OPTUNA] Trial #2: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=4.96916008831858e-05, weight_decay=0.0013546423468316035
[INFO] >>> Starting fold 4 training (Trial #2) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3159, Train Acc: 0.8967 | Val Loss: 0.1578, Val Acc: 0.9521
[Fold 4 Epoch 2/10] Train Loss: 0.0768, Train Acc: 0.9757 | Val Loss: 0.1123, Val Acc: 0.9660
[Fold 4 Epoch 3/10] Train Loss: 0.0322, Train Acc: 0.9906 | Val Loss: 0.1107, Val Acc: 0.9671
[Fold 4 Epoch 4/10] Train Loss: 0.0208, Train Acc: 0.9943 | Val Loss: 0.0926, Val Acc: 0.9694
[Fold 4 Epoch 5/10] Train Loss: 0.0229, Train Acc: 0.9933 | Val Loss: 0.1476, Val Acc: 0.9623
[Fold 4 Epoch 6/10] Train Loss: 0.0323, Train Acc: 0.9906 | Val Loss: 0.1872, Val Acc: 0.9506
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9694

[OPTUNA] Trial #2: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=4.96916008831858e-05, weight_decay=0.0013546423468316035
[INFO] >>> Starting fold 5 training (Trial #2) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3315, Train Acc: 0.8896 | Val Loss: 0.1153, Val Acc: 0.9580
[Fold 5 Epoch 2/10] Train Loss: 0.0745, Train Acc: 0.9758 | Val Loss: 0.1239, Val Acc: 0.9600
[Fold 5 Epoch 3/10] Train Loss: 0.0384, Train Acc: 0.9886 | Val Loss: 0.1198, Val Acc: 0.9657
[INFO] Early stopping on fold 5 at epoch 3
[INFO] <<< Finished fold 5, best val acc = 0.9600

[OPTUNA] Trial #2 done. Fold Accuracies: [0.9704964539007093, 0.9730496453900709, 0.9739007092198582, 0.9693617021276596, 0.96]. Avg Acc=0.9694

[OPTUNA] Starting Trial #3 with lr=0.000330, weight_decay=0.001109
[OPTUNA] Trial #3: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0003295929250116923, weight_decay=0.0011092883352107762
[INFO] >>> Starting fold 1 training (Trial #3) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2724, Train Acc: 0.9057 | Val Loss: 0.1891, Val Acc: 0.9433
[Fold 1 Epoch 2/10] Train Loss: 0.1574, Train Acc: 0.9453 | Val Loss: 0.2063, Val Acc: 0.9384
[Fold 1 Epoch 3/10] Train Loss: 0.1312, Train Acc: 0.9567 | Val Loss: 0.1597, Val Acc: 0.9532
[Fold 1 Epoch 4/10] Train Loss: 0.1391, Train Acc: 0.9535 | Val Loss: 0.1595, Val Acc: 0.9509
[Fold 1 Epoch 5/10] Train Loss: 0.1164, Train Acc: 0.9626 | Val Loss: 0.2128, Val Acc: 0.9302
[Fold 1 Epoch 6/10] Train Loss: 0.1114, Train Acc: 0.9645 | Val Loss: 0.1708, Val Acc: 0.9495
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9532

[OPTUNA] Trial #3: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0003295929250116923, weight_decay=0.0011092883352107762
[INFO] >>> Starting fold 2 training (Trial #3) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2799, Train Acc: 0.8999 | Val Loss: 0.2176, Val Acc: 0.9268
[Fold 2 Epoch 2/10] Train Loss: 0.1531, Train Acc: 0.9494 | Val Loss: 0.1542, Val Acc: 0.9515
[Fold 2 Epoch 3/10] Train Loss: 0.1351, Train Acc: 0.9568 | Val Loss: 0.1448, Val Acc: 0.9589
[Fold 2 Epoch 4/10] Train Loss: 0.1349, Train Acc: 0.9541 | Val Loss: 0.1579, Val Acc: 0.9458
[Fold 2 Epoch 5/10] Train Loss: 0.1314, Train Acc: 0.9581 | Val Loss: 0.2280, Val Acc: 0.9376
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9589

[OPTUNA] Trial #3: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0003295929250116923, weight_decay=0.0011092883352107762
[INFO] >>> Starting fold 3 training (Trial #3) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.2893, Train Acc: 0.8989 | Val Loss: 0.1865, Val Acc: 0.9362
[Fold 3 Epoch 2/10] Train Loss: 0.1554, Train Acc: 0.9478 | Val Loss: 0.1535, Val Acc: 0.9529
[Fold 3 Epoch 3/10] Train Loss: 0.1451, Train Acc: 0.9493 | Val Loss: 0.1360, Val Acc: 0.9617
[Fold 3 Epoch 4/10] Train Loss: 0.1228, Train Acc: 0.9594 | Val Loss: 0.1311, Val Acc: 0.9572
[Fold 3 Epoch 5/10] Train Loss: 0.1118, Train Acc: 0.9632 | Val Loss: 0.1295, Val Acc: 0.9572
[Fold 3 Epoch 6/10] Train Loss: 0.1108, Train Acc: 0.9633 | Val Loss: 0.2573, Val Acc: 0.9155
[Fold 3 Epoch 7/10] Train Loss: 0.1156, Train Acc: 0.9628 | Val Loss: 0.2125, Val Acc: 0.9294
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9617

[OPTUNA] Trial #3: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0003295929250116923, weight_decay=0.0011092883352107762
[INFO] >>> Starting fold 4 training (Trial #3) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2904, Train Acc: 0.9015 | Val Loss: 0.1804, Val Acc: 0.9359
[Fold 4 Epoch 2/10] Train Loss: 0.1620, Train Acc: 0.9467 | Val Loss: 0.1760, Val Acc: 0.9407
[Fold 4 Epoch 3/10] Train Loss: 0.1311, Train Acc: 0.9555 | Val Loss: 0.1941, Val Acc: 0.9373
[Fold 4 Epoch 4/10] Train Loss: 0.1252, Train Acc: 0.9591 | Val Loss: 0.2545, Val Acc: 0.9243
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9407

[OPTUNA] Trial #3: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0003295929250116923, weight_decay=0.0011092883352107762
[INFO] >>> Starting fold 5 training (Trial #3) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2625, Train Acc: 0.9106 | Val Loss: 0.1619, Val Acc: 0.9481
[Fold 5 Epoch 2/10] Train Loss: 0.1652, Train Acc: 0.9443 | Val Loss: 0.2093, Val Acc: 0.9353
[Fold 5 Epoch 3/10] Train Loss: 0.1388, Train Acc: 0.9547 | Val Loss: 0.1454, Val Acc: 0.9546
[Fold 5 Epoch 4/10] Train Loss: 0.1187, Train Acc: 0.9615 | Val Loss: 0.3107, Val Acc: 0.8962
[Fold 5 Epoch 5/10] Train Loss: 0.1495, Train Acc: 0.9498 | Val Loss: 0.2107, Val Acc: 0.9311
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9546

[OPTUNA] Trial #3 done. Fold Accuracies: [0.9531914893617022, 0.9588652482269504, 0.9617021276595744, 0.940709219858156, 0.9546099290780142]. Avg Acc=0.9538

[OPTUNA] Starting Trial #4 with lr=0.000130, weight_decay=0.000007
[OPTUNA] Trial #4: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00013018976271633227, weight_decay=6.654772060284443e-06
[INFO] >>> Starting fold 1 training (Trial #4) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2557, Train Acc: 0.9123 | Val Loss: 0.1173, Val Acc: 0.9677
[Fold 1 Epoch 2/10] Train Loss: 0.0886, Train Acc: 0.9711 | Val Loss: 0.1363, Val Acc: 0.9631
[Fold 1 Epoch 3/10] Train Loss: 0.0528, Train Acc: 0.9824 | Val Loss: 0.1562, Val Acc: 0.9574
[INFO] Early stopping on fold 1 at epoch 3
[INFO] <<< Finished fold 1, best val acc = 0.9677

[OPTUNA] Trial #4: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00013018976271633227, weight_decay=6.654772060284443e-06
[INFO] >>> Starting fold 2 training (Trial #4) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2562, Train Acc: 0.9130 | Val Loss: 0.1191, Val Acc: 0.9586
[Fold 2 Epoch 2/10] Train Loss: 0.0882, Train Acc: 0.9695 | Val Loss: 0.1221, Val Acc: 0.9589
[Fold 2 Epoch 3/10] Train Loss: 0.0589, Train Acc: 0.9809 | Val Loss: 0.0906, Val Acc: 0.9682
[Fold 2 Epoch 4/10] Train Loss: 0.0382, Train Acc: 0.9875 | Val Loss: 0.1241, Val Acc: 0.9623
[Fold 2 Epoch 5/10] Train Loss: 0.0368, Train Acc: 0.9875 | Val Loss: 0.1629, Val Acc: 0.9617
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9682

[OPTUNA] Trial #4: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00013018976271633227, weight_decay=6.654772060284443e-06
[INFO] >>> Starting fold 3 training (Trial #4) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.2619, Train Acc: 0.9110 | Val Loss: 0.1304, Val Acc: 0.9566
[Fold 3 Epoch 2/10] Train Loss: 0.0878, Train Acc: 0.9705 | Val Loss: 0.0934, Val Acc: 0.9679
[Fold 3 Epoch 3/10] Train Loss: 0.0582, Train Acc: 0.9807 | Val Loss: 0.0978, Val Acc: 0.9677
[Fold 3 Epoch 4/10] Train Loss: 0.0327, Train Acc: 0.9891 | Val Loss: 0.0869, Val Acc: 0.9677
[Fold 3 Epoch 5/10] Train Loss: 0.0265, Train Acc: 0.9919 | Val Loss: 0.1738, Val Acc: 0.9535
[Fold 3 Epoch 6/10] Train Loss: 0.0259, Train Acc: 0.9918 | Val Loss: 0.0862, Val Acc: 0.9736
[Fold 3 Epoch 7/10] Train Loss: 0.0229, Train Acc: 0.9935 | Val Loss: 0.1287, Val Acc: 0.9617
[Fold 3 Epoch 8/10] Train Loss: 0.0222, Train Acc: 0.9928 | Val Loss: 0.0878, Val Acc: 0.9719
[INFO] Early stopping on fold 3 at epoch 8
[INFO] <<< Finished fold 3, best val acc = 0.9736

[OPTUNA] Trial #4: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00013018976271633227, weight_decay=6.654772060284443e-06
[INFO] >>> Starting fold 4 training (Trial #4) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2469, Train Acc: 0.9167 | Val Loss: 0.1605, Val Acc: 0.9472
[Fold 4 Epoch 2/10] Train Loss: 0.0867, Train Acc: 0.9711 | Val Loss: 0.1310, Val Acc: 0.9597
[Fold 4 Epoch 3/10] Train Loss: 0.0558, Train Acc: 0.9814 | Val Loss: 0.1113, Val Acc: 0.9665
[Fold 4 Epoch 4/10] Train Loss: 0.0367, Train Acc: 0.9879 | Val Loss: 0.1262, Val Acc: 0.9594
[Fold 4 Epoch 5/10] Train Loss: 0.0310, Train Acc: 0.9904 | Val Loss: 0.1317, Val Acc: 0.9679
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9665

[OPTUNA] Trial #4: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00013018976271633227, weight_decay=6.654772060284443e-06
[INFO] >>> Starting fold 5 training (Trial #4) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2731, Train Acc: 0.9052 | Val Loss: 0.1201, Val Acc: 0.9597
[Fold 5 Epoch 2/10] Train Loss: 0.0932, Train Acc: 0.9693 | Val Loss: 0.1258, Val Acc: 0.9628
[Fold 5 Epoch 3/10] Train Loss: 0.0488, Train Acc: 0.9847 | Val Loss: 0.0868, Val Acc: 0.9733
[Fold 5 Epoch 4/10] Train Loss: 0.0375, Train Acc: 0.9871 | Val Loss: 0.1046, Val Acc: 0.9705
[Fold 5 Epoch 5/10] Train Loss: 0.0368, Train Acc: 0.9884 | Val Loss: 0.1434, Val Acc: 0.9569
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9733

[OPTUNA] Trial #4 done. Fold Accuracies: [0.9676595744680851, 0.9682269503546099, 0.9736170212765958, 0.9665248226950355, 0.9733333333333334]. Avg Acc=0.9699

[OPTUNA] Starting Trial #5 with lr=0.000043, weight_decay=0.000675
[OPTUNA] Trial #5: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=4.305581303186559e-05, weight_decay=0.0006753988845576691
[INFO] >>> Starting fold 1 training (Trial #5) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3410, Train Acc: 0.8863 | Val Loss: 0.1232, Val Acc: 0.9560
[Fold 1 Epoch 2/10] Train Loss: 0.0777, Train Acc: 0.9758 | Val Loss: 0.1301, Val Acc: 0.9637
[Fold 1 Epoch 3/10] Train Loss: 0.0305, Train Acc: 0.9924 | Val Loss: 0.1101, Val Acc: 0.9688
[Fold 1 Epoch 4/10] Train Loss: 0.0184, Train Acc: 0.9950 | Val Loss: 0.1200, Val Acc: 0.9606
[Fold 1 Epoch 5/10] Train Loss: 0.0158, Train Acc: 0.9952 | Val Loss: 0.1058, Val Acc: 0.9688
[Fold 1 Epoch 6/10] Train Loss: 0.0157, Train Acc: 0.9957 | Val Loss: 0.1243, Val Acc: 0.9603
[Fold 1 Epoch 7/10] Train Loss: 0.0189, Train Acc: 0.9940 | Val Loss: 0.1056, Val Acc: 0.9705
[Fold 1 Epoch 8/10] Train Loss: 0.0117, Train Acc: 0.9972 | Val Loss: 0.1086, Val Acc: 0.9713
[Fold 1 Epoch 9/10] Train Loss: 0.0047, Train Acc: 0.9992 | Val Loss: 0.1112, Val Acc: 0.9725
[INFO] Early stopping on fold 1 at epoch 9
[INFO] <<< Finished fold 1, best val acc = 0.9713

[OPTUNA] Trial #5: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=4.305581303186559e-05, weight_decay=0.0006753988845576691
[INFO] >>> Starting fold 2 training (Trial #5) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3435, Train Acc: 0.8878 | Val Loss: 0.1070, Val Acc: 0.9643
[Fold 2 Epoch 2/10] Train Loss: 0.0840, Train Acc: 0.9740 | Val Loss: 0.0881, Val Acc: 0.9677
[Fold 2 Epoch 3/10] Train Loss: 0.0362, Train Acc: 0.9895 | Val Loss: 0.1027, Val Acc: 0.9694
[Fold 2 Epoch 4/10] Train Loss: 0.0182, Train Acc: 0.9952 | Val Loss: 0.1046, Val Acc: 0.9685
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9694

[OPTUNA] Trial #5: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=4.305581303186559e-05, weight_decay=0.0006753988845576691
[INFO] >>> Starting fold 3 training (Trial #5) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3397, Train Acc: 0.8890 | Val Loss: 0.1040, Val Acc: 0.9696
[Fold 3 Epoch 2/10] Train Loss: 0.0722, Train Acc: 0.9782 | Val Loss: 0.1014, Val Acc: 0.9674
[Fold 3 Epoch 3/10] Train Loss: 0.0351, Train Acc: 0.9888 | Val Loss: 0.1680, Val Acc: 0.9609
[Fold 3 Epoch 4/10] Train Loss: 0.0256, Train Acc: 0.9927 | Val Loss: 0.1033, Val Acc: 0.9685
[INFO] Early stopping on fold 3 at epoch 4
[INFO] <<< Finished fold 3, best val acc = 0.9696

[OPTUNA] Trial #5: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=4.305581303186559e-05, weight_decay=0.0006753988845576691
[INFO] >>> Starting fold 4 training (Trial #5) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3452, Train Acc: 0.8858 | Val Loss: 0.1194, Val Acc: 0.9609
[Fold 4 Epoch 2/10] Train Loss: 0.0788, Train Acc: 0.9750 | Val Loss: 0.1202, Val Acc: 0.9634
[Fold 4 Epoch 3/10] Train Loss: 0.0328, Train Acc: 0.9906 | Val Loss: 0.1160, Val Acc: 0.9637
[Fold 4 Epoch 4/10] Train Loss: 0.0206, Train Acc: 0.9944 | Val Loss: 0.0985, Val Acc: 0.9660
[Fold 4 Epoch 5/10] Train Loss: 0.0109, Train Acc: 0.9972 | Val Loss: 0.1068, Val Acc: 0.9702
[Fold 4 Epoch 6/10] Train Loss: 0.0134, Train Acc: 0.9965 | Val Loss: 0.1596, Val Acc: 0.9614
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9702

[OPTUNA] Trial #5: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=4.305581303186559e-05, weight_decay=0.0006753988845576691
[INFO] >>> Starting fold 5 training (Trial #5) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3442, Train Acc: 0.8903 | Val Loss: 0.1442, Val Acc: 0.9535
[Fold 5 Epoch 2/10] Train Loss: 0.0814, Train Acc: 0.9747 | Val Loss: 0.0851, Val Acc: 0.9719
[Fold 5 Epoch 3/10] Train Loss: 0.0278, Train Acc: 0.9928 | Val Loss: 0.0983, Val Acc: 0.9688
[Fold 5 Epoch 4/10] Train Loss: 0.0263, Train Acc: 0.9913 | Val Loss: 0.1217, Val Acc: 0.9609
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9719

[OPTUNA] Trial #5 done. Fold Accuracies: [0.9713475177304964, 0.9693617021276596, 0.969645390070922, 0.9702127659574468, 0.9719148936170213]. Avg Acc=0.9705

[OPTUNA] Starting Trial #6 with lr=0.000111, weight_decay=0.000091
[OPTUNA] Trial #6: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00011072245468859834, weight_decay=9.098464974651897e-05
[INFO] >>> Starting fold 1 training (Trial #6) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2650, Train Acc: 0.9119 | Val Loss: 0.1041, Val Acc: 0.9620
[Fold 1 Epoch 2/10] Train Loss: 0.0929, Train Acc: 0.9689 | Val Loss: 0.1101, Val Acc: 0.9679
[Fold 1 Epoch 3/10] Train Loss: 0.0486, Train Acc: 0.9838 | Val Loss: 0.1061, Val Acc: 0.9711
[INFO] Early stopping on fold 1 at epoch 3
[INFO] <<< Finished fold 1, best val acc = 0.9679

[OPTUNA] Trial #6: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00011072245468859834, weight_decay=9.098464974651897e-05
[INFO] >>> Starting fold 2 training (Trial #6) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2611, Train Acc: 0.9143 | Val Loss: 0.1627, Val Acc: 0.9475
[Fold 2 Epoch 2/10] Train Loss: 0.0871, Train Acc: 0.9713 | Val Loss: 0.1211, Val Acc: 0.9540
[Fold 2 Epoch 3/10] Train Loss: 0.0524, Train Acc: 0.9826 | Val Loss: 0.3496, Val Acc: 0.9004
[Fold 2 Epoch 4/10] Train Loss: 0.0438, Train Acc: 0.9862 | Val Loss: 0.0980, Val Acc: 0.9739
[Fold 2 Epoch 5/10] Train Loss: 0.0224, Train Acc: 0.9930 | Val Loss: 0.0694, Val Acc: 0.9753
[Fold 2 Epoch 6/10] Train Loss: 0.0233, Train Acc: 0.9930 | Val Loss: 0.1126, Val Acc: 0.9671
[Fold 2 Epoch 7/10] Train Loss: 0.0302, Train Acc: 0.9904 | Val Loss: 0.1562, Val Acc: 0.9557
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val acc = 0.9753

[OPTUNA] Trial #6: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00011072245468859834, weight_decay=9.098464974651897e-05
[INFO] >>> Starting fold 3 training (Trial #6) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.2602, Train Acc: 0.9126 | Val Loss: 0.0956, Val Acc: 0.9699
[Fold 3 Epoch 2/10] Train Loss: 0.0859, Train Acc: 0.9707 | Val Loss: 0.1013, Val Acc: 0.9688
[Fold 3 Epoch 3/10] Train Loss: 0.0500, Train Acc: 0.9840 | Val Loss: 0.0745, Val Acc: 0.9716
[Fold 3 Epoch 4/10] Train Loss: 0.0308, Train Acc: 0.9905 | Val Loss: 0.0989, Val Acc: 0.9696
[Fold 3 Epoch 5/10] Train Loss: 0.0327, Train Acc: 0.9896 | Val Loss: 0.0753, Val Acc: 0.9748
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9716

[OPTUNA] Trial #6: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00011072245468859834, weight_decay=9.098464974651897e-05
[INFO] >>> Starting fold 4 training (Trial #6) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2659, Train Acc: 0.9111 | Val Loss: 0.1204, Val Acc: 0.9549
[Fold 4 Epoch 2/10] Train Loss: 0.0825, Train Acc: 0.9721 | Val Loss: 0.1090, Val Acc: 0.9606
[Fold 4 Epoch 3/10] Train Loss: 0.0551, Train Acc: 0.9808 | Val Loss: 0.1032, Val Acc: 0.9665
[Fold 4 Epoch 4/10] Train Loss: 0.0411, Train Acc: 0.9868 | Val Loss: 0.1408, Val Acc: 0.9583
[Fold 4 Epoch 5/10] Train Loss: 0.0348, Train Acc: 0.9896 | Val Loss: 0.1532, Val Acc: 0.9549
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9665

[OPTUNA] Trial #6: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00011072245468859834, weight_decay=9.098464974651897e-05
[INFO] >>> Starting fold 5 training (Trial #6) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2694, Train Acc: 0.9062 | Val Loss: 0.1238, Val Acc: 0.9594
[Fold 5 Epoch 2/10] Train Loss: 0.0818, Train Acc: 0.9735 | Val Loss: 0.1602, Val Acc: 0.9492
[Fold 5 Epoch 3/10] Train Loss: 0.0575, Train Acc: 0.9820 | Val Loss: 0.0761, Val Acc: 0.9688
[Fold 5 Epoch 4/10] Train Loss: 0.0318, Train Acc: 0.9896 | Val Loss: 0.1004, Val Acc: 0.9725
[Fold 5 Epoch 5/10] Train Loss: 0.0298, Train Acc: 0.9903 | Val Loss: 0.0778, Val Acc: 0.9745
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9725

[OPTUNA] Trial #6 done. Fold Accuracies: [0.9679432624113475, 0.9753191489361702, 0.9716312056737588, 0.9665248226950355, 0.9724822695035461]. Avg Acc=0.9708

[OPTUNA] Starting Trial #7 with lr=0.000031, weight_decay=0.000007
[OPTUNA] Trial #7: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=3.121708199355511e-05, weight_decay=7.083744795626563e-06
[INFO] >>> Starting fold 1 training (Trial #7) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3836, Train Acc: 0.8802 | Val Loss: 0.1417, Val Acc: 0.9577
[Fold 1 Epoch 2/10] Train Loss: 0.0803, Train Acc: 0.9753 | Val Loss: 0.1113, Val Acc: 0.9657
[Fold 1 Epoch 3/10] Train Loss: 0.0338, Train Acc: 0.9908 | Val Loss: 0.1156, Val Acc: 0.9637
[Fold 1 Epoch 4/10] Train Loss: 0.0155, Train Acc: 0.9963 | Val Loss: 0.1293, Val Acc: 0.9702
[INFO] Early stopping on fold 1 at epoch 4
[INFO] <<< Finished fold 1, best val acc = 0.9657

[OPTUNA] Trial #7: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=3.121708199355511e-05, weight_decay=7.083744795626563e-06
[INFO] >>> Starting fold 2 training (Trial #7) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3798, Train Acc: 0.8776 | Val Loss: 0.1172, Val Acc: 0.9617
[Fold 2 Epoch 2/10] Train Loss: 0.0768, Train Acc: 0.9761 | Val Loss: 0.0993, Val Acc: 0.9668
[Fold 2 Epoch 3/10] Train Loss: 0.0343, Train Acc: 0.9908 | Val Loss: 0.0931, Val Acc: 0.9665
[Fold 2 Epoch 4/10] Train Loss: 0.0153, Train Acc: 0.9965 | Val Loss: 0.0985, Val Acc: 0.9719
[Fold 2 Epoch 5/10] Train Loss: 0.0096, Train Acc: 0.9982 | Val Loss: 0.0945, Val Acc: 0.9694
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9719

[OPTUNA] Trial #7: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=3.121708199355511e-05, weight_decay=7.083744795626563e-06
[INFO] >>> Starting fold 3 training (Trial #7) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3991, Train Acc: 0.8729 | Val Loss: 0.1191, Val Acc: 0.9611
[Fold 3 Epoch 2/10] Train Loss: 0.0879, Train Acc: 0.9726 | Val Loss: 0.0983, Val Acc: 0.9679
[Fold 3 Epoch 3/10] Train Loss: 0.0302, Train Acc: 0.9920 | Val Loss: 0.0739, Val Acc: 0.9759
[Fold 3 Epoch 4/10] Train Loss: 0.0137, Train Acc: 0.9970 | Val Loss: 0.0865, Val Acc: 0.9742
[Fold 3 Epoch 5/10] Train Loss: 0.0111, Train Acc: 0.9973 | Val Loss: 0.0909, Val Acc: 0.9708
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9759

[OPTUNA] Trial #7: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=3.121708199355511e-05, weight_decay=7.083744795626563e-06
[INFO] >>> Starting fold 4 training (Trial #7) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.4083, Train Acc: 0.8670 | Val Loss: 0.1621, Val Acc: 0.9518
[Fold 4 Epoch 2/10] Train Loss: 0.0892, Train Acc: 0.9733 | Val Loss: 0.1197, Val Acc: 0.9594
[Fold 4 Epoch 3/10] Train Loss: 0.0317, Train Acc: 0.9911 | Val Loss: 0.1138, Val Acc: 0.9640
[Fold 4 Epoch 4/10] Train Loss: 0.0163, Train Acc: 0.9961 | Val Loss: 0.1313, Val Acc: 0.9654
[Fold 4 Epoch 5/10] Train Loss: 0.0116, Train Acc: 0.9977 | Val Loss: 0.1100, Val Acc: 0.9637
[Fold 4 Epoch 6/10] Train Loss: 0.0118, Train Acc: 0.9969 | Val Loss: 0.1486, Val Acc: 0.9603
[Fold 4 Epoch 7/10] Train Loss: 0.0088, Train Acc: 0.9982 | Val Loss: 0.1252, Val Acc: 0.9671
[INFO] Early stopping on fold 4 at epoch 7
[INFO] <<< Finished fold 4, best val acc = 0.9654

[OPTUNA] Trial #7: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=3.121708199355511e-05, weight_decay=7.083744795626563e-06
[INFO] >>> Starting fold 5 training (Trial #7) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.4050, Train Acc: 0.8660 | Val Loss: 0.1329, Val Acc: 0.9552
[Fold 5 Epoch 2/10] Train Loss: 0.0875, Train Acc: 0.9731 | Val Loss: 0.0950, Val Acc: 0.9668
[Fold 5 Epoch 3/10] Train Loss: 0.0304, Train Acc: 0.9921 | Val Loss: 0.1094, Val Acc: 0.9660
[Fold 5 Epoch 4/10] Train Loss: 0.0179, Train Acc: 0.9959 | Val Loss: 0.1122, Val Acc: 0.9645
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9668

[OPTUNA] Trial #7 done. Fold Accuracies: [0.9656737588652482, 0.9719148936170213, 0.975886524822695, 0.9653900709219858, 0.9668085106382979]. Avg Acc=0.9691

[OPTUNA] Starting Trial #8 with lr=0.000129, weight_decay=0.000174
[OPTUNA] Trial #8: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00012906033021524275, weight_decay=0.0001742430552590706
[INFO] >>> Starting fold 1 training (Trial #8) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2618, Train Acc: 0.9126 | Val Loss: 0.1062, Val Acc: 0.9609
[Fold 1 Epoch 2/10] Train Loss: 0.0891, Train Acc: 0.9703 | Val Loss: 0.1229, Val Acc: 0.9645
[Fold 1 Epoch 3/10] Train Loss: 0.0637, Train Acc: 0.9791 | Val Loss: 0.1061, Val Acc: 0.9662
[Fold 1 Epoch 4/10] Train Loss: 0.0396, Train Acc: 0.9872 | Val Loss: 0.0983, Val Acc: 0.9719
[Fold 1 Epoch 5/10] Train Loss: 0.0288, Train Acc: 0.9915 | Val Loss: 0.1215, Val Acc: 0.9614
[Fold 1 Epoch 6/10] Train Loss: 0.0476, Train Acc: 0.9843 | Val Loss: 0.1503, Val Acc: 0.9580
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9719

[OPTUNA] Trial #8: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00012906033021524275, weight_decay=0.0001742430552590706
[INFO] >>> Starting fold 2 training (Trial #8) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2747, Train Acc: 0.9062 | Val Loss: 0.1850, Val Acc: 0.9365
[Fold 2 Epoch 2/10] Train Loss: 0.0949, Train Acc: 0.9674 | Val Loss: 0.1183, Val Acc: 0.9623
[Fold 2 Epoch 3/10] Train Loss: 0.0560, Train Acc: 0.9823 | Val Loss: 0.0924, Val Acc: 0.9682
[Fold 2 Epoch 4/10] Train Loss: 0.0403, Train Acc: 0.9874 | Val Loss: 0.1034, Val Acc: 0.9662
[Fold 2 Epoch 5/10] Train Loss: 0.0315, Train Acc: 0.9904 | Val Loss: 0.1275, Val Acc: 0.9648
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9682

[OPTUNA] Trial #8: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00012906033021524275, weight_decay=0.0001742430552590706
[INFO] >>> Starting fold 3 training (Trial #8) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.2694, Train Acc: 0.9097 | Val Loss: 0.1249, Val Acc: 0.9586
[Fold 3 Epoch 2/10] Train Loss: 0.0930, Train Acc: 0.9699 | Val Loss: 0.1137, Val Acc: 0.9594
[Fold 3 Epoch 3/10] Train Loss: 0.0589, Train Acc: 0.9808 | Val Loss: 0.0950, Val Acc: 0.9699
[Fold 3 Epoch 4/10] Train Loss: 0.0469, Train Acc: 0.9845 | Val Loss: 0.1075, Val Acc: 0.9682
[Fold 3 Epoch 5/10] Train Loss: 0.0337, Train Acc: 0.9889 | Val Loss: 0.1033, Val Acc: 0.9671
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9699

[OPTUNA] Trial #8: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00012906033021524275, weight_decay=0.0001742430552590706
[INFO] >>> Starting fold 4 training (Trial #8) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2539, Train Acc: 0.9115 | Val Loss: 0.1123, Val Acc: 0.9631
[Fold 4 Epoch 2/10] Train Loss: 0.0865, Train Acc: 0.9717 | Val Loss: 0.1255, Val Acc: 0.9611
[Fold 4 Epoch 3/10] Train Loss: 0.0534, Train Acc: 0.9843 | Val Loss: 0.1191, Val Acc: 0.9640
[INFO] Early stopping on fold 4 at epoch 3
[INFO] <<< Finished fold 4, best val acc = 0.9631

[OPTUNA] Trial #8: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00012906033021524275, weight_decay=0.0001742430552590706
[INFO] >>> Starting fold 5 training (Trial #8) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2551, Train Acc: 0.9110 | Val Loss: 0.1214, Val Acc: 0.9586
[Fold 5 Epoch 2/10] Train Loss: 0.0905, Train Acc: 0.9704 | Val Loss: 0.0965, Val Acc: 0.9679
[Fold 5 Epoch 3/10] Train Loss: 0.0573, Train Acc: 0.9813 | Val Loss: 0.1306, Val Acc: 0.9594
[Fold 5 Epoch 4/10] Train Loss: 0.0439, Train Acc: 0.9864 | Val Loss: 0.1398, Val Acc: 0.9563
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9679

[OPTUNA] Trial #8 done. Fold Accuracies: [0.9719148936170213, 0.9682269503546099, 0.9699290780141844, 0.9631205673758865, 0.9679432624113475]. Avg Acc=0.9682

[OPTUNA] Starting Trial #9 with lr=0.000304, weight_decay=0.007951
[OPTUNA] Trial #9: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00030359741849929806, weight_decay=0.00795098050592815
[INFO] >>> Starting fold 1 training (Trial #9) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3179, Train Acc: 0.8904 | Val Loss: 0.5300, Val Acc: 0.8638
[Fold 1 Epoch 2/10] Train Loss: 0.2430, Train Acc: 0.9196 | Val Loss: 0.2462, Val Acc: 0.9214
[Fold 1 Epoch 3/10] Train Loss: 0.2148, Train Acc: 0.9276 | Val Loss: 0.2993, Val Acc: 0.8928
[Fold 1 Epoch 4/10] Train Loss: 0.2136, Train Acc: 0.9272 | Val Loss: 0.2452, Val Acc: 0.9166
[Fold 1 Epoch 5/10] Train Loss: 0.2013, Train Acc: 0.9350 | Val Loss: 0.2886, Val Acc: 0.9200
[Fold 1 Epoch 6/10] Train Loss: 0.1844, Train Acc: 0.9409 | Val Loss: 0.4228, Val Acc: 0.8417
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9214

[OPTUNA] Trial #9: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00030359741849929806, weight_decay=0.00795098050592815
[INFO] >>> Starting fold 2 training (Trial #9) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3100, Train Acc: 0.8909 | Val Loss: 0.2832, Val Acc: 0.9217
[Fold 2 Epoch 2/10] Train Loss: 0.2313, Train Acc: 0.9230 | Val Loss: 0.6655, Val Acc: 0.7929
[Fold 2 Epoch 3/10] Train Loss: 0.2222, Train Acc: 0.9267 | Val Loss: 0.6119, Val Acc: 0.8043
[INFO] Early stopping on fold 2 at epoch 3
[INFO] <<< Finished fold 2, best val acc = 0.9217

[OPTUNA] Trial #9: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00030359741849929806, weight_decay=0.00795098050592815
[INFO] >>> Starting fold 3 training (Trial #9) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3151, Train Acc: 0.8917 | Val Loss: 0.3329, Val Acc: 0.8780
[Fold 3 Epoch 2/10] Train Loss: 0.2623, Train Acc: 0.9113 | Val Loss: 0.2784, Val Acc: 0.9007
[Fold 3 Epoch 3/10] Train Loss: 0.2371, Train Acc: 0.9206 | Val Loss: 0.4879, Val Acc: 0.8448
[Fold 3 Epoch 4/10] Train Loss: 0.2251, Train Acc: 0.9257 | Val Loss: 0.3948, Val Acc: 0.8806
[INFO] Early stopping on fold 3 at epoch 4
[INFO] <<< Finished fold 3, best val acc = 0.9007

[OPTUNA] Trial #9: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00030359741849929806, weight_decay=0.00795098050592815
[INFO] >>> Starting fold 4 training (Trial #9) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3088, Train Acc: 0.8945 | Val Loss: 0.6915, Val Acc: 0.7495
[Fold 4 Epoch 2/10] Train Loss: 0.2401, Train Acc: 0.9205 | Val Loss: 0.2251, Val Acc: 0.9294
[Fold 4 Epoch 3/10] Train Loss: 0.2211, Train Acc: 0.9269 | Val Loss: 0.2514, Val Acc: 0.9228
[Fold 4 Epoch 4/10] Train Loss: 0.2042, Train Acc: 0.9307 | Val Loss: 0.4179, Val Acc: 0.8593
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9294

[OPTUNA] Trial #9: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00030359741849929806, weight_decay=0.00795098050592815
[INFO] >>> Starting fold 5 training (Trial #9) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3018, Train Acc: 0.8965 | Val Loss: 0.5414, Val Acc: 0.8831
[Fold 5 Epoch 2/10] Train Loss: 0.2286, Train Acc: 0.9235 | Val Loss: 0.2702, Val Acc: 0.9061
[Fold 5 Epoch 3/10] Train Loss: 0.2148, Train Acc: 0.9265 | Val Loss: 0.7179, Val Acc: 0.7529
[Fold 5 Epoch 4/10] Train Loss: 0.2113, Train Acc: 0.9299 | Val Loss: 0.5238, Val Acc: 0.8298
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9061

[OPTUNA] Trial #9 done. Fold Accuracies: [0.9214184397163121, 0.9217021276595745, 0.900709219858156, 0.9293617021276596, 0.9060992907801418]. Avg Acc=0.9159
[OPTUNA] Best trial found:
  Trial number: 6
  Avg k-fold acc: 0.9708
    lr: 0.00011072245468859834
    weight_decay: 9.098464974651897e-05

[INFO] Retraining final model on entire training set using best hyperparams...
[DEBUG] Creating ResNet50 with lr=0.00011072245468859834, weight_decay=9.098464974651897e-05
[Final Train] Epoch 1/5 - Loss: 0.2332, Acc: 0.9207
[Final Train] Epoch 2/5 - Loss: 0.0804, Acc: 0.9729
[Final Train] Epoch 3/5 - Loss: 0.0472, Acc: 0.9850
[Final Train] Epoch 4/5 - Loss: 0.0445, Acc: 0.9852
[Final Train] Epoch 5/5 - Loss: 0.0282, Acc: 0.9910

[INFO] Evaluating final model on test set...
[RESULT] Final Test Accuracy: 0.7616

[RESULT] Classification Report:
              precision    recall  f1-score   support

      Center       0.81      0.81      0.81       832
       Donut       0.78      0.36      0.50       146
    Edge-Loc       0.71      0.90      0.79      2772
   Edge-Ring       0.89      0.76      0.82      1126
         Loc       0.79      0.58      0.67      1973
   Near-full       0.86      0.94      0.90        95
      Random       0.72      0.79      0.75       257
     Scratch       0.73      0.69      0.71       693

    accuracy                           0.76      7894
   macro avg       0.79      0.73      0.74      7894
weighted avg       0.77      0.76      0.76      7894

[INFO] Final model saved to final_model.pth

[INFO] Done. You can now view logs in TensorBoard and the Optuna dashboard.
