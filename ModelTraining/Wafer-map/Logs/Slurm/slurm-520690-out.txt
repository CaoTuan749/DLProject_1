PYTHONPATH=~/tmp/miniconda3/envs/MaProject/bin/python:
[I 2025-02-23 22:59:35,350] A new study created in RDB with name: resnet_wafer_1740347974
[I 2025-02-23 23:24:03,479] Trial 0 finished with value: 0.9607375886524823 and parameters: {'lr': 0.00023435625036751065, 'weight_decay': 0.00016916362358591837}. Best is trial 0 with value: 0.9607375886524823.
[I 2025-02-23 23:51:49,657] Trial 1 finished with value: 0.9609645390070923 and parameters: {'lr': 0.0002514594336142085, 'weight_decay': 0.0004967294960605752}. Best is trial 1 with value: 0.9609645390070923.
[I 2025-02-24 00:17:27,299] Trial 2 finished with value: 0.9689645390070922 and parameters: {'lr': 5.483102370614099e-05, 'weight_decay': 2.9483079240773813e-05}. Best is trial 2 with value: 0.9689645390070922.
[I 2025-02-24 00:48:34,304] Trial 3 finished with value: 0.9718581560283688 and parameters: {'lr': 6.13968214228214e-05, 'weight_decay': 2.1355311654407138e-06}. Best is trial 3 with value: 0.9718581560283688.
[I 2025-02-24 01:19:29,380] Trial 4 finished with value: 0.8322836879432624 and parameters: {'lr': 0.0009274972810716985, 'weight_decay': 0.004604800803526501}. Best is trial 3 with value: 0.9718581560283688.
[I 2025-02-24 01:48:23,535] Trial 5 finished with value: 0.9615886524822695 and parameters: {'lr': 0.0005259197863882342, 'weight_decay': 1.0179595651619139e-05}. Best is trial 3 with value: 0.9718581560283688.
[I 2025-02-24 02:17:16,703] Trial 6 finished with value: 0.9690212765957448 and parameters: {'lr': 0.0001181127850617851, 'weight_decay': 7.466351287598457e-06}. Best is trial 3 with value: 0.9718581560283688.
[I 2025-02-24 02:45:03,458] Trial 7 finished with value: 0.9437163120567377 and parameters: {'lr': 0.0001966119293833521, 'weight_decay': 0.009678401099320989}. Best is trial 3 with value: 0.9718581560283688.
[I 2025-02-24 03:16:07,374] Trial 8 finished with value: 0.9706666666666667 and parameters: {'lr': 4.542876681460975e-05, 'weight_decay': 0.00011220863736562025}. Best is trial 3 with value: 0.9718581560283688.
[I 2025-02-24 03:47:11,676] Trial 9 finished with value: 0.9638014184397162 and parameters: {'lr': 0.00039826679258327097, 'weight_decay': 1.674304678316113e-06}. Best is trial 3 with value: 0.9718581560283688.
Loaded configuration:
{'experiment': {'reproducibility': True, 'seed': 42, 'num_trials': 10, 'num_epochs': 10, 'final_epochs': 5, 'save_model': True, 'model_save_path': 'final_model.pth', 'suggest': {'lr': {'low': '1e-5', 'high': '1e-3', 'log': True}, 'weight_decay': {'low': '1e-6', 'high': '1e-2', 'log': True}}}, 'model': {'type': 'resnet50', 'lr': '1e-4', 'weight_decay': '1e-4'}, 'dataset': {'path': '/home/anhcao/tmp/Dataset/Wafermap-dataset/WM811K.pkl'}}
[INFO] Reproducibility enabled. Seed set to 42
[INFO] Using device: cuda
[INFO] Number of classes: 8
[INFO] Classes: ['Center' 'Donut' 'Edge-Loc' 'Edge-Ring' 'Loc' 'Near-full' 'Random'
 'Scratch']
[INFO] Creating Optuna study 'resnet_wafer_1740347974' with DB file: resnet_wafer_v2.db
[INFO] Starting study.optimize with 10 trials...


[OPTUNA] Starting Trial #0 with lr=0.000234, weight_decay=0.000169
[OPTUNA] Trial #0: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00023435625036751065, weight_decay=0.00016916362358591837
[INFO] >>> Starting fold 1 training (Trial #0) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2590, Train Acc: 0.9120 | Val Loss: 0.1205, Val Acc: 0.9557
[Fold 1 Epoch 2/10] Train Loss: 0.1212, Train Acc: 0.9601 | Val Loss: 0.1517, Val Acc: 0.9455
[Fold 1 Epoch 3/10] Train Loss: 0.0731, Train Acc: 0.9749 | Val Loss: 0.1931, Val Acc: 0.9489
[INFO] Early stopping on fold 1 at epoch 3
[INFO] <<< Finished fold 1, best val acc = 0.9557

[OPTUNA] Trial #0: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00023435625036751065, weight_decay=0.00016916362358591837
[INFO] >>> Starting fold 2 training (Trial #0) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2606, Train Acc: 0.9120 | Val Loss: 0.1993, Val Acc: 0.9382
[Fold 2 Epoch 2/10] Train Loss: 0.1176, Train Acc: 0.9604 | Val Loss: 0.1297, Val Acc: 0.9574
[Fold 2 Epoch 3/10] Train Loss: 0.0836, Train Acc: 0.9714 | Val Loss: 0.1607, Val Acc: 0.9461
[Fold 2 Epoch 4/10] Train Loss: 0.0634, Train Acc: 0.9806 | Val Loss: 0.1182, Val Acc: 0.9591
[Fold 2 Epoch 5/10] Train Loss: 0.0571, Train Acc: 0.9804 | Val Loss: 0.1109, Val Acc: 0.9654
[Fold 2 Epoch 6/10] Train Loss: 0.0478, Train Acc: 0.9843 | Val Loss: 0.0985, Val Acc: 0.9679
[Fold 2 Epoch 7/10] Train Loss: 0.0429, Train Acc: 0.9855 | Val Loss: 0.1063, Val Acc: 0.9648
[Fold 2 Epoch 8/10] Train Loss: 0.0360, Train Acc: 0.9891 | Val Loss: 0.1195, Val Acc: 0.9688
[INFO] Early stopping on fold 2 at epoch 8
[INFO] <<< Finished fold 2, best val acc = 0.9679

[OPTUNA] Trial #0: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00023435625036751065, weight_decay=0.00016916362358591837
[INFO] >>> Starting fold 3 training (Trial #0) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.2697, Train Acc: 0.9078 | Val Loss: 0.1583, Val Acc: 0.9538
[Fold 3 Epoch 2/10] Train Loss: 0.1128, Train Acc: 0.9611 | Val Loss: 0.2306, Val Acc: 0.9333
[Fold 3 Epoch 3/10] Train Loss: 0.0855, Train Acc: 0.9713 | Val Loss: 0.0905, Val Acc: 0.9708
[Fold 3 Epoch 4/10] Train Loss: 0.0723, Train Acc: 0.9754 | Val Loss: 0.1304, Val Acc: 0.9620
[Fold 3 Epoch 5/10] Train Loss: 0.0619, Train Acc: 0.9806 | Val Loss: 0.1114, Val Acc: 0.9606
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9708

[OPTUNA] Trial #0: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00023435625036751065, weight_decay=0.00016916362358591837
[INFO] >>> Starting fold 4 training (Trial #0) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2489, Train Acc: 0.9143 | Val Loss: 0.1401, Val Acc: 0.9478
[Fold 4 Epoch 2/10] Train Loss: 0.1039, Train Acc: 0.9635 | Val Loss: 0.1551, Val Acc: 0.9478
[Fold 4 Epoch 3/10] Train Loss: 0.0871, Train Acc: 0.9713 | Val Loss: 0.1482, Val Acc: 0.9498
[INFO] Early stopping on fold 4 at epoch 3
[INFO] <<< Finished fold 4, best val acc = 0.9478

[OPTUNA] Trial #0: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00023435625036751065, weight_decay=0.00016916362358591837
[INFO] >>> Starting fold 5 training (Trial #0) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2558, Train Acc: 0.9097 | Val Loss: 0.1282, Val Acc: 0.9597
[Fold 5 Epoch 2/10] Train Loss: 0.1197, Train Acc: 0.9614 | Val Loss: 0.1312, Val Acc: 0.9614
[Fold 5 Epoch 3/10] Train Loss: 0.0782, Train Acc: 0.9745 | Val Loss: 0.1603, Val Acc: 0.9529
[INFO] Early stopping on fold 5 at epoch 3
[INFO] <<< Finished fold 5, best val acc = 0.9614

[OPTUNA] Trial #0 done. Fold Accuracies: [0.9557446808510638, 0.9679432624113475, 0.9707801418439717, 0.9478014184397163, 0.961418439716312]. Avg Acc=0.9607

[OPTUNA] Starting Trial #1 with lr=0.000251, weight_decay=0.000497
[OPTUNA] Trial #1: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0002514594336142085, weight_decay=0.0004967294960605752
[INFO] >>> Starting fold 1 training (Trial #1) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2614, Train Acc: 0.9088 | Val Loss: 0.1683, Val Acc: 0.9489
[Fold 1 Epoch 2/10] Train Loss: 0.1197, Train Acc: 0.9606 | Val Loss: 0.2255, Val Acc: 0.9339
[Fold 1 Epoch 3/10] Train Loss: 0.0940, Train Acc: 0.9696 | Val Loss: 0.1138, Val Acc: 0.9603
[Fold 1 Epoch 4/10] Train Loss: 0.0782, Train Acc: 0.9769 | Val Loss: 0.1224, Val Acc: 0.9648
[Fold 1 Epoch 5/10] Train Loss: 0.0784, Train Acc: 0.9743 | Val Loss: 0.1322, Val Acc: 0.9563
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9648

[OPTUNA] Trial #1: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0002514594336142085, weight_decay=0.0004967294960605752
[INFO] >>> Starting fold 2 training (Trial #1) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2706, Train Acc: 0.9056 | Val Loss: 0.2213, Val Acc: 0.9367
[Fold 2 Epoch 2/10] Train Loss: 0.1224, Train Acc: 0.9599 | Val Loss: 0.1364, Val Acc: 0.9538
[Fold 2 Epoch 3/10] Train Loss: 0.0986, Train Acc: 0.9651 | Val Loss: 0.1231, Val Acc: 0.9594
[Fold 2 Epoch 4/10] Train Loss: 0.0810, Train Acc: 0.9736 | Val Loss: 0.1635, Val Acc: 0.9478
[Fold 2 Epoch 5/10] Train Loss: 0.0692, Train Acc: 0.9775 | Val Loss: 0.2047, Val Acc: 0.9396
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9594

[OPTUNA] Trial #1: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0002514594336142085, weight_decay=0.0004967294960605752
[INFO] >>> Starting fold 3 training (Trial #1) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.2672, Train Acc: 0.9076 | Val Loss: 0.1287, Val Acc: 0.9555
[Fold 3 Epoch 2/10] Train Loss: 0.1207, Train Acc: 0.9602 | Val Loss: 0.1183, Val Acc: 0.9626
[Fold 3 Epoch 3/10] Train Loss: 0.1067, Train Acc: 0.9650 | Val Loss: 0.1589, Val Acc: 0.9501
[Fold 3 Epoch 4/10] Train Loss: 0.0878, Train Acc: 0.9711 | Val Loss: 0.1302, Val Acc: 0.9597
[INFO] Early stopping on fold 3 at epoch 4
[INFO] <<< Finished fold 3, best val acc = 0.9626

[OPTUNA] Trial #1: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0002514594336142085, weight_decay=0.0004967294960605752
[INFO] >>> Starting fold 4 training (Trial #1) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2620, Train Acc: 0.9094 | Val Loss: 0.2126, Val Acc: 0.9277
[Fold 4 Epoch 2/10] Train Loss: 0.1250, Train Acc: 0.9576 | Val Loss: 0.2809, Val Acc: 0.9140
[Fold 4 Epoch 3/10] Train Loss: 0.0975, Train Acc: 0.9679 | Val Loss: 0.1216, Val Acc: 0.9574
[Fold 4 Epoch 4/10] Train Loss: 0.0871, Train Acc: 0.9701 | Val Loss: 0.1583, Val Acc: 0.9506
[Fold 4 Epoch 5/10] Train Loss: 0.0695, Train Acc: 0.9774 | Val Loss: 0.2492, Val Acc: 0.9209
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9574

[OPTUNA] Trial #1: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0002514594336142085, weight_decay=0.0004967294960605752
[INFO] >>> Starting fold 5 training (Trial #1) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2511, Train Acc: 0.9111 | Val Loss: 0.1568, Val Acc: 0.9481
[Fold 5 Epoch 2/10] Train Loss: 0.1283, Train Acc: 0.9567 | Val Loss: 0.1359, Val Acc: 0.9546
[Fold 5 Epoch 3/10] Train Loss: 0.0901, Train Acc: 0.9699 | Val Loss: 0.1301, Val Acc: 0.9577
[Fold 5 Epoch 4/10] Train Loss: 0.0871, Train Acc: 0.9713 | Val Loss: 0.1222, Val Acc: 0.9606
[Fold 5 Epoch 5/10] Train Loss: 0.0650, Train Acc: 0.9774 | Val Loss: 0.1371, Val Acc: 0.9597
[Fold 5 Epoch 6/10] Train Loss: 0.0667, Train Acc: 0.9787 | Val Loss: 0.1538, Val Acc: 0.9518
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9606

[OPTUNA] Trial #1 done. Fold Accuracies: [0.964822695035461, 0.9594326241134752, 0.9625531914893617, 0.9574468085106383, 0.9605673758865249]. Avg Acc=0.9610

[OPTUNA] Starting Trial #2 with lr=0.000055, weight_decay=0.000029
[OPTUNA] Trial #2: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=5.483102370614099e-05, weight_decay=2.9483079240773813e-05
[INFO] >>> Starting fold 1 training (Trial #2) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3256, Train Acc: 0.8906 | Val Loss: 0.1153, Val Acc: 0.9648
[Fold 1 Epoch 2/10] Train Loss: 0.0718, Train Acc: 0.9789 | Val Loss: 0.0821, Val Acc: 0.9728
[Fold 1 Epoch 3/10] Train Loss: 0.0279, Train Acc: 0.9911 | Val Loss: 0.0848, Val Acc: 0.9725
[Fold 1 Epoch 4/10] Train Loss: 0.0252, Train Acc: 0.9929 | Val Loss: 0.1325, Val Acc: 0.9645
[INFO] Early stopping on fold 1 at epoch 4
[INFO] <<< Finished fold 1, best val acc = 0.9728

[OPTUNA] Trial #2: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=5.483102370614099e-05, weight_decay=2.9483079240773813e-05
[INFO] >>> Starting fold 2 training (Trial #2) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2991, Train Acc: 0.9050 | Val Loss: 0.1203, Val Acc: 0.9620
[Fold 2 Epoch 2/10] Train Loss: 0.0777, Train Acc: 0.9754 | Val Loss: 0.1136, Val Acc: 0.9589
[Fold 2 Epoch 3/10] Train Loss: 0.0328, Train Acc: 0.9906 | Val Loss: 0.0952, Val Acc: 0.9682
[Fold 2 Epoch 4/10] Train Loss: 0.0292, Train Acc: 0.9913 | Val Loss: 0.0896, Val Acc: 0.9725
[Fold 2 Epoch 5/10] Train Loss: 0.0162, Train Acc: 0.9958 | Val Loss: 0.0878, Val Acc: 0.9739
[Fold 2 Epoch 6/10] Train Loss: 0.0109, Train Acc: 0.9969 | Val Loss: 0.0908, Val Acc: 0.9719
[Fold 2 Epoch 7/10] Train Loss: 0.0097, Train Acc: 0.9971 | Val Loss: 0.1242, Val Acc: 0.9648
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val acc = 0.9739

[OPTUNA] Trial #2: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=5.483102370614099e-05, weight_decay=2.9483079240773813e-05
[INFO] >>> Starting fold 3 training (Trial #2) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3191, Train Acc: 0.8945 | Val Loss: 0.1167, Val Acc: 0.9620
[Fold 3 Epoch 2/10] Train Loss: 0.0751, Train Acc: 0.9778 | Val Loss: 0.1366, Val Acc: 0.9538
[Fold 3 Epoch 3/10] Train Loss: 0.0344, Train Acc: 0.9899 | Val Loss: 0.1247, Val Acc: 0.9623
[INFO] Early stopping on fold 3 at epoch 3
[INFO] <<< Finished fold 3, best val acc = 0.9620

[OPTUNA] Trial #2: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=5.483102370614099e-05, weight_decay=2.9483079240773813e-05
[INFO] >>> Starting fold 4 training (Trial #2) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3128, Train Acc: 0.8947 | Val Loss: 0.1442, Val Acc: 0.9535
[Fold 4 Epoch 2/10] Train Loss: 0.0673, Train Acc: 0.9806 | Val Loss: 0.1046, Val Acc: 0.9637
[Fold 4 Epoch 3/10] Train Loss: 0.0313, Train Acc: 0.9911 | Val Loss: 0.1245, Val Acc: 0.9623
[Fold 4 Epoch 4/10] Train Loss: 0.0256, Train Acc: 0.9921 | Val Loss: 0.1189, Val Acc: 0.9640
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9637

[OPTUNA] Trial #2: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=5.483102370614099e-05, weight_decay=2.9483079240773813e-05
[INFO] >>> Starting fold 5 training (Trial #2) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3009, Train Acc: 0.9027 | Val Loss: 0.1086, Val Acc: 0.9640
[Fold 5 Epoch 2/10] Train Loss: 0.0694, Train Acc: 0.9779 | Val Loss: 0.0945, Val Acc: 0.9660
[Fold 5 Epoch 3/10] Train Loss: 0.0311, Train Acc: 0.9906 | Val Loss: 0.0786, Val Acc: 0.9725
[Fold 5 Epoch 4/10] Train Loss: 0.0194, Train Acc: 0.9943 | Val Loss: 0.0962, Val Acc: 0.9679
[Fold 5 Epoch 5/10] Train Loss: 0.0171, Train Acc: 0.9952 | Val Loss: 0.1105, Val Acc: 0.9657
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9725

[OPTUNA] Trial #2 done. Fold Accuracies: [0.9727659574468085, 0.9739007092198582, 0.9619858156028369, 0.9636879432624114, 0.9724822695035461]. Avg Acc=0.9690

[OPTUNA] Starting Trial #3 with lr=0.000061, weight_decay=0.000002
[OPTUNA] Trial #3: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=6.13968214228214e-05, weight_decay=2.1355311654407138e-06
[INFO] >>> Starting fold 1 training (Trial #3) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2911, Train Acc: 0.9052 | Val Loss: 0.1472, Val Acc: 0.9489
[Fold 1 Epoch 2/10] Train Loss: 0.0727, Train Acc: 0.9760 | Val Loss: 0.0972, Val Acc: 0.9699
[Fold 1 Epoch 3/10] Train Loss: 0.0326, Train Acc: 0.9904 | Val Loss: 0.0777, Val Acc: 0.9750
[Fold 1 Epoch 4/10] Train Loss: 0.0287, Train Acc: 0.9911 | Val Loss: 0.0790, Val Acc: 0.9733
[Fold 1 Epoch 5/10] Train Loss: 0.0164, Train Acc: 0.9952 | Val Loss: 0.1081, Val Acc: 0.9696
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9750

[OPTUNA] Trial #3: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=6.13968214228214e-05, weight_decay=2.1355311654407138e-06
[INFO] >>> Starting fold 2 training (Trial #3) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2884, Train Acc: 0.9040 | Val Loss: 0.1568, Val Acc: 0.9495
[Fold 2 Epoch 2/10] Train Loss: 0.0713, Train Acc: 0.9777 | Val Loss: 0.0807, Val Acc: 0.9725
[Fold 2 Epoch 3/10] Train Loss: 0.0371, Train Acc: 0.9879 | Val Loss: 0.1283, Val Acc: 0.9623
[Fold 2 Epoch 4/10] Train Loss: 0.0231, Train Acc: 0.9933 | Val Loss: 0.1140, Val Acc: 0.9660
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9725

[OPTUNA] Trial #3: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=6.13968214228214e-05, weight_decay=2.1355311654407138e-06
[INFO] >>> Starting fold 3 training (Trial #3) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3028, Train Acc: 0.9009 | Val Loss: 0.1002, Val Acc: 0.9677
[Fold 3 Epoch 2/10] Train Loss: 0.0743, Train Acc: 0.9763 | Val Loss: 0.1193, Val Acc: 0.9614
[Fold 3 Epoch 3/10] Train Loss: 0.0466, Train Acc: 0.9846 | Val Loss: 0.0982, Val Acc: 0.9651
[Fold 3 Epoch 4/10] Train Loss: 0.0277, Train Acc: 0.9917 | Val Loss: 0.0944, Val Acc: 0.9688
[Fold 3 Epoch 5/10] Train Loss: 0.0175, Train Acc: 0.9953 | Val Loss: 0.1659, Val Acc: 0.9421
[Fold 3 Epoch 6/10] Train Loss: 0.0120, Train Acc: 0.9962 | Val Loss: 0.0772, Val Acc: 0.9776
[Fold 3 Epoch 7/10] Train Loss: 0.0155, Train Acc: 0.9957 | Val Loss: 0.0790, Val Acc: 0.9759
[Fold 3 Epoch 8/10] Train Loss: 0.0063, Train Acc: 0.9986 | Val Loss: 0.0835, Val Acc: 0.9753
[INFO] Early stopping on fold 3 at epoch 8
[INFO] <<< Finished fold 3, best val acc = 0.9776

[OPTUNA] Trial #3: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=6.13968214228214e-05, weight_decay=2.1355311654407138e-06
[INFO] >>> Starting fold 4 training (Trial #3) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2948, Train Acc: 0.9043 | Val Loss: 0.1254, Val Acc: 0.9535
[Fold 4 Epoch 2/10] Train Loss: 0.0758, Train Acc: 0.9756 | Val Loss: 0.1320, Val Acc: 0.9560
[Fold 4 Epoch 3/10] Train Loss: 0.0367, Train Acc: 0.9884 | Val Loss: 0.1101, Val Acc: 0.9628
[Fold 4 Epoch 4/10] Train Loss: 0.0238, Train Acc: 0.9928 | Val Loss: 0.1088, Val Acc: 0.9645
[Fold 4 Epoch 5/10] Train Loss: 0.0157, Train Acc: 0.9960 | Val Loss: 0.1269, Val Acc: 0.9628
[Fold 4 Epoch 6/10] Train Loss: 0.0107, Train Acc: 0.9971 | Val Loss: 0.1134, Val Acc: 0.9679
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9645

[OPTUNA] Trial #3: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=6.13968214228214e-05, weight_decay=2.1355311654407138e-06
[INFO] >>> Starting fold 5 training (Trial #3) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2906, Train Acc: 0.9031 | Val Loss: 0.1056, Val Acc: 0.9674
[Fold 5 Epoch 2/10] Train Loss: 0.0733, Train Acc: 0.9770 | Val Loss: 0.0929, Val Acc: 0.9685
[Fold 5 Epoch 3/10] Train Loss: 0.0416, Train Acc: 0.9870 | Val Loss: 0.0910, Val Acc: 0.9696
[Fold 5 Epoch 4/10] Train Loss: 0.0249, Train Acc: 0.9923 | Val Loss: 0.1018, Val Acc: 0.9691
[Fold 5 Epoch 5/10] Train Loss: 0.0175, Train Acc: 0.9950 | Val Loss: 0.1007, Val Acc: 0.9739
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9696

[OPTUNA] Trial #3 done. Fold Accuracies: [0.9750354609929078, 0.9724822695035461, 0.9775886524822694, 0.9645390070921985, 0.969645390070922]. Avg Acc=0.9719

[OPTUNA] Starting Trial #4 with lr=0.000927, weight_decay=0.004605
[OPTUNA] Trial #4: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0009274972810716985, weight_decay=0.004604800803526501
[INFO] >>> Starting fold 1 training (Trial #4) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.4506, Train Acc: 0.8389 | Val Loss: 1.0928, Val Acc: 0.6522
[Fold 1 Epoch 2/10] Train Loss: 0.3737, Train Acc: 0.8676 | Val Loss: 1.8079, Val Acc: 0.5850
[Fold 1 Epoch 3/10] Train Loss: 0.3328, Train Acc: 0.8821 | Val Loss: 0.5355, Val Acc: 0.7855
[Fold 1 Epoch 4/10] Train Loss: 0.3036, Train Acc: 0.8957 | Val Loss: 1.0302, Val Acc: 0.7067
[Fold 1 Epoch 5/10] Train Loss: 0.2758, Train Acc: 0.9064 | Val Loss: 1.6876, Val Acc: 0.5600
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.7855

[OPTUNA] Trial #4: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0009274972810716985, weight_decay=0.004604800803526501
[INFO] >>> Starting fold 2 training (Trial #4) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.4625, Train Acc: 0.8347 | Val Loss: 1.0163, Val Acc: 0.6948
[Fold 2 Epoch 2/10] Train Loss: 0.3732, Train Acc: 0.8646 | Val Loss: 0.6859, Val Acc: 0.7356
[Fold 2 Epoch 3/10] Train Loss: 0.3263, Train Acc: 0.8872 | Val Loss: 1.3322, Val Acc: 0.4142
[Fold 2 Epoch 4/10] Train Loss: 0.3059, Train Acc: 0.8918 | Val Loss: 1.0963, Val Acc: 0.6911
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.7356

[OPTUNA] Trial #4: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0009274972810716985, weight_decay=0.004604800803526501
[INFO] >>> Starting fold 3 training (Trial #4) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.4728, Train Acc: 0.8327 | Val Loss: 1.3546, Val Acc: 0.5367
[Fold 3 Epoch 2/10] Train Loss: 0.3716, Train Acc: 0.8680 | Val Loss: 2.9254, Val Acc: 0.2133
[Fold 3 Epoch 3/10] Train Loss: 0.3697, Train Acc: 0.8703 | Val Loss: 0.4940, Val Acc: 0.8712
[Fold 3 Epoch 4/10] Train Loss: 0.3099, Train Acc: 0.8943 | Val Loss: 0.8673, Val Acc: 0.7095
[Fold 3 Epoch 5/10] Train Loss: 0.2863, Train Acc: 0.9010 | Val Loss: 0.4994, Val Acc: 0.8740
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.8712

[OPTUNA] Trial #4: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0009274972810716985, weight_decay=0.004604800803526501
[INFO] >>> Starting fold 4 training (Trial #4) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.4622, Train Acc: 0.8381 | Val Loss: 1.5287, Val Acc: 0.6213
[Fold 4 Epoch 2/10] Train Loss: 0.3783, Train Acc: 0.8662 | Val Loss: 2.8835, Val Acc: 0.2950
[Fold 4 Epoch 3/10] Train Loss: 0.3314, Train Acc: 0.8840 | Val Loss: 0.6584, Val Acc: 0.7487
[Fold 4 Epoch 4/10] Train Loss: 0.3094, Train Acc: 0.8929 | Val Loss: 0.8316, Val Acc: 0.7197
[Fold 4 Epoch 5/10] Train Loss: 0.2828, Train Acc: 0.9038 | Val Loss: 0.3687, Val Acc: 0.8820
[Fold 4 Epoch 6/10] Train Loss: 0.2644, Train Acc: 0.9120 | Val Loss: 0.3705, Val Acc: 0.8715
[Fold 4 Epoch 7/10] Train Loss: 0.2503, Train Acc: 0.9161 | Val Loss: 1.3253, Val Acc: 0.6028
[INFO] Early stopping on fold 4 at epoch 7
[INFO] <<< Finished fold 4, best val acc = 0.8820

[OPTUNA] Trial #4: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0009274972810716985, weight_decay=0.004604800803526501
[INFO] >>> Starting fold 5 training (Trial #4) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.4937, Train Acc: 0.8248 | Val Loss: 1.4069, Val Acc: 0.3594
[Fold 5 Epoch 2/10] Train Loss: 0.4414, Train Acc: 0.8400 | Val Loss: 0.8585, Val Acc: 0.6990
[Fold 5 Epoch 3/10] Train Loss: 0.3813, Train Acc: 0.8643 | Val Loss: 0.8137, Val Acc: 0.7180
[Fold 5 Epoch 4/10] Train Loss: 0.3440, Train Acc: 0.8792 | Val Loss: 0.6848, Val Acc: 0.7557
[Fold 5 Epoch 5/10] Train Loss: 0.3238, Train Acc: 0.8879 | Val Loss: 0.3785, Val Acc: 0.8763
[Fold 5 Epoch 6/10] Train Loss: 0.3044, Train Acc: 0.8932 | Val Loss: 0.3922, Val Acc: 0.8871
[Fold 5 Epoch 7/10] Train Loss: 0.2885, Train Acc: 0.9000 | Val Loss: 0.6264, Val Acc: 0.7835
[INFO] Early stopping on fold 5 at epoch 7
[INFO] <<< Finished fold 5, best val acc = 0.8871

[OPTUNA] Trial #4 done. Fold Accuracies: [0.7855319148936171, 0.7356028368794326, 0.8712056737588653, 0.8819858156028368, 0.8870921985815603]. Avg Acc=0.8323

[OPTUNA] Starting Trial #5 with lr=0.000526, weight_decay=0.000010
[OPTUNA] Trial #5: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0005259197863882342, weight_decay=1.0179595651619139e-05
[INFO] >>> Starting fold 1 training (Trial #5) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3031, Train Acc: 0.8926 | Val Loss: 0.6063, Val Acc: 0.8145
[Fold 1 Epoch 2/10] Train Loss: 0.1554, Train Acc: 0.9447 | Val Loss: 0.1718, Val Acc: 0.9515
[Fold 1 Epoch 3/10] Train Loss: 0.1263, Train Acc: 0.9570 | Val Loss: 0.1309, Val Acc: 0.9594
[Fold 1 Epoch 4/10] Train Loss: 0.0844, Train Acc: 0.9726 | Val Loss: 0.1177, Val Acc: 0.9606
[Fold 1 Epoch 5/10] Train Loss: 0.0851, Train Acc: 0.9716 | Val Loss: 0.2420, Val Acc: 0.9382
[Fold 1 Epoch 6/10] Train Loss: 0.0680, Train Acc: 0.9773 | Val Loss: 0.2127, Val Acc: 0.9362
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9606

[OPTUNA] Trial #5: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0005259197863882342, weight_decay=1.0179595651619139e-05
[INFO] >>> Starting fold 2 training (Trial #5) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3055, Train Acc: 0.8936 | Val Loss: 0.2999, Val Acc: 0.9087
[Fold 2 Epoch 2/10] Train Loss: 0.1599, Train Acc: 0.9480 | Val Loss: 0.1490, Val Acc: 0.9461
[Fold 2 Epoch 3/10] Train Loss: 0.1143, Train Acc: 0.9605 | Val Loss: 0.1600, Val Acc: 0.9538
[Fold 2 Epoch 4/10] Train Loss: 0.1002, Train Acc: 0.9662 | Val Loss: 0.1129, Val Acc: 0.9586
[Fold 2 Epoch 5/10] Train Loss: 0.0808, Train Acc: 0.9723 | Val Loss: 0.0983, Val Acc: 0.9674
[Fold 2 Epoch 6/10] Train Loss: 0.0675, Train Acc: 0.9776 | Val Loss: 0.1743, Val Acc: 0.9487
[Fold 2 Epoch 7/10] Train Loss: 0.0642, Train Acc: 0.9787 | Val Loss: 0.2481, Val Acc: 0.9311
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val acc = 0.9674

[OPTUNA] Trial #5: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0005259197863882342, weight_decay=1.0179595651619139e-05
[INFO] >>> Starting fold 3 training (Trial #5) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3002, Train Acc: 0.8926 | Val Loss: 0.1764, Val Acc: 0.9441
[Fold 3 Epoch 2/10] Train Loss: 0.1569, Train Acc: 0.9467 | Val Loss: 0.1920, Val Acc: 0.9438
[Fold 3 Epoch 3/10] Train Loss: 0.1148, Train Acc: 0.9604 | Val Loss: 0.0891, Val Acc: 0.9711
[Fold 3 Epoch 4/10] Train Loss: 0.0900, Train Acc: 0.9694 | Val Loss: 0.1090, Val Acc: 0.9648
[Fold 3 Epoch 5/10] Train Loss: 0.0724, Train Acc: 0.9755 | Val Loss: 0.2527, Val Acc: 0.9305
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9711

[OPTUNA] Trial #5: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0005259197863882342, weight_decay=1.0179595651619139e-05
[INFO] >>> Starting fold 4 training (Trial #5) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3172, Train Acc: 0.8877 | Val Loss: 0.2185, Val Acc: 0.9262
[Fold 4 Epoch 2/10] Train Loss: 0.1588, Train Acc: 0.9466 | Val Loss: 0.1676, Val Acc: 0.9458
[Fold 4 Epoch 3/10] Train Loss: 0.1199, Train Acc: 0.9572 | Val Loss: 0.1770, Val Acc: 0.9410
[Fold 4 Epoch 4/10] Train Loss: 0.1002, Train Acc: 0.9645 | Val Loss: 0.1884, Val Acc: 0.9430
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9458

[OPTUNA] Trial #5: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0005259197863882342, weight_decay=1.0179595651619139e-05
[INFO] >>> Starting fold 5 training (Trial #5) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3116, Train Acc: 0.8927 | Val Loss: 0.4808, Val Acc: 0.8562
[Fold 5 Epoch 2/10] Train Loss: 0.1613, Train Acc: 0.9438 | Val Loss: 0.1228, Val Acc: 0.9631
[Fold 5 Epoch 3/10] Train Loss: 0.1223, Train Acc: 0.9576 | Val Loss: 0.1364, Val Acc: 0.9589
[Fold 5 Epoch 4/10] Train Loss: 0.0962, Train Acc: 0.9667 | Val Loss: 0.1357, Val Acc: 0.9549
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9631

[OPTUNA] Trial #5 done. Fold Accuracies: [0.9605673758865249, 0.9673758865248226, 0.971063829787234, 0.9458156028368795, 0.9631205673758865]. Avg Acc=0.9616

[OPTUNA] Starting Trial #6 with lr=0.000118, weight_decay=0.000007
[OPTUNA] Trial #6: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0001181127850617851, weight_decay=7.466351287598457e-06
[INFO] >>> Starting fold 1 training (Trial #6) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2596, Train Acc: 0.9126 | Val Loss: 0.1155, Val Acc: 0.9572
[Fold 1 Epoch 2/10] Train Loss: 0.0888, Train Acc: 0.9690 | Val Loss: 0.1141, Val Acc: 0.9654
[Fold 1 Epoch 3/10] Train Loss: 0.0598, Train Acc: 0.9809 | Val Loss: 0.0989, Val Acc: 0.9716
[Fold 1 Epoch 4/10] Train Loss: 0.0407, Train Acc: 0.9878 | Val Loss: 0.1044, Val Acc: 0.9753
[Fold 1 Epoch 5/10] Train Loss: 0.0320, Train Acc: 0.9896 | Val Loss: 0.1215, Val Acc: 0.9691
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9753

[OPTUNA] Trial #6: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0001181127850617851, weight_decay=7.466351287598457e-06
[INFO] >>> Starting fold 2 training (Trial #6) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2570, Train Acc: 0.9132 | Val Loss: 0.1713, Val Acc: 0.9467
[Fold 2 Epoch 2/10] Train Loss: 0.0858, Train Acc: 0.9716 | Val Loss: 0.1073, Val Acc: 0.9611
[Fold 2 Epoch 3/10] Train Loss: 0.0502, Train Acc: 0.9842 | Val Loss: 0.1056, Val Acc: 0.9662
[Fold 2 Epoch 4/10] Train Loss: 0.0420, Train Acc: 0.9869 | Val Loss: 0.1070, Val Acc: 0.9654
[Fold 2 Epoch 5/10] Train Loss: 0.0247, Train Acc: 0.9917 | Val Loss: 0.1277, Val Acc: 0.9685
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9662

[OPTUNA] Trial #6: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0001181127850617851, weight_decay=7.466351287598457e-06
[INFO] >>> Starting fold 3 training (Trial #6) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.2594, Train Acc: 0.9113 | Val Loss: 0.1068, Val Acc: 0.9657
[Fold 3 Epoch 2/10] Train Loss: 0.0891, Train Acc: 0.9705 | Val Loss: 0.1239, Val Acc: 0.9591
[Fold 3 Epoch 3/10] Train Loss: 0.0539, Train Acc: 0.9816 | Val Loss: 0.1108, Val Acc: 0.9651
[INFO] Early stopping on fold 3 at epoch 3
[INFO] <<< Finished fold 3, best val acc = 0.9657

[OPTUNA] Trial #6: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0001181127850617851, weight_decay=7.466351287598457e-06
[INFO] >>> Starting fold 4 training (Trial #6) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2631, Train Acc: 0.9096 | Val Loss: 0.1137, Val Acc: 0.9586
[Fold 4 Epoch 2/10] Train Loss: 0.0916, Train Acc: 0.9690 | Val Loss: 0.1193, Val Acc: 0.9606
[Fold 4 Epoch 3/10] Train Loss: 0.0532, Train Acc: 0.9833 | Val Loss: 0.1090, Val Acc: 0.9660
[Fold 4 Epoch 4/10] Train Loss: 0.0345, Train Acc: 0.9884 | Val Loss: 0.1250, Val Acc: 0.9626
[Fold 4 Epoch 5/10] Train Loss: 0.0303, Train Acc: 0.9900 | Val Loss: 0.1774, Val Acc: 0.9515
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9660

[OPTUNA] Trial #6: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0001181127850617851, weight_decay=7.466351287598457e-06
[INFO] >>> Starting fold 5 training (Trial #6) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2685, Train Acc: 0.9080 | Val Loss: 0.1086, Val Acc: 0.9665
[Fold 5 Epoch 2/10] Train Loss: 0.0905, Train Acc: 0.9688 | Val Loss: 0.1083, Val Acc: 0.9660
[Fold 5 Epoch 3/10] Train Loss: 0.0467, Train Acc: 0.9839 | Val Loss: 0.1075, Val Acc: 0.9668
[Fold 5 Epoch 4/10] Train Loss: 0.0403, Train Acc: 0.9876 | Val Loss: 0.0947, Val Acc: 0.9694
[Fold 5 Epoch 5/10] Train Loss: 0.0282, Train Acc: 0.9912 | Val Loss: 0.1002, Val Acc: 0.9694
[Fold 5 Epoch 6/10] Train Loss: 0.0347, Train Acc: 0.9893 | Val Loss: 0.0901, Val Acc: 0.9719
[Fold 5 Epoch 7/10] Train Loss: 0.0233, Train Acc: 0.9930 | Val Loss: 0.1275, Val Acc: 0.9626
[Fold 5 Epoch 8/10] Train Loss: 0.0268, Train Acc: 0.9921 | Val Loss: 0.1012, Val Acc: 0.9748
[INFO] Early stopping on fold 5 at epoch 8
[INFO] <<< Finished fold 5, best val acc = 0.9719

[OPTUNA] Trial #6 done. Fold Accuracies: [0.9753191489361702, 0.9662411347517731, 0.9656737588652482, 0.9659574468085106, 0.9719148936170213]. Avg Acc=0.9690

[OPTUNA] Starting Trial #7 with lr=0.000197, weight_decay=0.009678
[OPTUNA] Trial #7: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0001966119293833521, weight_decay=0.009678401099320989
[INFO] >>> Starting fold 1 training (Trial #7) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2815, Train Acc: 0.9055 | Val Loss: 0.2097, Val Acc: 0.9330
[Fold 1 Epoch 2/10] Train Loss: 0.1938, Train Acc: 0.9342 | Val Loss: 0.2170, Val Acc: 0.9424
[Fold 1 Epoch 3/10] Train Loss: 0.1869, Train Acc: 0.9381 | Val Loss: 0.2246, Val Acc: 0.9336
[INFO] Early stopping on fold 1 at epoch 3
[INFO] <<< Finished fold 1, best val acc = 0.9424

[OPTUNA] Trial #7: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0001966119293833521, weight_decay=0.009678401099320989
[INFO] >>> Starting fold 2 training (Trial #7) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2747, Train Acc: 0.9071 | Val Loss: 0.1880, Val Acc: 0.9365
[Fold 2 Epoch 2/10] Train Loss: 0.1867, Train Acc: 0.9398 | Val Loss: 0.2642, Val Acc: 0.9274
[Fold 2 Epoch 3/10] Train Loss: 0.1953, Train Acc: 0.9356 | Val Loss: 0.2314, Val Acc: 0.9316
[INFO] Early stopping on fold 2 at epoch 3
[INFO] <<< Finished fold 2, best val acc = 0.9365

[OPTUNA] Trial #7: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0001966119293833521, weight_decay=0.009678401099320989
[INFO] >>> Starting fold 3 training (Trial #7) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.2931, Train Acc: 0.9001 | Val Loss: 0.2591, Val Acc: 0.9174
[Fold 3 Epoch 2/10] Train Loss: 0.1927, Train Acc: 0.9367 | Val Loss: 0.2004, Val Acc: 0.9373
[Fold 3 Epoch 3/10] Train Loss: 0.1956, Train Acc: 0.9343 | Val Loss: 0.3120, Val Acc: 0.8806
[Fold 3 Epoch 4/10] Train Loss: 0.1768, Train Acc: 0.9406 | Val Loss: 0.4353, Val Acc: 0.8982
[INFO] Early stopping on fold 3 at epoch 4
[INFO] <<< Finished fold 3, best val acc = 0.9373

[OPTUNA] Trial #7: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0001966119293833521, weight_decay=0.009678401099320989
[INFO] >>> Starting fold 4 training (Trial #7) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2891, Train Acc: 0.9006 | Val Loss: 0.3399, Val Acc: 0.8851
[Fold 4 Epoch 2/10] Train Loss: 0.1967, Train Acc: 0.9348 | Val Loss: 0.3332, Val Acc: 0.8757
[Fold 4 Epoch 3/10] Train Loss: 0.1815, Train Acc: 0.9406 | Val Loss: 0.3414, Val Acc: 0.8911
[Fold 4 Epoch 4/10] Train Loss: 0.1779, Train Acc: 0.9435 | Val Loss: 0.1924, Val Acc: 0.9407
[Fold 4 Epoch 5/10] Train Loss: 0.1638, Train Acc: 0.9484 | Val Loss: 0.2979, Val Acc: 0.9118
[Fold 4 Epoch 6/10] Train Loss: 0.1510, Train Acc: 0.9496 | Val Loss: 0.3877, Val Acc: 0.9052
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9407

[OPTUNA] Trial #7: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0001966119293833521, weight_decay=0.009678401099320989
[INFO] >>> Starting fold 5 training (Trial #7) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2876, Train Acc: 0.9003 | Val Loss: 0.2914, Val Acc: 0.9024
[Fold 5 Epoch 2/10] Train Loss: 0.1846, Train Acc: 0.9402 | Val Loss: 0.2271, Val Acc: 0.9316
[Fold 5 Epoch 3/10] Train Loss: 0.1771, Train Acc: 0.9435 | Val Loss: 0.2093, Val Acc: 0.9348
[Fold 5 Epoch 4/10] Train Loss: 0.1760, Train Acc: 0.9424 | Val Loss: 0.2950, Val Acc: 0.9092
[Fold 5 Epoch 5/10] Train Loss: 0.1646, Train Acc: 0.9464 | Val Loss: 0.1903, Val Acc: 0.9353
[Fold 5 Epoch 6/10] Train Loss: 0.1752, Train Acc: 0.9415 | Val Loss: 0.1979, Val Acc: 0.9370
[Fold 5 Epoch 7/10] Train Loss: 0.1550, Train Acc: 0.9514 | Val Loss: 0.1479, Val Acc: 0.9617
[Fold 5 Epoch 8/10] Train Loss: 0.1417, Train Acc: 0.9560 | Val Loss: 0.1945, Val Acc: 0.9433
[Fold 5 Epoch 9/10] Train Loss: 0.1479, Train Acc: 0.9528 | Val Loss: 0.1725, Val Acc: 0.9504
[INFO] Early stopping on fold 5 at epoch 9
[INFO] <<< Finished fold 5, best val acc = 0.9617

[OPTUNA] Trial #7 done. Fold Accuracies: [0.9424113475177305, 0.9364539007092199, 0.9373049645390071, 0.940709219858156, 0.9617021276595744]. Avg Acc=0.9437

[OPTUNA] Starting Trial #8 with lr=0.000045, weight_decay=0.000112
[OPTUNA] Trial #8: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=4.542876681460975e-05, weight_decay=0.00011220863736562025
[INFO] >>> Starting fold 1 training (Trial #8) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3309, Train Acc: 0.8930 | Val Loss: 0.1179, Val Acc: 0.9614
[Fold 1 Epoch 2/10] Train Loss: 0.0745, Train Acc: 0.9762 | Val Loss: 0.1153, Val Acc: 0.9643
[Fold 1 Epoch 3/10] Train Loss: 0.0278, Train Acc: 0.9923 | Val Loss: 0.1091, Val Acc: 0.9643
[Fold 1 Epoch 4/10] Train Loss: 0.0203, Train Acc: 0.9942 | Val Loss: 0.0984, Val Acc: 0.9711
[Fold 1 Epoch 5/10] Train Loss: 0.0161, Train Acc: 0.9956 | Val Loss: 0.1191, Val Acc: 0.9611
[Fold 1 Epoch 6/10] Train Loss: 0.0124, Train Acc: 0.9967 | Val Loss: 0.1067, Val Acc: 0.9711
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9711

[OPTUNA] Trial #8: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=4.542876681460975e-05, weight_decay=0.00011220863736562025
[INFO] >>> Starting fold 2 training (Trial #8) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3529, Train Acc: 0.8841 | Val Loss: 0.1172, Val Acc: 0.9577
[Fold 2 Epoch 2/10] Train Loss: 0.0868, Train Acc: 0.9722 | Val Loss: 0.0911, Val Acc: 0.9702
[Fold 2 Epoch 3/10] Train Loss: 0.0339, Train Acc: 0.9898 | Val Loss: 0.1077, Val Acc: 0.9634
[Fold 2 Epoch 4/10] Train Loss: 0.0256, Train Acc: 0.9932 | Val Loss: 0.0909, Val Acc: 0.9719
[Fold 2 Epoch 5/10] Train Loss: 0.0124, Train Acc: 0.9973 | Val Loss: 0.1061, Val Acc: 0.9679
[Fold 2 Epoch 6/10] Train Loss: 0.0115, Train Acc: 0.9967 | Val Loss: 0.1100, Val Acc: 0.9645
[INFO] Early stopping on fold 2 at epoch 6
[INFO] <<< Finished fold 2, best val acc = 0.9719

[OPTUNA] Trial #8: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=4.542876681460975e-05, weight_decay=0.00011220863736562025
[INFO] >>> Starting fold 3 training (Trial #8) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3384, Train Acc: 0.8903 | Val Loss: 0.1296, Val Acc: 0.9560
[Fold 3 Epoch 2/10] Train Loss: 0.0747, Train Acc: 0.9759 | Val Loss: 0.0909, Val Acc: 0.9713
[Fold 3 Epoch 3/10] Train Loss: 0.0305, Train Acc: 0.9919 | Val Loss: 0.1228, Val Acc: 0.9620
[Fold 3 Epoch 4/10] Train Loss: 0.0174, Train Acc: 0.9959 | Val Loss: 0.0826, Val Acc: 0.9722
[Fold 3 Epoch 5/10] Train Loss: 0.0150, Train Acc: 0.9957 | Val Loss: 0.0870, Val Acc: 0.9748
[Fold 3 Epoch 6/10] Train Loss: 0.0135, Train Acc: 0.9967 | Val Loss: 0.1013, Val Acc: 0.9736
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val acc = 0.9748

[OPTUNA] Trial #8: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=4.542876681460975e-05, weight_decay=0.00011220863736562025
[INFO] >>> Starting fold 4 training (Trial #8) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3383, Train Acc: 0.8877 | Val Loss: 0.1543, Val Acc: 0.9478
[Fold 4 Epoch 2/10] Train Loss: 0.0719, Train Acc: 0.9767 | Val Loss: 0.1067, Val Acc: 0.9594
[Fold 4 Epoch 3/10] Train Loss: 0.0310, Train Acc: 0.9907 | Val Loss: 0.1051, Val Acc: 0.9654
[Fold 4 Epoch 4/10] Train Loss: 0.0199, Train Acc: 0.9947 | Val Loss: 0.1529, Val Acc: 0.9569
[Fold 4 Epoch 5/10] Train Loss: 0.0163, Train Acc: 0.9954 | Val Loss: 0.1204, Val Acc: 0.9611
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9654

[OPTUNA] Trial #8: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=4.542876681460975e-05, weight_decay=0.00011220863736562025
[INFO] >>> Starting fold 5 training (Trial #8) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3382, Train Acc: 0.8852 | Val Loss: 0.1170, Val Acc: 0.9637
[Fold 5 Epoch 2/10] Train Loss: 0.0756, Train Acc: 0.9765 | Val Loss: 0.1025, Val Acc: 0.9623
[Fold 5 Epoch 3/10] Train Loss: 0.0360, Train Acc: 0.9897 | Val Loss: 0.0891, Val Acc: 0.9699
[Fold 5 Epoch 4/10] Train Loss: 0.0243, Train Acc: 0.9933 | Val Loss: 0.0950, Val Acc: 0.9702
[Fold 5 Epoch 5/10] Train Loss: 0.0132, Train Acc: 0.9967 | Val Loss: 0.0989, Val Acc: 0.9679
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9702

[OPTUNA] Trial #8 done. Fold Accuracies: [0.971063829787234, 0.9719148936170213, 0.9747517730496454, 0.9653900709219858, 0.9702127659574468]. Avg Acc=0.9707

[OPTUNA] Starting Trial #9 with lr=0.000398, weight_decay=0.000002
[OPTUNA] Trial #9: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00039826679258327097, weight_decay=1.674304678316113e-06
[INFO] >>> Starting fold 1 training (Trial #9) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2830, Train Acc: 0.9010 | Val Loss: 0.1933, Val Acc: 0.9390
[Fold 1 Epoch 2/10] Train Loss: 0.1413, Train Acc: 0.9541 | Val Loss: 0.1360, Val Acc: 0.9555
[Fold 1 Epoch 3/10] Train Loss: 0.1014, Train Acc: 0.9662 | Val Loss: 0.1090, Val Acc: 0.9637
[Fold 1 Epoch 4/10] Train Loss: 0.0851, Train Acc: 0.9721 | Val Loss: 0.1292, Val Acc: 0.9606
[Fold 1 Epoch 5/10] Train Loss: 0.0716, Train Acc: 0.9760 | Val Loss: 0.1344, Val Acc: 0.9572
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9637

[OPTUNA] Trial #9: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00039826679258327097, weight_decay=1.674304678316113e-06
[INFO] >>> Starting fold 2 training (Trial #9) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2947, Train Acc: 0.8962 | Val Loss: 0.4177, Val Acc: 0.8485
[Fold 2 Epoch 2/10] Train Loss: 0.1471, Train Acc: 0.9502 | Val Loss: 0.2413, Val Acc: 0.9288
[Fold 2 Epoch 3/10] Train Loss: 0.1126, Train Acc: 0.9617 | Val Loss: 0.1451, Val Acc: 0.9498
[Fold 2 Epoch 4/10] Train Loss: 0.0858, Train Acc: 0.9713 | Val Loss: 0.1366, Val Acc: 0.9574
[Fold 2 Epoch 5/10] Train Loss: 0.0675, Train Acc: 0.9779 | Val Loss: 0.1697, Val Acc: 0.9464
[Fold 2 Epoch 6/10] Train Loss: 0.0523, Train Acc: 0.9821 | Val Loss: 0.1675, Val Acc: 0.9472
[INFO] Early stopping on fold 2 at epoch 6
[INFO] <<< Finished fold 2, best val acc = 0.9574

[OPTUNA] Trial #9: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00039826679258327097, weight_decay=1.674304678316113e-06
[INFO] >>> Starting fold 3 training (Trial #9) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.2852, Train Acc: 0.9004 | Val Loss: 0.1805, Val Acc: 0.9399
[Fold 3 Epoch 2/10] Train Loss: 0.1472, Train Acc: 0.9496 | Val Loss: 0.1826, Val Acc: 0.9342
[Fold 3 Epoch 3/10] Train Loss: 0.1077, Train Acc: 0.9618 | Val Loss: 0.0907, Val Acc: 0.9679
[Fold 3 Epoch 4/10] Train Loss: 0.0836, Train Acc: 0.9711 | Val Loss: 0.1905, Val Acc: 0.9336
[Fold 3 Epoch 5/10] Train Loss: 0.0667, Train Acc: 0.9782 | Val Loss: 0.0797, Val Acc: 0.9753
[Fold 3 Epoch 6/10] Train Loss: 0.0545, Train Acc: 0.9817 | Val Loss: 0.1258, Val Acc: 0.9580
[Fold 3 Epoch 7/10] Train Loss: 0.0563, Train Acc: 0.9809 | Val Loss: 0.1093, Val Acc: 0.9617
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9753

[OPTUNA] Trial #9: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00039826679258327097, weight_decay=1.674304678316113e-06
[INFO] >>> Starting fold 4 training (Trial #9) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2913, Train Acc: 0.8987 | Val Loss: 0.3376, Val Acc: 0.8979
[Fold 4 Epoch 2/10] Train Loss: 0.1456, Train Acc: 0.9502 | Val Loss: 0.1515, Val Acc: 0.9484
[Fold 4 Epoch 3/10] Train Loss: 0.1064, Train Acc: 0.9626 | Val Loss: 0.1232, Val Acc: 0.9583
[Fold 4 Epoch 4/10] Train Loss: 0.0843, Train Acc: 0.9723 | Val Loss: 0.1328, Val Acc: 0.9574
[Fold 4 Epoch 5/10] Train Loss: 0.0657, Train Acc: 0.9789 | Val Loss: 0.1576, Val Acc: 0.9538
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9583

[OPTUNA] Trial #9: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00039826679258327097, weight_decay=1.674304678316113e-06
[INFO] >>> Starting fold 5 training (Trial #9) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2952, Train Acc: 0.8988 | Val Loss: 0.1787, Val Acc: 0.9353
[Fold 5 Epoch 2/10] Train Loss: 0.1361, Train Acc: 0.9553 | Val Loss: 0.1453, Val Acc: 0.9529
[Fold 5 Epoch 3/10] Train Loss: 0.1042, Train Acc: 0.9657 | Val Loss: 0.1115, Val Acc: 0.9626
[Fold 5 Epoch 4/10] Train Loss: 0.0806, Train Acc: 0.9733 | Val Loss: 0.1227, Val Acc: 0.9643
[Fold 5 Epoch 5/10] Train Loss: 0.0653, Train Acc: 0.9793 | Val Loss: 0.1308, Val Acc: 0.9614
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9643

[OPTUNA] Trial #9 done. Fold Accuracies: [0.9636879432624114, 0.9574468085106383, 0.9753191489361702, 0.9582978723404255, 0.9642553191489361]. Avg Acc=0.9638
[OPTUNA] Best trial found:
  Trial number: 3
  Avg k-fold acc: 0.9719
    lr: 6.13968214228214e-05
    weight_decay: 2.1355311654407138e-06

[INFO] Retraining final model on entire training set using best hyperparams...
[DEBUG] Creating ResNet50 with lr=6.13968214228214e-05, weight_decay=2.1355311654407138e-06
[Final Train] Epoch 1/5 - Loss: 0.2600, Acc: 0.9126
[Final Train] Epoch 2/5 - Loss: 0.0680, Acc: 0.9769
[Final Train] Epoch 3/5 - Loss: 0.0339, Acc: 0.9888
[Final Train] Epoch 4/5 - Loss: 0.0298, Acc: 0.9910
[Final Train] Epoch 5/5 - Loss: 0.0192, Acc: 0.9941

[INFO] Evaluating final model on test set...
[RESULT] Final Test Accuracy: 0.7827

[RESULT] Classification Report:
              precision    recall  f1-score   support

      Center       0.80      0.83      0.82       832
       Donut       0.72      0.57      0.63       146
    Edge-Loc       0.76      0.87      0.81      2772
   Edge-Ring       0.84      0.85      0.85      1126
         Loc       0.79      0.67      0.72      1973
   Near-full       0.87      0.94      0.90        95
      Random       0.81      0.71      0.76       257
     Scratch       0.73      0.64      0.68       693

    accuracy                           0.78      7894
   macro avg       0.79      0.76      0.77      7894
weighted avg       0.78      0.78      0.78      7894

[INFO] Final model saved to final_model.pth

[INFO] Done. You can now view logs in TensorBoard and the Optuna dashboard.
