PYTHONPATH=~/tmp/miniconda3/envs/MaProject/bin/python:
[I 2025-02-24 15:56:07,824] A new study created in RDB with name: resnet_wafer_1740408967
[I 2025-02-24 16:38:16,824] Trial 0 finished with value: 0.10297212052371055 and parameters: {'lr': 1.4250223170470642e-05, 'weight_decay': 0.0012455073280820358}. Best is trial 0 with value: 0.10297212052371055.
[I 2025-02-24 17:07:28,273] Trial 1 finished with value: 0.0951560701455102 and parameters: {'lr': 5.2603377793610046e-05, 'weight_decay': 6.206228779142981e-05}. Best is trial 1 with value: 0.0951560701455102.
[I 2025-02-24 17:31:17,293] Trial 2 finished with value: 0.09614616669381836 and parameters: {'lr': 2.4639744842601905e-05, 'weight_decay': 0.004623953922729007}. Best is trial 1 with value: 0.0951560701455102.
[I 2025-02-24 18:11:15,550] Trial 3 finished with value: 0.12053699308517787 and parameters: {'lr': 0.0007093973768065797, 'weight_decay': 4.210818933485844e-06}. Best is trial 1 with value: 0.0951560701455102.
[I 2025-02-24 18:40:27,749] Trial 4 finished with value: 0.08901962529406385 and parameters: {'lr': 6.373277937233127e-05, 'weight_decay': 5.042095104477667e-06}. Best is trial 4 with value: 0.08901962529406385.
[I 2025-02-24 19:02:04,885] Trial 5 pruned. 
[I 2025-02-24 19:36:44,050] Trial 6 pruned. 
[I 2025-02-24 20:08:08,121] Trial 7 pruned. 
[I 2025-02-24 20:42:35,122] Trial 8 pruned. 
[I 2025-02-24 21:08:33,470] Trial 9 finished with value: 0.09436733415610174 and parameters: {'lr': 4.236554984057559e-05, 'weight_decay': 3.104719420568497e-05}. Best is trial 4 with value: 0.08901962529406385.
Loaded configuration:
{'experiment': {'reproducibility': True, 'seed': 42, 'num_trials': 10, 'num_epochs': 10, 'final_epochs': 5, 'save_model': True, 'model_save_path': 'final_model.pth', 'suggest': {'lr': {'low': '1e-5', 'high': '1e-3', 'log': True}, 'weight_decay': {'low': '1e-6', 'high': '1e-2', 'log': True}}}, 'model': {'type': 'resnet50', 'lr': '1e-4', 'weight_decay': '1e-4'}, 'dataset': {'path': '/home/anhcao/tmp/Dataset/Wafermap-dataset/WM811K.pkl'}}
[INFO] Reproducibility enabled. Seed set to 42
[INFO] Using device: cuda
[INFO] Number of classes: 8
[INFO] Classes: ['Center' 'Donut' 'Edge-Loc' 'Edge-Ring' 'Loc' 'Near-full' 'Random'
 'Scratch']
[INFO] Creating Optuna study 'resnet_wafer_1740408967' with DB file: sqlite:///resnet_wafer_v2.db
[INFO] Starting study.optimize with 10 trials...


[OPTUNA] Starting Trial #0 with lr=0.000014, weight_decay=0.001246
[OPTUNA] Trial #0: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=1.4250223170470642e-05, weight_decay=0.0012455073280820358
[INFO] >>> Starting fold 1 training (Trial #0) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.5759, Train Acc: 0.8239 | Val Loss: 0.2472, Val Acc: 0.9177
[Fold 1 Epoch 2/10] Train Loss: 0.1590, Train Acc: 0.9525 | Val Loss: 0.1323, Val Acc: 0.9583
[Fold 1 Epoch 3/10] Train Loss: 0.0604, Train Acc: 0.9848 | Val Loss: 0.1105, Val Acc: 0.9699
[Fold 1 Epoch 4/10] Train Loss: 0.0275, Train Acc: 0.9945 | Val Loss: 0.1236, Val Acc: 0.9662
[Fold 1 Epoch 5/10] Train Loss: 0.0161, Train Acc: 0.9972 | Val Loss: 0.1058, Val Acc: 0.9691
[Fold 1 Epoch 6/10] Train Loss: 0.0084, Train Acc: 0.9994 | Val Loss: 0.1153, Val Acc: 0.9699
[Fold 1 Epoch 7/10] Train Loss: 0.0065, Train Acc: 0.9993 | Val Loss: 0.1058, Val Acc: 0.9716
[Fold 1 Epoch 8/10] Train Loss: 0.0055, Train Acc: 0.9993 | Val Loss: 0.1188, Val Acc: 0.9699
[Fold 1 Epoch 9/10] Train Loss: 0.0048, Train Acc: 0.9997 | Val Loss: 0.1146, Val Acc: 0.9694
[INFO] Early stopping on fold 1 at epoch 9
[INFO] <<< Finished fold 1, best val loss = 0.1058

[OPTUNA] Trial #0: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=1.4250223170470642e-05, weight_decay=0.0012455073280820358
[INFO] >>> Starting fold 2 training (Trial #0) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.5596, Train Acc: 0.8338 | Val Loss: 0.2302, Val Acc: 0.9302
[Fold 2 Epoch 2/10] Train Loss: 0.1586, Train Acc: 0.9533 | Val Loss: 0.1182, Val Acc: 0.9631
[Fold 2 Epoch 3/10] Train Loss: 0.0604, Train Acc: 0.9863 | Val Loss: 0.1024, Val Acc: 0.9660
[Fold 2 Epoch 4/10] Train Loss: 0.0262, Train Acc: 0.9954 | Val Loss: 0.0992, Val Acc: 0.9643
[Fold 2 Epoch 5/10] Train Loss: 0.0144, Train Acc: 0.9983 | Val Loss: 0.1068, Val Acc: 0.9651
[Fold 2 Epoch 6/10] Train Loss: 0.0089, Train Acc: 0.9991 | Val Loss: 0.1033, Val Acc: 0.9654
[INFO] Early stopping on fold 2 at epoch 6
[INFO] <<< Finished fold 2, best val loss = 0.0992

[OPTUNA] Trial #0: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=1.4250223170470642e-05, weight_decay=0.0012455073280820358
[INFO] >>> Starting fold 3 training (Trial #0) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.5972, Train Acc: 0.8140 | Val Loss: 0.2322, Val Acc: 0.9279
[Fold 3 Epoch 2/10] Train Loss: 0.1613, Train Acc: 0.9513 | Val Loss: 0.1199, Val Acc: 0.9611
[Fold 3 Epoch 3/10] Train Loss: 0.0630, Train Acc: 0.9855 | Val Loss: 0.1062, Val Acc: 0.9623
[Fold 3 Epoch 4/10] Train Loss: 0.0280, Train Acc: 0.9953 | Val Loss: 0.0947, Val Acc: 0.9665
[Fold 3 Epoch 5/10] Train Loss: 0.0165, Train Acc: 0.9975 | Val Loss: 0.0909, Val Acc: 0.9682
[Fold 3 Epoch 6/10] Train Loss: 0.0094, Train Acc: 0.9989 | Val Loss: 0.0924, Val Acc: 0.9671
[Fold 3 Epoch 7/10] Train Loss: 0.0064, Train Acc: 0.9992 | Val Loss: 0.0903, Val Acc: 0.9713
[Fold 3 Epoch 8/10] Train Loss: 0.0041, Train Acc: 0.9999 | Val Loss: 0.1007, Val Acc: 0.9657
[Fold 3 Epoch 9/10] Train Loss: 0.0054, Train Acc: 0.9994 | Val Loss: 0.1024, Val Acc: 0.9662
[INFO] Early stopping on fold 3 at epoch 9
[INFO] <<< Finished fold 3, best val loss = 0.0903

[OPTUNA] Trial #0: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=1.4250223170470642e-05, weight_decay=0.0012455073280820358
[INFO] >>> Starting fold 4 training (Trial #0) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.5993, Train Acc: 0.8126 | Val Loss: 0.2577, Val Acc: 0.9166
[Fold 4 Epoch 2/10] Train Loss: 0.1556, Train Acc: 0.9523 | Val Loss: 0.1443, Val Acc: 0.9538
[Fold 4 Epoch 3/10] Train Loss: 0.0592, Train Acc: 0.9861 | Val Loss: 0.1129, Val Acc: 0.9586
[Fold 4 Epoch 4/10] Train Loss: 0.0270, Train Acc: 0.9951 | Val Loss: 0.1308, Val Acc: 0.9586
[Fold 4 Epoch 5/10] Train Loss: 0.0154, Train Acc: 0.9975 | Val Loss: 0.1256, Val Acc: 0.9611
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val loss = 0.1129

[OPTUNA] Trial #0: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=1.4250223170470642e-05, weight_decay=0.0012455073280820358
[INFO] >>> Starting fold 5 training (Trial #0) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.6143, Train Acc: 0.8066 | Val Loss: 0.2620, Val Acc: 0.9200
[Fold 5 Epoch 2/10] Train Loss: 0.1771, Train Acc: 0.9450 | Val Loss: 0.1231, Val Acc: 0.9614
[Fold 5 Epoch 3/10] Train Loss: 0.0634, Train Acc: 0.9840 | Val Loss: 0.1100, Val Acc: 0.9620
[Fold 5 Epoch 4/10] Train Loss: 0.0256, Train Acc: 0.9961 | Val Loss: 0.1094, Val Acc: 0.9645
[Fold 5 Epoch 5/10] Train Loss: 0.0169, Train Acc: 0.9977 | Val Loss: 0.1092, Val Acc: 0.9654
[Fold 5 Epoch 6/10] Train Loss: 0.0089, Train Acc: 0.9993 | Val Loss: 0.1078, Val Acc: 0.9640
[Fold 5 Epoch 7/10] Train Loss: 0.0077, Train Acc: 0.9991 | Val Loss: 0.1242, Val Acc: 0.9634
[Fold 5 Epoch 8/10] Train Loss: 0.0075, Train Acc: 0.9989 | Val Loss: 0.1067, Val Acc: 0.9660
[Fold 5 Epoch 9/10] Train Loss: 0.0040, Train Acc: 0.9996 | Val Loss: 0.1159, Val Acc: 0.9643
[Fold 5 Epoch 10/10] Train Loss: 0.0029, Train Acc: 1.0000 | Val Loss: 0.1157, Val Acc: 0.9640
[INFO] Early stopping on fold 5 at epoch 10
[INFO] <<< Finished fold 5, best val loss = 0.1067

[OPTUNA] Trial #0 done. Fold Losses: [0.10577379860686571, 0.09918972890383364, 0.09028588669233224, 0.11291787756324213, 0.10669331085227896]. Avg Loss=0.1030

[OPTUNA] Starting Trial #1 with lr=0.000053, weight_decay=0.000062
[OPTUNA] Trial #1: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=5.2603377793610046e-05, weight_decay=6.206228779142981e-05
[INFO] >>> Starting fold 1 training (Trial #1) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3105, Train Acc: 0.8989 | Val Loss: 0.1210, Val Acc: 0.9643
[Fold 1 Epoch 2/10] Train Loss: 0.0743, Train Acc: 0.9761 | Val Loss: 0.1234, Val Acc: 0.9645
[Fold 1 Epoch 3/10] Train Loss: 0.0330, Train Acc: 0.9896 | Val Loss: 0.0926, Val Acc: 0.9742
[Fold 1 Epoch 4/10] Train Loss: 0.0203, Train Acc: 0.9942 | Val Loss: 0.0882, Val Acc: 0.9728
[Fold 1 Epoch 5/10] Train Loss: 0.0091, Train Acc: 0.9979 | Val Loss: 0.1219, Val Acc: 0.9694
[Fold 1 Epoch 6/10] Train Loss: 0.0219, Train Acc: 0.9927 | Val Loss: 0.1031, Val Acc: 0.9679
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val loss = 0.0882

[OPTUNA] Trial #1: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=5.2603377793610046e-05, weight_decay=6.206228779142981e-05
[INFO] >>> Starting fold 2 training (Trial #1) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3228, Train Acc: 0.8929 | Val Loss: 0.1375, Val Acc: 0.9529
[Fold 2 Epoch 2/10] Train Loss: 0.0779, Train Acc: 0.9750 | Val Loss: 0.1094, Val Acc: 0.9640
[Fold 2 Epoch 3/10] Train Loss: 0.0369, Train Acc: 0.9892 | Val Loss: 0.1007, Val Acc: 0.9685
[Fold 2 Epoch 4/10] Train Loss: 0.0288, Train Acc: 0.9915 | Val Loss: 0.1157, Val Acc: 0.9634
[Fold 2 Epoch 5/10] Train Loss: 0.0168, Train Acc: 0.9956 | Val Loss: 0.1099, Val Acc: 0.9668
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val loss = 0.1007

[OPTUNA] Trial #1: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=5.2603377793610046e-05, weight_decay=6.206228779142981e-05
[INFO] >>> Starting fold 3 training (Trial #1) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3277, Train Acc: 0.8936 | Val Loss: 0.1271, Val Acc: 0.9577
[Fold 3 Epoch 2/10] Train Loss: 0.0765, Train Acc: 0.9766 | Val Loss: 0.0962, Val Acc: 0.9645
[Fold 3 Epoch 3/10] Train Loss: 0.0365, Train Acc: 0.9891 | Val Loss: 0.0910, Val Acc: 0.9730
[Fold 3 Epoch 4/10] Train Loss: 0.0170, Train Acc: 0.9957 | Val Loss: 0.0924, Val Acc: 0.9725
[Fold 3 Epoch 5/10] Train Loss: 0.0120, Train Acc: 0.9972 | Val Loss: 0.1259, Val Acc: 0.9640
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val loss = 0.0910

[OPTUNA] Trial #1: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=5.2603377793610046e-05, weight_decay=6.206228779142981e-05
[INFO] >>> Starting fold 4 training (Trial #1) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3255, Train Acc: 0.8939 | Val Loss: 0.1165, Val Acc: 0.9603
[Fold 4 Epoch 2/10] Train Loss: 0.0745, Train Acc: 0.9757 | Val Loss: 0.1121, Val Acc: 0.9614
[Fold 4 Epoch 3/10] Train Loss: 0.0344, Train Acc: 0.9902 | Val Loss: 0.1091, Val Acc: 0.9643
[Fold 4 Epoch 4/10] Train Loss: 0.0230, Train Acc: 0.9943 | Val Loss: 0.1092, Val Acc: 0.9691
[Fold 4 Epoch 5/10] Train Loss: 0.0139, Train Acc: 0.9965 | Val Loss: 0.1342, Val Acc: 0.9628
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val loss = 0.1091

[OPTUNA] Trial #1: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=5.2603377793610046e-05, weight_decay=6.206228779142981e-05
[INFO] >>> Starting fold 5 training (Trial #1) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3189, Train Acc: 0.8944 | Val Loss: 0.1142, Val Acc: 0.9628
[Fold 5 Epoch 2/10] Train Loss: 0.0721, Train Acc: 0.9758 | Val Loss: 0.1058, Val Acc: 0.9651
[Fold 5 Epoch 3/10] Train Loss: 0.0334, Train Acc: 0.9904 | Val Loss: 0.0896, Val Acc: 0.9716
[Fold 5 Epoch 4/10] Train Loss: 0.0196, Train Acc: 0.9945 | Val Loss: 0.0867, Val Acc: 0.9739
[Fold 5 Epoch 5/10] Train Loss: 0.0143, Train Acc: 0.9964 | Val Loss: 0.1002, Val Acc: 0.9711
[Fold 5 Epoch 6/10] Train Loss: 0.0244, Train Acc: 0.9928 | Val Loss: 0.0971, Val Acc: 0.9728
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val loss = 0.0867

[OPTUNA] Trial #1 done. Fold Losses: [0.08824639243097668, 0.10072784901318041, 0.09098253917805518, 0.10912231548562497, 0.0867012546197137]. Avg Loss=0.0952

[OPTUNA] Starting Trial #2 with lr=0.000025, weight_decay=0.004624
[OPTUNA] Trial #2: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=2.4639744842601905e-05, weight_decay=0.004623953922729007
[INFO] >>> Starting fold 1 training (Trial #2) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.4443, Train Acc: 0.8582 | Val Loss: 0.1330, Val Acc: 0.9572
[Fold 1 Epoch 2/10] Train Loss: 0.0977, Train Acc: 0.9711 | Val Loss: 0.0956, Val Acc: 0.9696
[Fold 1 Epoch 3/10] Train Loss: 0.0387, Train Acc: 0.9905 | Val Loss: 0.0983, Val Acc: 0.9685
[Fold 1 Epoch 4/10] Train Loss: 0.0171, Train Acc: 0.9971 | Val Loss: 0.1140, Val Acc: 0.9645
[INFO] Early stopping on fold 1 at epoch 4
[INFO] <<< Finished fold 1, best val loss = 0.0956

[OPTUNA] Trial #2: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=2.4639744842601905e-05, weight_decay=0.004623953922729007
[INFO] >>> Starting fold 2 training (Trial #2) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.4350, Train Acc: 0.8627 | Val Loss: 0.1448, Val Acc: 0.9512
[Fold 2 Epoch 2/10] Train Loss: 0.1050, Train Acc: 0.9673 | Val Loss: 0.0941, Val Acc: 0.9662
[Fold 2 Epoch 3/10] Train Loss: 0.0389, Train Acc: 0.9900 | Val Loss: 0.0984, Val Acc: 0.9645
[Fold 2 Epoch 4/10] Train Loss: 0.0214, Train Acc: 0.9954 | Val Loss: 0.1099, Val Acc: 0.9645
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val loss = 0.0941

[OPTUNA] Trial #2: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=2.4639744842601905e-05, weight_decay=0.004623953922729007
[INFO] >>> Starting fold 3 training (Trial #2) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.4587, Train Acc: 0.8538 | Val Loss: 0.1608, Val Acc: 0.9501
[Fold 3 Epoch 2/10] Train Loss: 0.1048, Train Acc: 0.9689 | Val Loss: 0.1020, Val Acc: 0.9665
[Fold 3 Epoch 3/10] Train Loss: 0.0421, Train Acc: 0.9886 | Val Loss: 0.0890, Val Acc: 0.9682
[Fold 3 Epoch 4/10] Train Loss: 0.0206, Train Acc: 0.9958 | Val Loss: 0.1111, Val Acc: 0.9628
[Fold 3 Epoch 5/10] Train Loss: 0.0166, Train Acc: 0.9962 | Val Loss: 0.0988, Val Acc: 0.9705
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val loss = 0.0890

[OPTUNA] Trial #2: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=2.4639744842601905e-05, weight_decay=0.004623953922729007
[INFO] >>> Starting fold 4 training (Trial #2) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.4402, Train Acc: 0.8591 | Val Loss: 0.1604, Val Acc: 0.9487
[Fold 4 Epoch 2/10] Train Loss: 0.0988, Train Acc: 0.9706 | Val Loss: 0.1086, Val Acc: 0.9634
[Fold 4 Epoch 3/10] Train Loss: 0.0347, Train Acc: 0.9916 | Val Loss: 0.1252, Val Acc: 0.9597
[Fold 4 Epoch 4/10] Train Loss: 0.0242, Train Acc: 0.9943 | Val Loss: 0.1486, Val Acc: 0.9620
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val loss = 0.1086

[OPTUNA] Trial #2: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=2.4639744842601905e-05, weight_decay=0.004623953922729007
[INFO] >>> Starting fold 5 training (Trial #2) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.4409, Train Acc: 0.8614 | Val Loss: 0.1418, Val Acc: 0.9557
[Fold 5 Epoch 2/10] Train Loss: 0.0961, Train Acc: 0.9704 | Val Loss: 0.1090, Val Acc: 0.9637
[Fold 5 Epoch 3/10] Train Loss: 0.0367, Train Acc: 0.9901 | Val Loss: 0.0935, Val Acc: 0.9677
[Fold 5 Epoch 4/10] Train Loss: 0.0162, Train Acc: 0.9969 | Val Loss: 0.0975, Val Acc: 0.9699
[Fold 5 Epoch 5/10] Train Loss: 0.0165, Train Acc: 0.9964 | Val Loss: 0.1075, Val Acc: 0.9682
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val loss = 0.0935

[OPTUNA] Trial #2 done. Fold Losses: [0.09556053967181859, 0.09411261769543801, 0.08899633403884114, 0.1085707277691524, 0.09349061429384165]. Avg Loss=0.0961

[OPTUNA] Starting Trial #3 with lr=0.000709, weight_decay=0.000004
[OPTUNA] Trial #3: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0007093973768065797, weight_decay=4.210818933485844e-06
[INFO] >>> Starting fold 1 training (Trial #3) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3397, Train Acc: 0.8803 | Val Loss: 0.2828, Val Acc: 0.8942
[Fold 1 Epoch 2/10] Train Loss: 0.1849, Train Acc: 0.9363 | Val Loss: 0.2583, Val Acc: 0.9294
[Fold 1 Epoch 3/10] Train Loss: 0.1243, Train Acc: 0.9582 | Val Loss: 0.2773, Val Acc: 0.9121
[Fold 1 Epoch 4/10] Train Loss: 0.1184, Train Acc: 0.9594 | Val Loss: 0.1626, Val Acc: 0.9498
[Fold 1 Epoch 5/10] Train Loss: 0.0963, Train Acc: 0.9664 | Val Loss: 0.1945, Val Acc: 0.9475
[Fold 1 Epoch 6/10] Train Loss: 0.0700, Train Acc: 0.9766 | Val Loss: 0.1461, Val Acc: 0.9523
[Fold 1 Epoch 7/10] Train Loss: 0.0678, Train Acc: 0.9767 | Val Loss: 0.1162, Val Acc: 0.9634
[Fold 1 Epoch 8/10] Train Loss: 0.0558, Train Acc: 0.9815 | Val Loss: 0.1434, Val Acc: 0.9594
[Fold 1 Epoch 9/10] Train Loss: 0.0507, Train Acc: 0.9833 | Val Loss: 0.1820, Val Acc: 0.9492
[INFO] Early stopping on fold 1 at epoch 9
[INFO] <<< Finished fold 1, best val loss = 0.1162

[OPTUNA] Trial #3: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0007093973768065797, weight_decay=4.210818933485844e-06
[INFO] >>> Starting fold 2 training (Trial #3) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3661, Train Acc: 0.8693 | Val Loss: 0.3009, Val Acc: 0.8959
[Fold 2 Epoch 2/10] Train Loss: 0.1895, Train Acc: 0.9334 | Val Loss: 0.2612, Val Acc: 0.9305
[Fold 2 Epoch 3/10] Train Loss: 0.1421, Train Acc: 0.9524 | Val Loss: 0.2940, Val Acc: 0.9200
[Fold 2 Epoch 4/10] Train Loss: 0.1145, Train Acc: 0.9611 | Val Loss: 0.2161, Val Acc: 0.9274
[Fold 2 Epoch 5/10] Train Loss: 0.0966, Train Acc: 0.9662 | Val Loss: 0.1486, Val Acc: 0.9549
[Fold 2 Epoch 6/10] Train Loss: 0.0795, Train Acc: 0.9738 | Val Loss: 0.1236, Val Acc: 0.9574
[Fold 2 Epoch 7/10] Train Loss: 0.0642, Train Acc: 0.9784 | Val Loss: 0.1417, Val Acc: 0.9577
[Fold 2 Epoch 8/10] Train Loss: 0.0661, Train Acc: 0.9770 | Val Loss: 0.1517, Val Acc: 0.9549
[INFO] Early stopping on fold 2 at epoch 8
[INFO] <<< Finished fold 2, best val loss = 0.1236

[OPTUNA] Trial #3: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0007093973768065797, weight_decay=4.210818933485844e-06
[INFO] >>> Starting fold 3 training (Trial #3) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3432, Train Acc: 0.8797 | Val Loss: 0.4707, Val Acc: 0.8522
[Fold 3 Epoch 2/10] Train Loss: 0.1777, Train Acc: 0.9389 | Val Loss: 0.7722, Val Acc: 0.7626
[Fold 3 Epoch 3/10] Train Loss: 0.1288, Train Acc: 0.9569 | Val Loss: 0.2501, Val Acc: 0.9271
[Fold 3 Epoch 4/10] Train Loss: 0.1118, Train Acc: 0.9648 | Val Loss: 0.1740, Val Acc: 0.9427
[Fold 3 Epoch 5/10] Train Loss: 0.0968, Train Acc: 0.9679 | Val Loss: 0.1422, Val Acc: 0.9526
[Fold 3 Epoch 6/10] Train Loss: 0.0695, Train Acc: 0.9774 | Val Loss: 0.1049, Val Acc: 0.9643
[Fold 3 Epoch 7/10] Train Loss: 0.0633, Train Acc: 0.9772 | Val Loss: 0.2068, Val Acc: 0.9353
[Fold 3 Epoch 8/10] Train Loss: 0.0663, Train Acc: 0.9784 | Val Loss: 0.1639, Val Acc: 0.9489
[INFO] Early stopping on fold 3 at epoch 8
[INFO] <<< Finished fold 3, best val loss = 0.1049

[OPTUNA] Trial #3: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0007093973768065797, weight_decay=4.210818933485844e-06
[INFO] >>> Starting fold 4 training (Trial #3) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3401, Train Acc: 0.8823 | Val Loss: 0.3131, Val Acc: 0.9030
[Fold 4 Epoch 2/10] Train Loss: 0.1767, Train Acc: 0.9401 | Val Loss: 0.2024, Val Acc: 0.9345
[Fold 4 Epoch 3/10] Train Loss: 0.1273, Train Acc: 0.9571 | Val Loss: 0.1818, Val Acc: 0.9407
[Fold 4 Epoch 4/10] Train Loss: 0.1073, Train Acc: 0.9627 | Val Loss: 0.1377, Val Acc: 0.9538
[Fold 4 Epoch 5/10] Train Loss: 0.0910, Train Acc: 0.9694 | Val Loss: 0.1206, Val Acc: 0.9640
[Fold 4 Epoch 6/10] Train Loss: 0.0648, Train Acc: 0.9777 | Val Loss: 0.1616, Val Acc: 0.9458
[Fold 4 Epoch 7/10] Train Loss: 0.0709, Train Acc: 0.9751 | Val Loss: 0.1880, Val Acc: 0.9501
[INFO] Early stopping on fold 4 at epoch 7
[INFO] <<< Finished fold 4, best val loss = 0.1206

[OPTUNA] Trial #3: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0007093973768065797, weight_decay=4.210818933485844e-06
[INFO] >>> Starting fold 5 training (Trial #3) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3470, Train Acc: 0.8761 | Val Loss: 0.1811, Val Acc: 0.9484
[Fold 5 Epoch 2/10] Train Loss: 0.1911, Train Acc: 0.9355 | Val Loss: 0.3234, Val Acc: 0.8973
[Fold 5 Epoch 3/10] Train Loss: 0.1444, Train Acc: 0.9502 | Val Loss: 0.1373, Val Acc: 0.9557
[Fold 5 Epoch 4/10] Train Loss: 0.1088, Train Acc: 0.9623 | Val Loss: 0.2091, Val Acc: 0.9359
[Fold 5 Epoch 5/10] Train Loss: 0.0896, Train Acc: 0.9690 | Val Loss: 0.1410, Val Acc: 0.9549
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val loss = 0.1373

[OPTUNA] Trial #3 done. Fold Losses: [0.11618522543546003, 0.12364850613698357, 0.10494614623270795, 0.12064854350204055, 0.13725654411869723]. Avg Loss=0.1205

[OPTUNA] Starting Trial #4 with lr=0.000064, weight_decay=0.000005
[OPTUNA] Trial #4: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=6.373277937233127e-05, weight_decay=5.042095104477667e-06
[INFO] >>> Starting fold 1 training (Trial #4) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2937, Train Acc: 0.9018 | Val Loss: 0.1610, Val Acc: 0.9526
[Fold 1 Epoch 2/10] Train Loss: 0.0728, Train Acc: 0.9766 | Val Loss: 0.1114, Val Acc: 0.9679
[Fold 1 Epoch 3/10] Train Loss: 0.0387, Train Acc: 0.9877 | Val Loss: 0.1042, Val Acc: 0.9677
[Fold 1 Epoch 4/10] Train Loss: 0.0212, Train Acc: 0.9938 | Val Loss: 0.0921, Val Acc: 0.9750
[Fold 1 Epoch 5/10] Train Loss: 0.0201, Train Acc: 0.9938 | Val Loss: 0.1074, Val Acc: 0.9725
[Fold 1 Epoch 6/10] Train Loss: 0.0140, Train Acc: 0.9964 | Val Loss: 0.0741, Val Acc: 0.9759
[Fold 1 Epoch 7/10] Train Loss: 0.0175, Train Acc: 0.9958 | Val Loss: 0.1058, Val Acc: 0.9745
[Fold 1 Epoch 8/10] Train Loss: 0.0113, Train Acc: 0.9965 | Val Loss: 0.1648, Val Acc: 0.9594
[INFO] Early stopping on fold 1 at epoch 8
[INFO] <<< Finished fold 1, best val loss = 0.0741

[OPTUNA] Trial #4: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=6.373277937233127e-05, weight_decay=5.042095104477667e-06
[INFO] >>> Starting fold 2 training (Trial #4) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3001, Train Acc: 0.9002 | Val Loss: 0.1272, Val Acc: 0.9574
[Fold 2 Epoch 2/10] Train Loss: 0.0805, Train Acc: 0.9730 | Val Loss: 0.0983, Val Acc: 0.9665
[Fold 2 Epoch 3/10] Train Loss: 0.0450, Train Acc: 0.9862 | Val Loss: 0.1035, Val Acc: 0.9637
[Fold 2 Epoch 4/10] Train Loss: 0.0210, Train Acc: 0.9942 | Val Loss: 0.0857, Val Acc: 0.9722
[Fold 2 Epoch 5/10] Train Loss: 0.0188, Train Acc: 0.9939 | Val Loss: 0.0966, Val Acc: 0.9722
[Fold 2 Epoch 6/10] Train Loss: 0.0139, Train Acc: 0.9957 | Val Loss: 0.0969, Val Acc: 0.9711
[INFO] Early stopping on fold 2 at epoch 6
[INFO] <<< Finished fold 2, best val loss = 0.0857

[OPTUNA] Trial #4: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=6.373277937233127e-05, weight_decay=5.042095104477667e-06
[INFO] >>> Starting fold 3 training (Trial #4) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3012, Train Acc: 0.8996 | Val Loss: 0.1081, Val Acc: 0.9679
[Fold 3 Epoch 2/10] Train Loss: 0.0776, Train Acc: 0.9764 | Val Loss: 0.0917, Val Acc: 0.9699
[Fold 3 Epoch 3/10] Train Loss: 0.0421, Train Acc: 0.9870 | Val Loss: 0.0969, Val Acc: 0.9685
[Fold 3 Epoch 4/10] Train Loss: 0.0220, Train Acc: 0.9930 | Val Loss: 0.1148, Val Acc: 0.9634
[INFO] Early stopping on fold 3 at epoch 4
[INFO] <<< Finished fold 3, best val loss = 0.0917

[OPTUNA] Trial #4: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=6.373277937233127e-05, weight_decay=5.042095104477667e-06
[INFO] >>> Starting fold 4 training (Trial #4) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2757, Train Acc: 0.9073 | Val Loss: 0.1214, Val Acc: 0.9600
[Fold 4 Epoch 2/10] Train Loss: 0.0691, Train Acc: 0.9779 | Val Loss: 0.1115, Val Acc: 0.9654
[Fold 4 Epoch 3/10] Train Loss: 0.0379, Train Acc: 0.9884 | Val Loss: 0.1025, Val Acc: 0.9654
[Fold 4 Epoch 4/10] Train Loss: 0.0201, Train Acc: 0.9935 | Val Loss: 0.1096, Val Acc: 0.9702
[Fold 4 Epoch 5/10] Train Loss: 0.0173, Train Acc: 0.9948 | Val Loss: 0.1392, Val Acc: 0.9665
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val loss = 0.1025

[OPTUNA] Trial #4: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=6.373277937233127e-05, weight_decay=5.042095104477667e-06
[INFO] >>> Starting fold 5 training (Trial #4) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3053, Train Acc: 0.8982 | Val Loss: 0.1166, Val Acc: 0.9614
[Fold 5 Epoch 2/10] Train Loss: 0.0708, Train Acc: 0.9763 | Val Loss: 0.0911, Val Acc: 0.9691
[Fold 5 Epoch 3/10] Train Loss: 0.0393, Train Acc: 0.9872 | Val Loss: 0.1051, Val Acc: 0.9654
[Fold 5 Epoch 4/10] Train Loss: 0.0291, Train Acc: 0.9911 | Val Loss: 0.0925, Val Acc: 0.9702
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val loss = 0.0911

[OPTUNA] Trial #4 done. Fold Losses: [0.07413766349418438, 0.08574571825998387, 0.09165014237493908, 0.10245130185597061, 0.09111330048524126]. Avg Loss=0.0890

[OPTUNA] Starting Trial #5 with lr=0.000098, weight_decay=0.005439
[OPTUNA] Trial #5: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=9.755759247517297e-05, weight_decay=0.005439485689845034
[INFO] >>> Starting fold 1 training (Trial #5) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.2697, Train Acc: 0.9093 | Val Loss: 0.1594, Val Acc: 0.9424
[Fold 1 Epoch 2/10] Train Loss: 0.1053, Train Acc: 0.9645 | Val Loss: 0.2094, Val Acc: 0.9421
[Fold 1 Epoch 3/10] Train Loss: 0.0858, Train Acc: 0.9707 | Val Loss: 0.1612, Val Acc: 0.9560
[INFO] Early stopping on fold 1 at epoch 3
[INFO] <<< Finished fold 1, best val loss = 0.1594

[OPTUNA] Trial #5: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=9.755759247517297e-05, weight_decay=0.005439485689845034
[INFO] >>> Starting fold 2 training (Trial #5) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.2727, Train Acc: 0.9089 | Val Loss: 0.1187, Val Acc: 0.9660
[Fold 2 Epoch 2/10] Train Loss: 0.1093, Train Acc: 0.9648 | Val Loss: 0.1127, Val Acc: 0.9637
[Fold 2 Epoch 3/10] Train Loss: 0.0792, Train Acc: 0.9740 | Val Loss: 0.1170, Val Acc: 0.9606
[Fold 2 Epoch 4/10] Train Loss: 0.0816, Train Acc: 0.9732 | Val Loss: 0.1647, Val Acc: 0.9455
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val loss = 0.1127

[OPTUNA] Trial #5: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=9.755759247517297e-05, weight_decay=0.005439485689845034
[INFO] >>> Starting fold 3 training (Trial #5) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.2647, Train Acc: 0.9122 | Val Loss: 0.1523, Val Acc: 0.9512
[Fold 3 Epoch 2/10] Train Loss: 0.1133, Train Acc: 0.9623 | Val Loss: 0.1328, Val Acc: 0.9594
[Fold 3 Epoch 3/10] Train Loss: 0.0904, Train Acc: 0.9715 | Val Loss: 0.1041, Val Acc: 0.9657
[Fold 3 Epoch 4/10] Train Loss: 0.0808, Train Acc: 0.9750 | Val Loss: 0.1130, Val Acc: 0.9654
[Fold 3 Epoch 5/10] Train Loss: 0.0714, Train Acc: 0.9772 | Val Loss: 0.1428, Val Acc: 0.9555
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val loss = 0.1041

[OPTUNA] Trial #5: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=9.755759247517297e-05, weight_decay=0.005439485689845034
[INFO] >>> Starting fold 4 training (Trial #5) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.2722, Train Acc: 0.9079 | Val Loss: 0.1795, Val Acc: 0.9407
[Fold 4 Epoch 2/10] Train Loss: 0.1052, Train Acc: 0.9670 | Val Loss: 0.1039, Val Acc: 0.9662
[Fold 4 Epoch 3/10] Train Loss: 0.0819, Train Acc: 0.9738 | Val Loss: 0.1514, Val Acc: 0.9495
[Fold 4 Epoch 4/10] Train Loss: 0.0773, Train Acc: 0.9764 | Val Loss: 0.1438, Val Acc: 0.9495
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val loss = 0.1039

[OPTUNA] Trial #5: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=9.755759247517297e-05, weight_decay=0.005439485689845034
[INFO] >>> Starting fold 5 training (Trial #5) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.2768, Train Acc: 0.9074 | Val Loss: 0.1304, Val Acc: 0.9569
[Fold 5 Epoch 2/10] Train Loss: 0.1121, Train Acc: 0.9634 | Val Loss: 0.1145, Val Acc: 0.9626
[Fold 5 Epoch 3/10] Train Loss: 0.0865, Train Acc: 0.9709 | Val Loss: 0.1394, Val Acc: 0.9572
[Fold 5 Epoch 4/10] Train Loss: 0.0862, Train Acc: 0.9723 | Val Loss: 0.1636, Val Acc: 0.9529
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val loss = 0.1145

[OPTUNA] Trial #5 done. Fold Losses: [0.15943460186826997, 0.11267550357713065, 0.10409670261391771, 0.10394454221542608, 0.11452429981935504]. Avg Loss=0.1189

[OPTUNA] Starting Trial #6 with lr=0.000507, weight_decay=0.000006
[OPTUNA] Trial #6: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0005068129548828729, weight_decay=6.391680810879318e-06
[INFO] >>> Starting fold 1 training (Trial #6) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3318, Train Acc: 0.8842 | Val Loss: 0.2068, Val Acc: 0.9345
[Fold 1 Epoch 2/10] Train Loss: 0.1678, Train Acc: 0.9431 | Val Loss: 0.1399, Val Acc: 0.9526
[Fold 1 Epoch 3/10] Train Loss: 0.1191, Train Acc: 0.9616 | Val Loss: 0.2300, Val Acc: 0.9223
[Fold 1 Epoch 4/10] Train Loss: 0.1005, Train Acc: 0.9671 | Val Loss: 0.1593, Val Acc: 0.9478
[INFO] Early stopping on fold 1 at epoch 4
[INFO] <<< Finished fold 1, best val loss = 0.1399

[OPTUNA] Trial #6: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0005068129548828729, weight_decay=6.391680810879318e-06
[INFO] >>> Starting fold 2 training (Trial #6) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3054, Train Acc: 0.8959 | Val Loss: 0.1965, Val Acc: 0.9348
[Fold 2 Epoch 2/10] Train Loss: 0.1495, Train Acc: 0.9494 | Val Loss: 0.1673, Val Acc: 0.9447
[Fold 2 Epoch 3/10] Train Loss: 0.1137, Train Acc: 0.9624 | Val Loss: 0.1290, Val Acc: 0.9603
[Fold 2 Epoch 4/10] Train Loss: 0.1007, Train Acc: 0.9653 | Val Loss: 0.1330, Val Acc: 0.9600
[Fold 2 Epoch 5/10] Train Loss: 0.0660, Train Acc: 0.9789 | Val Loss: 0.1179, Val Acc: 0.9574
[Fold 2 Epoch 6/10] Train Loss: 0.0629, Train Acc: 0.9787 | Val Loss: 0.1345, Val Acc: 0.9572
[Fold 2 Epoch 7/10] Train Loss: 0.0536, Train Acc: 0.9808 | Val Loss: 0.1297, Val Acc: 0.9628
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val loss = 0.1179

[OPTUNA] Trial #6: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0005068129548828729, weight_decay=6.391680810879318e-06
[INFO] >>> Starting fold 3 training (Trial #6) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3045, Train Acc: 0.8966 | Val Loss: 0.4671, Val Acc: 0.8857
[Fold 3 Epoch 2/10] Train Loss: 0.1747, Train Acc: 0.9416 | Val Loss: 0.1729, Val Acc: 0.9350
[Fold 3 Epoch 3/10] Train Loss: 0.1059, Train Acc: 0.9655 | Val Loss: 0.1050, Val Acc: 0.9654
[Fold 3 Epoch 4/10] Train Loss: 0.0983, Train Acc: 0.9676 | Val Loss: 0.1468, Val Acc: 0.9529
[Fold 3 Epoch 5/10] Train Loss: 0.0774, Train Acc: 0.9735 | Val Loss: 0.1449, Val Acc: 0.9540
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val loss = 0.1050

[OPTUNA] Trial #6: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0005068129548828729, weight_decay=6.391680810879318e-06
[INFO] >>> Starting fold 4 training (Trial #6) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3276, Train Acc: 0.8891 | Val Loss: 0.2706, Val Acc: 0.9140
[Fold 4 Epoch 2/10] Train Loss: 0.1700, Train Acc: 0.9430 | Val Loss: 0.1691, Val Acc: 0.9478
[Fold 4 Epoch 3/10] Train Loss: 0.1183, Train Acc: 0.9600 | Val Loss: 0.2154, Val Acc: 0.9365
[Fold 4 Epoch 4/10] Train Loss: 0.0939, Train Acc: 0.9672 | Val Loss: 0.1533, Val Acc: 0.9484
[Fold 4 Epoch 5/10] Train Loss: 0.0819, Train Acc: 0.9719 | Val Loss: 0.1460, Val Acc: 0.9572
[Fold 4 Epoch 6/10] Train Loss: 0.0634, Train Acc: 0.9793 | Val Loss: 0.1183, Val Acc: 0.9620
[Fold 4 Epoch 7/10] Train Loss: 0.0518, Train Acc: 0.9824 | Val Loss: 0.1305, Val Acc: 0.9611
[Fold 4 Epoch 8/10] Train Loss: 0.0531, Train Acc: 0.9830 | Val Loss: 0.1537, Val Acc: 0.9560
[INFO] Early stopping on fold 4 at epoch 8
[INFO] <<< Finished fold 4, best val loss = 0.1183

[OPTUNA] Trial #6: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0005068129548828729, weight_decay=6.391680810879318e-06
[INFO] >>> Starting fold 5 training (Trial #6) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3033, Train Acc: 0.8950 | Val Loss: 0.1787, Val Acc: 0.9472
[Fold 5 Epoch 2/10] Train Loss: 0.1485, Train Acc: 0.9480 | Val Loss: 0.1233, Val Acc: 0.9586
[Fold 5 Epoch 3/10] Train Loss: 0.1104, Train Acc: 0.9638 | Val Loss: 0.1235, Val Acc: 0.9589
[Fold 5 Epoch 4/10] Train Loss: 0.0824, Train Acc: 0.9716 | Val Loss: 0.1107, Val Acc: 0.9614
[Fold 5 Epoch 5/10] Train Loss: 0.0834, Train Acc: 0.9714 | Val Loss: 0.1332, Val Acc: 0.9603
[Fold 5 Epoch 6/10] Train Loss: 0.0584, Train Acc: 0.9796 | Val Loss: 0.1009, Val Acc: 0.9711
[Fold 5 Epoch 7/10] Train Loss: 0.0559, Train Acc: 0.9813 | Val Loss: 0.1898, Val Acc: 0.9455
[Fold 5 Epoch 8/10] Train Loss: 0.0413, Train Acc: 0.9865 | Val Loss: 0.1306, Val Acc: 0.9645
[INFO] Early stopping on fold 5 at epoch 8
[INFO] <<< Finished fold 5, best val loss = 0.1009

[OPTUNA] Trial #6 done. Fold Losses: [0.13993149489371198, 0.11790700771405735, 0.10496709783692333, 0.11826935801389027, 0.10094553422136901]. Avg Loss=0.1164

[OPTUNA] Starting Trial #7 with lr=0.000673, weight_decay=0.000042
[OPTUNA] Trial #7: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0006733008099194942, weight_decay=4.160812732268216e-05
[INFO] >>> Starting fold 1 training (Trial #7) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3358, Train Acc: 0.8816 | Val Loss: 0.3380, Val Acc: 0.8828
[Fold 1 Epoch 2/10] Train Loss: 0.1770, Train Acc: 0.9394 | Val Loss: 0.3079, Val Acc: 0.9206
[Fold 1 Epoch 3/10] Train Loss: 0.1483, Train Acc: 0.9505 | Val Loss: 0.2025, Val Acc: 0.9416
[Fold 1 Epoch 4/10] Train Loss: 0.0997, Train Acc: 0.9644 | Val Loss: 0.1301, Val Acc: 0.9577
[Fold 1 Epoch 5/10] Train Loss: 0.0944, Train Acc: 0.9684 | Val Loss: 0.3165, Val Acc: 0.8987
[Fold 1 Epoch 6/10] Train Loss: 0.1067, Train Acc: 0.9646 | Val Loss: 0.2207, Val Acc: 0.9342
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val loss = 0.1301

[OPTUNA] Trial #7: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0006733008099194942, weight_decay=4.160812732268216e-05
[INFO] >>> Starting fold 2 training (Trial #7) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3112, Train Acc: 0.8904 | Val Loss: 0.2094, Val Acc: 0.9277
[Fold 2 Epoch 2/10] Train Loss: 0.1606, Train Acc: 0.9451 | Val Loss: 0.1142, Val Acc: 0.9560
[Fold 2 Epoch 3/10] Train Loss: 0.1255, Train Acc: 0.9557 | Val Loss: 0.1212, Val Acc: 0.9574
[Fold 2 Epoch 4/10] Train Loss: 0.1052, Train Acc: 0.9653 | Val Loss: 0.1506, Val Acc: 0.9523
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val loss = 0.1142

[OPTUNA] Trial #7: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0006733008099194942, weight_decay=4.160812732268216e-05
[INFO] >>> Starting fold 3 training (Trial #7) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3563, Train Acc: 0.8741 | Val Loss: 0.2377, Val Acc: 0.9123
[Fold 3 Epoch 2/10] Train Loss: 0.1865, Train Acc: 0.9373 | Val Loss: 0.3494, Val Acc: 0.8905
[Fold 3 Epoch 3/10] Train Loss: 0.1471, Train Acc: 0.9523 | Val Loss: 0.1451, Val Acc: 0.9498
[Fold 3 Epoch 4/10] Train Loss: 0.1170, Train Acc: 0.9615 | Val Loss: 0.1180, Val Acc: 0.9597
[Fold 3 Epoch 5/10] Train Loss: 0.0984, Train Acc: 0.9662 | Val Loss: 0.1727, Val Acc: 0.9379
[Fold 3 Epoch 6/10] Train Loss: 0.0878, Train Acc: 0.9708 | Val Loss: 0.2571, Val Acc: 0.9279
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val loss = 0.1180

[OPTUNA] Trial #7: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0006733008099194942, weight_decay=4.160812732268216e-05
[INFO] >>> Starting fold 4 training (Trial #7) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3256, Train Acc: 0.8842 | Val Loss: 0.2082, Val Acc: 0.9316
[Fold 4 Epoch 2/10] Train Loss: 0.1681, Train Acc: 0.9433 | Val Loss: 0.2050, Val Acc: 0.9336
[Fold 4 Epoch 3/10] Train Loss: 0.1384, Train Acc: 0.9540 | Val Loss: 0.1905, Val Acc: 0.9359
[Fold 4 Epoch 4/10] Train Loss: 0.1112, Train Acc: 0.9636 | Val Loss: 0.1599, Val Acc: 0.9498
[Fold 4 Epoch 5/10] Train Loss: 0.0912, Train Acc: 0.9687 | Val Loss: 0.1510, Val Acc: 0.9509
[Fold 4 Epoch 6/10] Train Loss: 0.0892, Train Acc: 0.9726 | Val Loss: 0.1319, Val Acc: 0.9538
[Fold 4 Epoch 7/10] Train Loss: 0.0671, Train Acc: 0.9774 | Val Loss: 0.1922, Val Acc: 0.9330
[Fold 4 Epoch 8/10] Train Loss: 0.0801, Train Acc: 0.9740 | Val Loss: 0.1466, Val Acc: 0.9515
[INFO] Early stopping on fold 4 at epoch 8
[INFO] <<< Finished fold 4, best val loss = 0.1319

[OPTUNA] Trial #7: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0006733008099194942, weight_decay=4.160812732268216e-05
[INFO] >>> Starting fold 5 training (Trial #7) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3477, Train Acc: 0.8785 | Val Loss: 0.1904, Val Acc: 0.9342
[Fold 5 Epoch 2/10] Train Loss: 0.1775, Train Acc: 0.9393 | Val Loss: 0.1573, Val Acc: 0.9435
[Fold 5 Epoch 3/10] Train Loss: 0.1379, Train Acc: 0.9525 | Val Loss: 0.1127, Val Acc: 0.9600
[Fold 5 Epoch 4/10] Train Loss: 0.1223, Train Acc: 0.9571 | Val Loss: 0.1564, Val Acc: 0.9532
[Fold 5 Epoch 5/10] Train Loss: 0.0867, Train Acc: 0.9709 | Val Loss: 0.1668, Val Acc: 0.9458
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val loss = 0.1127

[OPTUNA] Trial #7 done. Fold Losses: [0.13014981454106028, 0.11418956163548241, 0.11804383893624097, 0.1319341038930101, 0.1126750170903311]. Avg Loss=0.1214

[OPTUNA] Starting Trial #8 with lr=0.000796, weight_decay=0.005006
[OPTUNA] Trial #8: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.000796075812295963, weight_decay=0.005005917310567221
[INFO] >>> Starting fold 1 training (Trial #8) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.4293, Train Acc: 0.8496 | Val Loss: 1.0220, Val Acc: 0.6457
[Fold 1 Epoch 2/10] Train Loss: 0.3553, Train Acc: 0.8762 | Val Loss: 2.5784, Val Acc: 0.6079
[Fold 1 Epoch 3/10] Train Loss: 0.3176, Train Acc: 0.8894 | Val Loss: 0.4702, Val Acc: 0.8757
[Fold 1 Epoch 4/10] Train Loss: 0.2821, Train Acc: 0.9076 | Val Loss: 0.8583, Val Acc: 0.7183
[Fold 1 Epoch 5/10] Train Loss: 0.2724, Train Acc: 0.9089 | Val Loss: 0.6721, Val Acc: 0.8443
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val loss = 0.4702

[OPTUNA] Trial #8: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.000796075812295963, weight_decay=0.005005917310567221
[INFO] >>> Starting fold 2 training (Trial #8) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.4673, Train Acc: 0.8345 | Val Loss: 37.3204, Val Acc: 0.2420
[Fold 2 Epoch 2/10] Train Loss: 0.3695, Train Acc: 0.8677 | Val Loss: 3.3297, Val Acc: 0.4542
[Fold 2 Epoch 3/10] Train Loss: 0.3282, Train Acc: 0.8852 | Val Loss: 0.6111, Val Acc: 0.8292
[Fold 2 Epoch 4/10] Train Loss: 0.3098, Train Acc: 0.8931 | Val Loss: 0.4729, Val Acc: 0.8772
[Fold 2 Epoch 5/10] Train Loss: 0.2801, Train Acc: 0.9059 | Val Loss: 0.3307, Val Acc: 0.9149
[Fold 2 Epoch 6/10] Train Loss: 0.2551, Train Acc: 0.9158 | Val Loss: 0.3943, Val Acc: 0.8701
[Fold 2 Epoch 7/10] Train Loss: 0.2539, Train Acc: 0.9138 | Val Loss: 0.4201, Val Acc: 0.8542
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val loss = 0.3307

[OPTUNA] Trial #8: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.000796075812295963, weight_decay=0.005005917310567221
[INFO] >>> Starting fold 3 training (Trial #8) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.4639, Train Acc: 0.8335 | Val Loss: 1.1859, Val Acc: 0.3898
[Fold 3 Epoch 2/10] Train Loss: 0.3707, Train Acc: 0.8691 | Val Loss: 0.9565, Val Acc: 0.4434
[Fold 3 Epoch 3/10] Train Loss: 0.3542, Train Acc: 0.8740 | Val Loss: 0.7588, Val Acc: 0.6925
[Fold 3 Epoch 4/10] Train Loss: 0.3170, Train Acc: 0.8874 | Val Loss: 0.3801, Val Acc: 0.8772
[Fold 3 Epoch 5/10] Train Loss: 0.3014, Train Acc: 0.8980 | Val Loss: 0.3031, Val Acc: 0.8902
[Fold 3 Epoch 6/10] Train Loss: 0.2883, Train Acc: 0.9029 | Val Loss: 0.4157, Val Acc: 0.8689
[Fold 3 Epoch 7/10] Train Loss: 0.2641, Train Acc: 0.9076 | Val Loss: 0.4614, Val Acc: 0.8423
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val loss = 0.3031

[OPTUNA] Trial #8: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.000796075812295963, weight_decay=0.005005917310567221
[INFO] >>> Starting fold 4 training (Trial #8) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.4323, Train Acc: 0.8499 | Val Loss: 0.9323, Val Acc: 0.6721
[Fold 4 Epoch 2/10] Train Loss: 0.3552, Train Acc: 0.8765 | Val Loss: 1.1513, Val Acc: 0.6409
[Fold 4 Epoch 3/10] Train Loss: 0.3218, Train Acc: 0.8886 | Val Loss: 0.6713, Val Acc: 0.8028
[Fold 4 Epoch 4/10] Train Loss: 0.2934, Train Acc: 0.8975 | Val Loss: 0.8646, Val Acc: 0.7600
[Fold 4 Epoch 5/10] Train Loss: 0.2771, Train Acc: 0.9043 | Val Loss: 0.2990, Val Acc: 0.8990
[Fold 4 Epoch 6/10] Train Loss: 0.2543, Train Acc: 0.9172 | Val Loss: 0.6761, Val Acc: 0.8011
[Fold 4 Epoch 7/10] Train Loss: 0.2407, Train Acc: 0.9212 | Val Loss: 0.2600, Val Acc: 0.9243
[Fold 4 Epoch 8/10] Train Loss: 0.2327, Train Acc: 0.9252 | Val Loss: 0.6560, Val Acc: 0.8184
[Fold 4 Epoch 9/10] Train Loss: 0.2153, Train Acc: 0.9326 | Val Loss: 0.2646, Val Acc: 0.9228
[INFO] Early stopping on fold 4 at epoch 9
[INFO] <<< Finished fold 4, best val loss = 0.2600

[OPTUNA] Trial #8: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.000796075812295963, weight_decay=0.005005917310567221
[INFO] >>> Starting fold 5 training (Trial #8) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.4865, Train Acc: 0.8270 | Val Loss: 1.1518, Val Acc: 0.4023
[Fold 5 Epoch 2/10] Train Loss: 0.3808, Train Acc: 0.8660 | Val Loss: 0.5194, Val Acc: 0.8162
[Fold 5 Epoch 3/10] Train Loss: 0.3424, Train Acc: 0.8787 | Val Loss: 0.7706, Val Acc: 0.7660
[Fold 5 Epoch 4/10] Train Loss: 0.3087, Train Acc: 0.8885 | Val Loss: 0.6919, Val Acc: 0.7143
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val loss = 0.5194

[OPTUNA] Trial #8 done. Fold Losses: [0.47020564447822316, 0.3306599576026201, 0.30311158819157363, 0.26004068770479144, 0.5193945790774056]. Avg Loss=0.3767

[OPTUNA] Starting Trial #9 with lr=0.000042, weight_decay=0.000031
[OPTUNA] Trial #9: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=4.236554984057559e-05, weight_decay=3.104719420568497e-05
[INFO] >>> Starting fold 1 training (Trial #9) for 10 epochs...
[Fold 1 Epoch 1/10] Train Loss: 0.3225, Train Acc: 0.8961 | Val Loss: 0.1160, Val Acc: 0.9623
[Fold 1 Epoch 2/10] Train Loss: 0.0648, Train Acc: 0.9804 | Val Loss: 0.1021, Val Acc: 0.9657
[Fold 1 Epoch 3/10] Train Loss: 0.0315, Train Acc: 0.9909 | Val Loss: 0.1467, Val Acc: 0.9574
[Fold 1 Epoch 4/10] Train Loss: 0.0205, Train Acc: 0.9944 | Val Loss: 0.1063, Val Acc: 0.9631
[INFO] Early stopping on fold 1 at epoch 4
[INFO] <<< Finished fold 1, best val loss = 0.1021

[OPTUNA] Trial #9: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=4.236554984057559e-05, weight_decay=3.104719420568497e-05
[INFO] >>> Starting fold 2 training (Trial #9) for 10 epochs...
[Fold 2 Epoch 1/10] Train Loss: 0.3486, Train Acc: 0.8833 | Val Loss: 0.1231, Val Acc: 0.9580
[Fold 2 Epoch 2/10] Train Loss: 0.0809, Train Acc: 0.9750 | Val Loss: 0.0946, Val Acc: 0.9696
[Fold 2 Epoch 3/10] Train Loss: 0.0283, Train Acc: 0.9923 | Val Loss: 0.0955, Val Acc: 0.9722
[Fold 2 Epoch 4/10] Train Loss: 0.0231, Train Acc: 0.9940 | Val Loss: 0.1263, Val Acc: 0.9623
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val loss = 0.0946

[OPTUNA] Trial #9: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=4.236554984057559e-05, weight_decay=3.104719420568497e-05
[INFO] >>> Starting fold 3 training (Trial #9) for 10 epochs...
[Fold 3 Epoch 1/10] Train Loss: 0.3468, Train Acc: 0.8872 | Val Loss: 0.1157, Val Acc: 0.9609
[Fold 3 Epoch 2/10] Train Loss: 0.0826, Train Acc: 0.9735 | Val Loss: 0.0921, Val Acc: 0.9688
[Fold 3 Epoch 3/10] Train Loss: 0.0354, Train Acc: 0.9899 | Val Loss: 0.0878, Val Acc: 0.9719
[Fold 3 Epoch 4/10] Train Loss: 0.0173, Train Acc: 0.9952 | Val Loss: 0.0885, Val Acc: 0.9742
[Fold 3 Epoch 5/10] Train Loss: 0.0117, Train Acc: 0.9970 | Val Loss: 0.1047, Val Acc: 0.9702
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val loss = 0.0878

[OPTUNA] Trial #9: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=4.236554984057559e-05, weight_decay=3.104719420568497e-05
[INFO] >>> Starting fold 4 training (Trial #9) for 10 epochs...
[Fold 4 Epoch 1/10] Train Loss: 0.3238, Train Acc: 0.8951 | Val Loss: 0.1377, Val Acc: 0.9560
[Fold 4 Epoch 2/10] Train Loss: 0.0742, Train Acc: 0.9769 | Val Loss: 0.1054, Val Acc: 0.9648
[Fold 4 Epoch 3/10] Train Loss: 0.0317, Train Acc: 0.9909 | Val Loss: 0.1012, Val Acc: 0.9685
[Fold 4 Epoch 4/10] Train Loss: 0.0186, Train Acc: 0.9948 | Val Loss: 0.0910, Val Acc: 0.9702
[Fold 4 Epoch 5/10] Train Loss: 0.0111, Train Acc: 0.9975 | Val Loss: 0.1203, Val Acc: 0.9648
[Fold 4 Epoch 6/10] Train Loss: 0.0089, Train Acc: 0.9977 | Val Loss: 0.1297, Val Acc: 0.9679
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val loss = 0.0910

[OPTUNA] Trial #9: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=4.236554984057559e-05, weight_decay=3.104719420568497e-05
[INFO] >>> Starting fold 5 training (Trial #9) for 10 epochs...
[Fold 5 Epoch 1/10] Train Loss: 0.3445, Train Acc: 0.8868 | Val Loss: 0.1473, Val Acc: 0.9535
[Fold 5 Epoch 2/10] Train Loss: 0.0737, Train Acc: 0.9762 | Val Loss: 0.1083, Val Acc: 0.9645
[Fold 5 Epoch 3/10] Train Loss: 0.0292, Train Acc: 0.9917 | Val Loss: 0.0963, Val Acc: 0.9699
[Fold 5 Epoch 4/10] Train Loss: 0.0205, Train Acc: 0.9933 | Val Loss: 0.1275, Val Acc: 0.9671
[Fold 5 Epoch 5/10] Train Loss: 0.0194, Train Acc: 0.9941 | Val Loss: 0.1077, Val Acc: 0.9662
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val loss = 0.0963

[OPTUNA] Trial #9 done. Fold Losses: [0.10208910324269839, 0.09459571027088844, 0.0878470790069384, 0.09104784782695267, 0.09625693043303077]. Avg Loss=0.0944
[OPTUNA] Best trial found:
  Trial number: 4
  Avg Loss: 0.0890
    lr: 6.373277937233127e-05
    weight_decay: 5.042095104477667e-06

[INFO] Retraining final model on entire training set using best hyperparams...
[DEBUG] Creating ResNet50 with lr=6.373277937233127e-05, weight_decay=5.042095104477667e-06
[Final Train] Epoch 1/5 - Loss: 0.2637, Acc: 0.9111
[Final Train] Epoch 2/5 - Loss: 0.0702, Acc: 0.9780
[Final Train] Epoch 3/5 - Loss: 0.0329, Acc: 0.9894
[Final Train] Epoch 4/5 - Loss: 0.0218, Acc: 0.9937
[Final Train] Epoch 5/5 - Loss: 0.0208, Acc: 0.9940

[INFO] Evaluating final model on test set...
[RESULT] Final Test Accuracy: 0.7903

[RESULT] Classification Report:
              precision    recall  f1-score   support

      Center       0.82      0.82      0.82       832
       Donut       0.67      0.61      0.64       146
    Edge-Loc       0.82      0.81      0.82      2772
   Edge-Ring       0.89      0.78      0.83      1126
         Loc       0.69      0.81      0.75      1973
   Near-full       0.87      0.97      0.92        95
      Random       0.74      0.82      0.78       257
     Scratch       0.88      0.62      0.72       693

    accuracy                           0.79      7894
   macro avg       0.80      0.78      0.78      7894
weighted avg       0.80      0.79      0.79      7894

[INFO] Final model saved to final_model.pth

[INFO] Done. You can now view logs in TensorBoard and the Optuna dashboard.
