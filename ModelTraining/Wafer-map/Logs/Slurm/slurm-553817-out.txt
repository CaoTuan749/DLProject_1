PYTHONPATH=~/tmp/miniconda3/envs/MaProject/bin/python:
[I 2025-03-06 17:43:18,249] A new study created in RDB with name: resnet_wafer_1741279393
[I 2025-03-06 18:10:38,928] Trial 0 finished with value: 0.9712340425531915 and parameters: {'lr': 0.00010766269937488438, 'weight_decay': 0.00015221182396605703}. Best is trial 0 with value: 0.9712340425531915.
[I 2025-03-06 18:34:51,652] Trial 1 finished with value: 0.9681702127659573 and parameters: {'lr': 0.00024222859094120915, 'weight_decay': 3.202164586926238e-05}. Best is trial 0 with value: 0.9712340425531915.
[I 2025-03-06 19:00:03,698] Trial 2 finished with value: 0.9687375886524823 and parameters: {'lr': 2.9998455312273175e-05, 'weight_decay': 0.004268847177005014}. Best is trial 0 with value: 0.9712340425531915.
[I 2025-03-06 19:21:17,857] Trial 3 finished with value: 0.9689078014184396 and parameters: {'lr': 0.0001263283256526553, 'weight_decay': 2.086122232332628e-05}. Best is trial 0 with value: 0.9712340425531915.
[I 2025-03-06 19:53:36,175] Trial 4 finished with value: 0.9693049645390073 and parameters: {'lr': 4.443727708443183e-05, 'weight_decay': 0.0036446929755618324}. Best is trial 0 with value: 0.9712340425531915.
[I 2025-03-06 20:17:59,222] Trial 5 finished with value: 0.9697588652482271 and parameters: {'lr': 4.5558992317154973e-05, 'weight_decay': 1.7541363993928004e-06}. Best is trial 0 with value: 0.9712340425531915.
[I 2025-03-06 20:54:07,919] Trial 6 pruned. 
[I 2025-03-06 21:25:00,053] Trial 7 pruned. 
[I 2025-03-06 21:59:01,374] Trial 8 pruned. 
[I 2025-03-06 22:28:13,001] Trial 9 finished with value: 0.972255319148936 and parameters: {'lr': 4.401180662197339e-05, 'weight_decay': 4.421966797416062e-06}. Best is trial 9 with value: 0.972255319148936.
[I 2025-03-06 22:57:11,457] Trial 10 pruned. 
[I 2025-03-06 23:27:04,130] Trial 11 finished with value: 0.9721985815602837 and parameters: {'lr': 9.916274020360132e-05, 'weight_decay': 0.00030112576995332886}. Best is trial 9 with value: 0.972255319148936.
[I 2025-03-06 23:58:18,166] Trial 12 pruned. 
[I 2025-03-07 00:23:25,689] Trial 13 pruned. 
[I 2025-03-07 00:55:26,877] Trial 14 finished with value: 0.9722553191489363 and parameters: {'lr': 7.291835574193059e-05, 'weight_decay': 4.969799360427908e-05}. Best is trial 14 with value: 0.9722553191489363.
[I 2025-03-07 01:22:34,512] Trial 15 pruned. 
[I 2025-03-07 01:57:36,634] Trial 16 pruned. 
[I 2025-03-07 02:27:37,743] Trial 17 finished with value: 0.9721985815602837 and parameters: {'lr': 5.777727880167612e-05, 'weight_decay': 5.023747049622391e-05}. Best is trial 14 with value: 0.9722553191489363.
[I 2025-03-07 02:53:42,508] Trial 18 pruned. 
[I 2025-03-07 03:25:45,185] Trial 19 pruned. 
Loaded configuration:
{'experiment': {'reproducibility': True, 'seed': 42, 'num_trials': 20, 'num_epochs': 20, 'final_epochs': 5, 'save_model': True, 'model_save_path': 'final_model.pth', 'continual_learning': True, 'continual_method': 'baseline', 'task_list': [[0, 1], [2, 3]], 'suggest': {'lr': {'low': '1e-5', 'high': '1e-3', 'log': True}, 'weight_decay': {'low': '1e-6', 'high': '1e-2', 'log': True}}}, 'model': {'type': 'resnet50', 'lr': '1e-4', 'weight_decay': '1e-4'}, 'dataset': {'path': '/home/anhcao/tmp/Dataset/Wafermap-dataset/WM811K.pkl'}}
[INFO] Using device: cuda
[INFO] Number of classes: 8
[INFO] Classes: ['Center' 'Donut' 'Edge-Loc' 'Edge-Ring' 'Loc' 'Near-full' 'Random'
 'Scratch']
[INFO] Creating Optuna study 'resnet_wafer_1741279393' with DB file: resnet_wafer_v2.db
[INFO] Starting study.optimize with 20 trials...


[OPTUNA] Starting Trial #0 with lr=0.000108, weight_decay=0.000152
[OPTUNA] Trial #0: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00010766269937488438, weight_decay=0.00015221182396605703
[INFO] >>> Starting fold 1 training (Trial #0) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2602, Train Acc: 0.9128 | Val Loss: 0.1393, Val Acc: 0.9597
[Fold 1 Epoch 2/20] Train Loss: 0.0820, Train Acc: 0.9733 | Val Loss: 0.1320, Val Acc: 0.9611
[Fold 1 Epoch 3/20] Train Loss: 0.0553, Train Acc: 0.9809 | Val Loss: 0.1079, Val Acc: 0.9682
[Fold 1 Epoch 4/20] Train Loss: 0.0416, Train Acc: 0.9860 | Val Loss: 0.0762, Val Acc: 0.9753
[Fold 1 Epoch 5/20] Train Loss: 0.0311, Train Acc: 0.9904 | Val Loss: 0.1034, Val Acc: 0.9773
[Fold 1 Epoch 6/20] Train Loss: 0.0249, Train Acc: 0.9923 | Val Loss: 0.1132, Val Acc: 0.9654
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9773

[OPTUNA] Trial #0: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00010766269937488438, weight_decay=0.00015221182396605703
[INFO] >>> Starting fold 2 training (Trial #0) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2656, Train Acc: 0.9109 | Val Loss: 0.1200, Val Acc: 0.9580
[Fold 2 Epoch 2/20] Train Loss: 0.0839, Train Acc: 0.9733 | Val Loss: 0.1151, Val Acc: 0.9594
[Fold 2 Epoch 3/20] Train Loss: 0.0485, Train Acc: 0.9846 | Val Loss: 0.0918, Val Acc: 0.9688
[Fold 2 Epoch 4/20] Train Loss: 0.0370, Train Acc: 0.9890 | Val Loss: 0.1022, Val Acc: 0.9654
[Fold 2 Epoch 5/20] Train Loss: 0.0327, Train Acc: 0.9885 | Val Loss: 0.0928, Val Acc: 0.9713
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9688

[OPTUNA] Trial #0: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00010766269937488438, weight_decay=0.00015221182396605703
[INFO] >>> Starting fold 3 training (Trial #0) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2592, Train Acc: 0.9111 | Val Loss: 0.1344, Val Acc: 0.9574
[Fold 3 Epoch 2/20] Train Loss: 0.0848, Train Acc: 0.9712 | Val Loss: 0.1247, Val Acc: 0.9628
[Fold 3 Epoch 3/20] Train Loss: 0.0524, Train Acc: 0.9826 | Val Loss: 0.0881, Val Acc: 0.9711
[Fold 3 Epoch 4/20] Train Loss: 0.0386, Train Acc: 0.9882 | Val Loss: 0.1072, Val Acc: 0.9679
[Fold 3 Epoch 5/20] Train Loss: 0.0365, Train Acc: 0.9891 | Val Loss: 0.0917, Val Acc: 0.9696
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9711

[OPTUNA] Trial #0: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00010766269937488438, weight_decay=0.00015221182396605703
[INFO] >>> Starting fold 4 training (Trial #0) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2565, Train Acc: 0.9129 | Val Loss: 0.1639, Val Acc: 0.9467
[Fold 4 Epoch 2/20] Train Loss: 0.0903, Train Acc: 0.9696 | Val Loss: 0.1478, Val Acc: 0.9481
[Fold 4 Epoch 3/20] Train Loss: 0.0495, Train Acc: 0.9832 | Val Loss: 0.1072, Val Acc: 0.9648
[Fold 4 Epoch 4/20] Train Loss: 0.0283, Train Acc: 0.9916 | Val Loss: 0.1115, Val Acc: 0.9643
[Fold 4 Epoch 5/20] Train Loss: 0.0257, Train Acc: 0.9914 | Val Loss: 0.1187, Val Acc: 0.9643
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9648

[OPTUNA] Trial #0: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00010766269937488438, weight_decay=0.00015221182396605703
[INFO] >>> Starting fold 5 training (Trial #0) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2618, Train Acc: 0.9097 | Val Loss: 0.1017, Val Acc: 0.9614
[Fold 5 Epoch 2/20] Train Loss: 0.0825, Train Acc: 0.9723 | Val Loss: 0.1465, Val Acc: 0.9674
[Fold 5 Epoch 3/20] Train Loss: 0.0500, Train Acc: 0.9845 | Val Loss: 0.0966, Val Acc: 0.9682
[Fold 5 Epoch 4/20] Train Loss: 0.0314, Train Acc: 0.9904 | Val Loss: 0.0867, Val Acc: 0.9733
[Fold 5 Epoch 5/20] Train Loss: 0.0264, Train Acc: 0.9913 | Val Loss: 0.0887, Val Acc: 0.9742
[Fold 5 Epoch 6/20] Train Loss: 0.0325, Train Acc: 0.9903 | Val Loss: 0.1014, Val Acc: 0.9651
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9742

[OPTUNA] Trial #0 done. Fold Accuracies: [0.9773049645390071, 0.9687943262411347, 0.971063829787234, 0.964822695035461, 0.9741843971631206]. Avg Acc=0.9712

[OPTUNA] Starting Trial #1 with lr=0.000242, weight_decay=0.000032
[OPTUNA] Trial #1: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00024222859094120915, weight_decay=3.202164586926238e-05
[INFO] >>> Starting fold 1 training (Trial #1) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2595, Train Acc: 0.9103 | Val Loss: 0.1604, Val Acc: 0.9401
[Fold 1 Epoch 2/20] Train Loss: 0.1160, Train Acc: 0.9612 | Val Loss: 0.0772, Val Acc: 0.9728
[Fold 1 Epoch 3/20] Train Loss: 0.0713, Train Acc: 0.9761 | Val Loss: 0.1373, Val Acc: 0.9529
[Fold 1 Epoch 4/20] Train Loss: 0.0643, Train Acc: 0.9789 | Val Loss: 0.1270, Val Acc: 0.9600
[INFO] Early stopping on fold 1 at epoch 4
[INFO] <<< Finished fold 1, best val acc = 0.9728

[OPTUNA] Trial #1: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00024222859094120915, weight_decay=3.202164586926238e-05
[INFO] >>> Starting fold 2 training (Trial #1) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2541, Train Acc: 0.9123 | Val Loss: 0.1872, Val Acc: 0.9421
[Fold 2 Epoch 2/20] Train Loss: 0.1121, Train Acc: 0.9625 | Val Loss: 0.1559, Val Acc: 0.9526
[Fold 2 Epoch 3/20] Train Loss: 0.0911, Train Acc: 0.9676 | Val Loss: 0.1783, Val Acc: 0.9458
[Fold 2 Epoch 4/20] Train Loss: 0.0614, Train Acc: 0.9800 | Val Loss: 0.1019, Val Acc: 0.9691
[Fold 2 Epoch 5/20] Train Loss: 0.0444, Train Acc: 0.9856 | Val Loss: 0.1426, Val Acc: 0.9574
[Fold 2 Epoch 6/20] Train Loss: 0.0360, Train Acc: 0.9887 | Val Loss: 0.1071, Val Acc: 0.9617
[INFO] Early stopping on fold 2 at epoch 6
[INFO] <<< Finished fold 2, best val acc = 0.9691

[OPTUNA] Trial #1: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00024222859094120915, weight_decay=3.202164586926238e-05
[INFO] >>> Starting fold 3 training (Trial #1) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2801, Train Acc: 0.9041 | Val Loss: 0.1193, Val Acc: 0.9603
[Fold 3 Epoch 2/20] Train Loss: 0.1078, Train Acc: 0.9631 | Val Loss: 0.2032, Val Acc: 0.9285
[Fold 3 Epoch 3/20] Train Loss: 0.0951, Train Acc: 0.9696 | Val Loss: 0.1467, Val Acc: 0.9560
[INFO] Early stopping on fold 3 at epoch 3
[INFO] <<< Finished fold 3, best val acc = 0.9603

[OPTUNA] Trial #1: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00024222859094120915, weight_decay=3.202164586926238e-05
[INFO] >>> Starting fold 4 training (Trial #1) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2736, Train Acc: 0.9040 | Val Loss: 0.1610, Val Acc: 0.9509
[Fold 4 Epoch 2/20] Train Loss: 0.1165, Train Acc: 0.9610 | Val Loss: 0.1350, Val Acc: 0.9538
[Fold 4 Epoch 3/20] Train Loss: 0.0731, Train Acc: 0.9760 | Val Loss: 0.1243, Val Acc: 0.9640
[Fold 4 Epoch 4/20] Train Loss: 0.0584, Train Acc: 0.9794 | Val Loss: 0.1465, Val Acc: 0.9495
[Fold 4 Epoch 5/20] Train Loss: 0.0398, Train Acc: 0.9870 | Val Loss: 0.1171, Val Acc: 0.9677
[Fold 4 Epoch 6/20] Train Loss: 0.0433, Train Acc: 0.9860 | Val Loss: 0.1386, Val Acc: 0.9609
[Fold 4 Epoch 7/20] Train Loss: 0.0389, Train Acc: 0.9878 | Val Loss: 0.1221, Val Acc: 0.9591
[INFO] Early stopping on fold 4 at epoch 7
[INFO] <<< Finished fold 4, best val acc = 0.9677

[OPTUNA] Trial #1: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00024222859094120915, weight_decay=3.202164586926238e-05
[INFO] >>> Starting fold 5 training (Trial #1) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2678, Train Acc: 0.9057 | Val Loss: 0.1442, Val Acc: 0.9529
[Fold 5 Epoch 2/20] Train Loss: 0.1199, Train Acc: 0.9607 | Val Loss: 0.0884, Val Acc: 0.9711
[Fold 5 Epoch 3/20] Train Loss: 0.0790, Train Acc: 0.9735 | Val Loss: 0.1718, Val Acc: 0.9418
[Fold 5 Epoch 4/20] Train Loss: 0.0624, Train Acc: 0.9788 | Val Loss: 0.1270, Val Acc: 0.9563
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9711

[OPTUNA] Trial #1 done. Fold Accuracies: [0.9727659574468085, 0.9690780141843972, 0.9602836879432625, 0.9676595744680851, 0.971063829787234]. Avg Acc=0.9682

[OPTUNA] Starting Trial #2 with lr=0.000030, weight_decay=0.004269
[OPTUNA] Trial #2: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=2.9998455312273175e-05, weight_decay=0.004268847177005014
[INFO] >>> Starting fold 1 training (Trial #2) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3869, Train Acc: 0.8757 | Val Loss: 0.1245, Val Acc: 0.9620
[Fold 1 Epoch 2/20] Train Loss: 0.0917, Train Acc: 0.9722 | Val Loss: 0.1219, Val Acc: 0.9643
[Fold 1 Epoch 3/20] Train Loss: 0.0318, Train Acc: 0.9916 | Val Loss: 0.1280, Val Acc: 0.9643
[Fold 1 Epoch 4/20] Train Loss: 0.0192, Train Acc: 0.9955 | Val Loss: 0.1109, Val Acc: 0.9699
[Fold 1 Epoch 5/20] Train Loss: 0.0172, Train Acc: 0.9956 | Val Loss: 0.1405, Val Acc: 0.9603
[Fold 1 Epoch 6/20] Train Loss: 0.0310, Train Acc: 0.9916 | Val Loss: 0.1275, Val Acc: 0.9606
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9699

[OPTUNA] Trial #2: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=2.9998455312273175e-05, weight_decay=0.004268847177005014
[INFO] >>> Starting fold 2 training (Trial #2) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3930, Train Acc: 0.8766 | Val Loss: 0.1276, Val Acc: 0.9637
[Fold 2 Epoch 2/20] Train Loss: 0.0911, Train Acc: 0.9714 | Val Loss: 0.1060, Val Acc: 0.9640
[Fold 2 Epoch 3/20] Train Loss: 0.0359, Train Acc: 0.9898 | Val Loss: 0.0890, Val Acc: 0.9691
[Fold 2 Epoch 4/20] Train Loss: 0.0228, Train Acc: 0.9944 | Val Loss: 0.0938, Val Acc: 0.9708
[Fold 2 Epoch 5/20] Train Loss: 0.0174, Train Acc: 0.9957 | Val Loss: 0.1197, Val Acc: 0.9640
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9708

[OPTUNA] Trial #2: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=2.9998455312273175e-05, weight_decay=0.004268847177005014
[INFO] >>> Starting fold 3 training (Trial #2) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.4297, Train Acc: 0.8635 | Val Loss: 0.1408, Val Acc: 0.9591
[Fold 3 Epoch 2/20] Train Loss: 0.0971, Train Acc: 0.9690 | Val Loss: 0.1073, Val Acc: 0.9660
[Fold 3 Epoch 3/20] Train Loss: 0.0363, Train Acc: 0.9902 | Val Loss: 0.0930, Val Acc: 0.9702
[Fold 3 Epoch 4/20] Train Loss: 0.0208, Train Acc: 0.9949 | Val Loss: 0.0977, Val Acc: 0.9657
[Fold 3 Epoch 5/20] Train Loss: 0.0221, Train Acc: 0.9945 | Val Loss: 0.1053, Val Acc: 0.9634
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9702

[OPTUNA] Trial #2: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=2.9998455312273175e-05, weight_decay=0.004268847177005014
[INFO] >>> Starting fold 4 training (Trial #2) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3960, Train Acc: 0.8757 | Val Loss: 0.1409, Val Acc: 0.9529
[Fold 4 Epoch 2/20] Train Loss: 0.0870, Train Acc: 0.9727 | Val Loss: 0.1008, Val Acc: 0.9674
[Fold 4 Epoch 3/20] Train Loss: 0.0347, Train Acc: 0.9915 | Val Loss: 0.1205, Val Acc: 0.9620
[Fold 4 Epoch 4/20] Train Loss: 0.0181, Train Acc: 0.9955 | Val Loss: 0.1477, Val Acc: 0.9586
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9674

[OPTUNA] Trial #2: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=2.9998455312273175e-05, weight_decay=0.004268847177005014
[INFO] >>> Starting fold 5 training (Trial #2) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.4219, Train Acc: 0.8590 | Val Loss: 0.1425, Val Acc: 0.9512
[Fold 5 Epoch 2/20] Train Loss: 0.0947, Train Acc: 0.9695 | Val Loss: 0.1122, Val Acc: 0.9637
[Fold 5 Epoch 3/20] Train Loss: 0.0325, Train Acc: 0.9918 | Val Loss: 0.1030, Val Acc: 0.9654
[Fold 5 Epoch 4/20] Train Loss: 0.0255, Train Acc: 0.9928 | Val Loss: 0.1172, Val Acc: 0.9634
[Fold 5 Epoch 5/20] Train Loss: 0.0153, Train Acc: 0.9963 | Val Loss: 0.1065, Val Acc: 0.9677
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9654

[OPTUNA] Trial #2 done. Fold Accuracies: [0.9699290780141844, 0.9707801418439717, 0.9702127659574468, 0.9673758865248226, 0.9653900709219858]. Avg Acc=0.9687

[OPTUNA] Starting Trial #3 with lr=0.000126, weight_decay=0.000021
[OPTUNA] Trial #3: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0001263283256526553, weight_decay=2.086122232332628e-05
[INFO] >>> Starting fold 1 training (Trial #3) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2594, Train Acc: 0.9113 | Val Loss: 0.1056, Val Acc: 0.9606
[Fold 1 Epoch 2/20] Train Loss: 0.0917, Train Acc: 0.9694 | Val Loss: 0.1310, Val Acc: 0.9549
[Fold 1 Epoch 3/20] Train Loss: 0.0529, Train Acc: 0.9834 | Val Loss: 0.1037, Val Acc: 0.9674
[Fold 1 Epoch 4/20] Train Loss: 0.0360, Train Acc: 0.9891 | Val Loss: 0.1258, Val Acc: 0.9685
[Fold 1 Epoch 5/20] Train Loss: 0.0344, Train Acc: 0.9891 | Val Loss: 0.1944, Val Acc: 0.9549
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9685

[OPTUNA] Trial #3: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0001263283256526553, weight_decay=2.086122232332628e-05
[INFO] >>> Starting fold 2 training (Trial #3) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2634, Train Acc: 0.9098 | Val Loss: 0.1277, Val Acc: 0.9580
[Fold 2 Epoch 2/20] Train Loss: 0.0909, Train Acc: 0.9701 | Val Loss: 0.0865, Val Acc: 0.9702
[Fold 2 Epoch 3/20] Train Loss: 0.0482, Train Acc: 0.9839 | Val Loss: 0.0965, Val Acc: 0.9662
[Fold 2 Epoch 4/20] Train Loss: 0.0395, Train Acc: 0.9874 | Val Loss: 0.1439, Val Acc: 0.9586
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9702

[OPTUNA] Trial #3: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0001263283256526553, weight_decay=2.086122232332628e-05
[INFO] >>> Starting fold 3 training (Trial #3) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2599, Train Acc: 0.9119 | Val Loss: 0.1606, Val Acc: 0.9489
[Fold 3 Epoch 2/20] Train Loss: 0.0919, Train Acc: 0.9696 | Val Loss: 0.0761, Val Acc: 0.9759
[Fold 3 Epoch 3/20] Train Loss: 0.0528, Train Acc: 0.9818 | Val Loss: 0.1251, Val Acc: 0.9594
[Fold 3 Epoch 4/20] Train Loss: 0.0378, Train Acc: 0.9884 | Val Loss: 0.0791, Val Acc: 0.9750
[INFO] Early stopping on fold 3 at epoch 4
[INFO] <<< Finished fold 3, best val acc = 0.9759

[OPTUNA] Trial #3: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0001263283256526553, weight_decay=2.086122232332628e-05
[INFO] >>> Starting fold 4 training (Trial #3) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2587, Train Acc: 0.9142 | Val Loss: 0.1687, Val Acc: 0.9390
[Fold 4 Epoch 2/20] Train Loss: 0.0949, Train Acc: 0.9677 | Val Loss: 0.1128, Val Acc: 0.9606
[Fold 4 Epoch 3/20] Train Loss: 0.0507, Train Acc: 0.9845 | Val Loss: 0.1170, Val Acc: 0.9611
[Fold 4 Epoch 4/20] Train Loss: 0.0379, Train Acc: 0.9882 | Val Loss: 0.1420, Val Acc: 0.9566
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9611

[OPTUNA] Trial #3: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0001263283256526553, weight_decay=2.086122232332628e-05
[INFO] >>> Starting fold 5 training (Trial #3) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2661, Train Acc: 0.9090 | Val Loss: 0.1506, Val Acc: 0.9538
[Fold 5 Epoch 2/20] Train Loss: 0.0899, Train Acc: 0.9697 | Val Loss: 0.0942, Val Acc: 0.9688
[Fold 5 Epoch 3/20] Train Loss: 0.0551, Train Acc: 0.9813 | Val Loss: 0.1006, Val Acc: 0.9677
[Fold 5 Epoch 4/20] Train Loss: 0.0371, Train Acc: 0.9883 | Val Loss: 0.1278, Val Acc: 0.9611
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9688

[OPTUNA] Trial #3 done. Fold Accuracies: [0.9685106382978723, 0.9702127659574468, 0.975886524822695, 0.9611347517730496, 0.9687943262411347]. Avg Acc=0.9689

[OPTUNA] Starting Trial #4 with lr=0.000044, weight_decay=0.003645
[OPTUNA] Trial #4: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=4.443727708443183e-05, weight_decay=0.0036446929755618324
[INFO] >>> Starting fold 1 training (Trial #4) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3501, Train Acc: 0.8840 | Val Loss: 0.1214, Val Acc: 0.9654
[Fold 1 Epoch 2/20] Train Loss: 0.0865, Train Acc: 0.9701 | Val Loss: 0.1036, Val Acc: 0.9679
[Fold 1 Epoch 3/20] Train Loss: 0.0360, Train Acc: 0.9899 | Val Loss: 0.1021, Val Acc: 0.9694
[Fold 1 Epoch 4/20] Train Loss: 0.0324, Train Acc: 0.9909 | Val Loss: 0.1310, Val Acc: 0.9574
[Fold 1 Epoch 5/20] Train Loss: 0.0253, Train Acc: 0.9924 | Val Loss: 0.1820, Val Acc: 0.9580
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9694

[OPTUNA] Trial #4: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=4.443727708443183e-05, weight_decay=0.0036446929755618324
[INFO] >>> Starting fold 2 training (Trial #4) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3349, Train Acc: 0.8916 | Val Loss: 0.1071, Val Acc: 0.9620
[Fold 2 Epoch 2/20] Train Loss: 0.0805, Train Acc: 0.9744 | Val Loss: 0.0960, Val Acc: 0.9631
[Fold 2 Epoch 3/20] Train Loss: 0.0406, Train Acc: 0.9872 | Val Loss: 0.0905, Val Acc: 0.9677
[Fold 2 Epoch 4/20] Train Loss: 0.0268, Train Acc: 0.9923 | Val Loss: 0.1026, Val Acc: 0.9648
[Fold 2 Epoch 5/20] Train Loss: 0.0220, Train Acc: 0.9944 | Val Loss: 0.1101, Val Acc: 0.9677
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9677

[OPTUNA] Trial #4: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=4.443727708443183e-05, weight_decay=0.0036446929755618324
[INFO] >>> Starting fold 3 training (Trial #4) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3588, Train Acc: 0.8833 | Val Loss: 0.1362, Val Acc: 0.9594
[Fold 3 Epoch 2/20] Train Loss: 0.0826, Train Acc: 0.9748 | Val Loss: 0.0859, Val Acc: 0.9742
[Fold 3 Epoch 3/20] Train Loss: 0.0409, Train Acc: 0.9877 | Val Loss: 0.1383, Val Acc: 0.9640
[Fold 3 Epoch 4/20] Train Loss: 0.0325, Train Acc: 0.9909 | Val Loss: 0.0840, Val Acc: 0.9702
[Fold 3 Epoch 5/20] Train Loss: 0.0243, Train Acc: 0.9931 | Val Loss: 0.1353, Val Acc: 0.9594
[Fold 3 Epoch 6/20] Train Loss: 0.0393, Train Acc: 0.9867 | Val Loss: 0.0952, Val Acc: 0.9668
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val acc = 0.9742

[OPTUNA] Trial #4: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=4.443727708443183e-05, weight_decay=0.0036446929755618324
[INFO] >>> Starting fold 4 training (Trial #4) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3375, Train Acc: 0.8906 | Val Loss: 0.1493, Val Acc: 0.9498
[Fold 4 Epoch 2/20] Train Loss: 0.0816, Train Acc: 0.9740 | Val Loss: 0.1371, Val Acc: 0.9577
[Fold 4 Epoch 3/20] Train Loss: 0.0395, Train Acc: 0.9889 | Val Loss: 0.1059, Val Acc: 0.9640
[Fold 4 Epoch 4/20] Train Loss: 0.0286, Train Acc: 0.9910 | Val Loss: 0.1020, Val Acc: 0.9645
[Fold 4 Epoch 5/20] Train Loss: 0.0211, Train Acc: 0.9942 | Val Loss: 0.1739, Val Acc: 0.9447
[Fold 4 Epoch 6/20] Train Loss: 0.0281, Train Acc: 0.9925 | Val Loss: 0.1596, Val Acc: 0.9603
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9645

[OPTUNA] Trial #4: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=4.443727708443183e-05, weight_decay=0.0036446929755618324
[INFO] >>> Starting fold 5 training (Trial #4) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.3346, Train Acc: 0.8903 | Val Loss: 0.1396, Val Acc: 0.9489
[Fold 5 Epoch 2/20] Train Loss: 0.0817, Train Acc: 0.9727 | Val Loss: 0.1176, Val Acc: 0.9589
[Fold 5 Epoch 3/20] Train Loss: 0.0400, Train Acc: 0.9879 | Val Loss: 0.1185, Val Acc: 0.9637
[Fold 5 Epoch 4/20] Train Loss: 0.0278, Train Acc: 0.9917 | Val Loss: 0.1109, Val Acc: 0.9626
[Fold 5 Epoch 5/20] Train Loss: 0.0309, Train Acc: 0.9905 | Val Loss: 0.1357, Val Acc: 0.9560
[Fold 5 Epoch 6/20] Train Loss: 0.0311, Train Acc: 0.9904 | Val Loss: 0.1023, Val Acc: 0.9674
[Fold 5 Epoch 7/20] Train Loss: 0.0214, Train Acc: 0.9941 | Val Loss: 0.1055, Val Acc: 0.9702
[Fold 5 Epoch 8/20] Train Loss: 0.0236, Train Acc: 0.9930 | Val Loss: 0.0986, Val Acc: 0.9708
[Fold 5 Epoch 9/20] Train Loss: 0.0249, Train Acc: 0.9933 | Val Loss: 0.1044, Val Acc: 0.9691
[Fold 5 Epoch 10/20] Train Loss: 0.0246, Train Acc: 0.9923 | Val Loss: 0.1310, Val Acc: 0.9660
[INFO] Early stopping on fold 5 at epoch 10
[INFO] <<< Finished fold 5, best val acc = 0.9708

[OPTUNA] Trial #4 done. Fold Accuracies: [0.9693617021276596, 0.9676595744680851, 0.9741843971631206, 0.9645390070921985, 0.9707801418439717]. Avg Acc=0.9693

[OPTUNA] Starting Trial #5 with lr=0.000046, weight_decay=0.000002
[OPTUNA] Trial #5: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=4.5558992317154973e-05, weight_decay=1.7541363993928004e-06
[INFO] >>> Starting fold 1 training (Trial #5) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3265, Train Acc: 0.8926 | Val Loss: 0.1040, Val Acc: 0.9682
[Fold 1 Epoch 2/20] Train Loss: 0.0694, Train Acc: 0.9790 | Val Loss: 0.0810, Val Acc: 0.9711
[Fold 1 Epoch 3/20] Train Loss: 0.0330, Train Acc: 0.9909 | Val Loss: 0.1323, Val Acc: 0.9594
[Fold 1 Epoch 4/20] Train Loss: 0.0213, Train Acc: 0.9935 | Val Loss: 0.1042, Val Acc: 0.9699
[INFO] Early stopping on fold 1 at epoch 4
[INFO] <<< Finished fold 1, best val acc = 0.9711

[OPTUNA] Trial #5: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=4.5558992317154973e-05, weight_decay=1.7541363993928004e-06
[INFO] >>> Starting fold 2 training (Trial #5) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3420, Train Acc: 0.8844 | Val Loss: 0.1066, Val Acc: 0.9662
[Fold 2 Epoch 2/20] Train Loss: 0.0781, Train Acc: 0.9776 | Val Loss: 0.0864, Val Acc: 0.9696
[Fold 2 Epoch 3/20] Train Loss: 0.0308, Train Acc: 0.9910 | Val Loss: 0.1023, Val Acc: 0.9651
[Fold 2 Epoch 4/20] Train Loss: 0.0202, Train Acc: 0.9940 | Val Loss: 0.0953, Val Acc: 0.9716
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9696

[OPTUNA] Trial #5: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=4.5558992317154973e-05, weight_decay=1.7541363993928004e-06
[INFO] >>> Starting fold 3 training (Trial #5) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3627, Train Acc: 0.8757 | Val Loss: 0.1166, Val Acc: 0.9594
[Fold 3 Epoch 2/20] Train Loss: 0.0779, Train Acc: 0.9743 | Val Loss: 0.0921, Val Acc: 0.9702
[Fold 3 Epoch 3/20] Train Loss: 0.0307, Train Acc: 0.9914 | Val Loss: 0.0848, Val Acc: 0.9725
[Fold 3 Epoch 4/20] Train Loss: 0.0176, Train Acc: 0.9957 | Val Loss: 0.0900, Val Acc: 0.9719
[Fold 3 Epoch 5/20] Train Loss: 0.0153, Train Acc: 0.9956 | Val Loss: 0.0848, Val Acc: 0.9722
[Fold 3 Epoch 6/20] Train Loss: 0.0158, Train Acc: 0.9950 | Val Loss: 0.1072, Val Acc: 0.9702
[Fold 3 Epoch 7/20] Train Loss: 0.0118, Train Acc: 0.9966 | Val Loss: 0.1036, Val Acc: 0.9736
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9725

[OPTUNA] Trial #5: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=4.5558992317154973e-05, weight_decay=1.7541363993928004e-06
[INFO] >>> Starting fold 4 training (Trial #5) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3289, Train Acc: 0.8931 | Val Loss: 0.1317, Val Acc: 0.9529
[Fold 4 Epoch 2/20] Train Loss: 0.0707, Train Acc: 0.9775 | Val Loss: 0.1123, Val Acc: 0.9620
[Fold 4 Epoch 3/20] Train Loss: 0.0311, Train Acc: 0.9909 | Val Loss: 0.1249, Val Acc: 0.9628
[Fold 4 Epoch 4/20] Train Loss: 0.0204, Train Acc: 0.9937 | Val Loss: 0.1208, Val Acc: 0.9645
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9628

[OPTUNA] Trial #5: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=4.5558992317154973e-05, weight_decay=1.7541363993928004e-06
[INFO] >>> Starting fold 5 training (Trial #5) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.3343, Train Acc: 0.8919 | Val Loss: 0.1197, Val Acc: 0.9611
[Fold 5 Epoch 2/20] Train Loss: 0.0764, Train Acc: 0.9751 | Val Loss: 0.0877, Val Acc: 0.9713
[Fold 5 Epoch 3/20] Train Loss: 0.0272, Train Acc: 0.9921 | Val Loss: 0.0835, Val Acc: 0.9728
[Fold 5 Epoch 4/20] Train Loss: 0.0171, Train Acc: 0.9955 | Val Loss: 0.1001, Val Acc: 0.9722
[Fold 5 Epoch 5/20] Train Loss: 0.0201, Train Acc: 0.9943 | Val Loss: 0.1143, Val Acc: 0.9679
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9728

[OPTUNA] Trial #5 done. Fold Accuracies: [0.971063829787234, 0.969645390070922, 0.9724822695035461, 0.9628368794326241, 0.9727659574468085]. Avg Acc=0.9698

[OPTUNA] Starting Trial #6 with lr=0.000902, weight_decay=0.000029
[OPTUNA] Trial #6: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0009016349795383388, weight_decay=2.8732720719921537e-05
[INFO] >>> Starting fold 1 training (Trial #6) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3599, Train Acc: 0.8750 | Val Loss: 0.2802, Val Acc: 0.9092
[Fold 1 Epoch 2/20] Train Loss: 0.1882, Train Acc: 0.9335 | Val Loss: 0.1640, Val Acc: 0.9470
[Fold 1 Epoch 3/20] Train Loss: 0.1569, Train Acc: 0.9461 | Val Loss: 0.2778, Val Acc: 0.9177
[Fold 1 Epoch 4/20] Train Loss: 0.1292, Train Acc: 0.9559 | Val Loss: 0.2010, Val Acc: 0.9387
[INFO] Early stopping on fold 1 at epoch 4
[INFO] <<< Finished fold 1, best val acc = 0.9470

[OPTUNA] Trial #6: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0009016349795383388, weight_decay=2.8732720719921537e-05
[INFO] >>> Starting fold 2 training (Trial #6) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3706, Train Acc: 0.8713 | Val Loss: 0.5228, Val Acc: 0.8423
[Fold 2 Epoch 2/20] Train Loss: 0.2053, Train Acc: 0.9295 | Val Loss: 0.2226, Val Acc: 0.9285
[Fold 2 Epoch 3/20] Train Loss: 0.1634, Train Acc: 0.9438 | Val Loss: 0.1572, Val Acc: 0.9447
[Fold 2 Epoch 4/20] Train Loss: 0.1259, Train Acc: 0.9565 | Val Loss: 0.1823, Val Acc: 0.9450
[Fold 2 Epoch 5/20] Train Loss: 0.1111, Train Acc: 0.9621 | Val Loss: 0.1145, Val Acc: 0.9577
[Fold 2 Epoch 6/20] Train Loss: 0.0922, Train Acc: 0.9668 | Val Loss: 0.1187, Val Acc: 0.9603
[Fold 2 Epoch 7/20] Train Loss: 0.0874, Train Acc: 0.9692 | Val Loss: 0.1475, Val Acc: 0.9543
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val acc = 0.9603

[OPTUNA] Trial #6: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0009016349795383388, weight_decay=2.8732720719921537e-05
[INFO] >>> Starting fold 3 training (Trial #6) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3525, Train Acc: 0.8784 | Val Loss: 0.2194, Val Acc: 0.9254
[Fold 3 Epoch 2/20] Train Loss: 0.1945, Train Acc: 0.9339 | Val Loss: 0.2098, Val Acc: 0.9228
[Fold 3 Epoch 3/20] Train Loss: 0.1484, Train Acc: 0.9511 | Val Loss: 0.1801, Val Acc: 0.9427
[Fold 3 Epoch 4/20] Train Loss: 0.1260, Train Acc: 0.9578 | Val Loss: 0.2782, Val Acc: 0.9143
[Fold 3 Epoch 5/20] Train Loss: 0.1117, Train Acc: 0.9616 | Val Loss: 0.1211, Val Acc: 0.9603
[Fold 3 Epoch 6/20] Train Loss: 0.0940, Train Acc: 0.9678 | Val Loss: 0.1091, Val Acc: 0.9671
[Fold 3 Epoch 7/20] Train Loss: 0.0878, Train Acc: 0.9715 | Val Loss: 0.2029, Val Acc: 0.9359
[Fold 3 Epoch 8/20] Train Loss: 0.0729, Train Acc: 0.9747 | Val Loss: 0.1117, Val Acc: 0.9654
[INFO] Early stopping on fold 3 at epoch 8
[INFO] <<< Finished fold 3, best val acc = 0.9671

[OPTUNA] Trial #6: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0009016349795383388, weight_decay=2.8732720719921537e-05
[INFO] >>> Starting fold 4 training (Trial #6) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.4063, Train Acc: 0.8535 | Val Loss: 0.3077, Val Acc: 0.8777
[Fold 4 Epoch 2/20] Train Loss: 0.2058, Train Acc: 0.9300 | Val Loss: 0.2308, Val Acc: 0.9285
[Fold 4 Epoch 3/20] Train Loss: 0.1512, Train Acc: 0.9494 | Val Loss: 0.2715, Val Acc: 0.9271
[Fold 4 Epoch 4/20] Train Loss: 0.1355, Train Acc: 0.9553 | Val Loss: 0.1421, Val Acc: 0.9529
[Fold 4 Epoch 5/20] Train Loss: 0.1050, Train Acc: 0.9645 | Val Loss: 0.1493, Val Acc: 0.9521
[Fold 4 Epoch 6/20] Train Loss: 0.0935, Train Acc: 0.9674 | Val Loss: 0.2059, Val Acc: 0.9353
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9529

[OPTUNA] Trial #6: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0009016349795383388, weight_decay=2.8732720719921537e-05
[INFO] >>> Starting fold 5 training (Trial #6) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.4017, Train Acc: 0.8588 | Val Loss: 0.2310, Val Acc: 0.9209
[Fold 5 Epoch 2/20] Train Loss: 0.1988, Train Acc: 0.9330 | Val Loss: 0.6470, Val Acc: 0.8340
[Fold 5 Epoch 3/20] Train Loss: 0.1617, Train Acc: 0.9443 | Val Loss: 0.2147, Val Acc: 0.9268
[Fold 5 Epoch 4/20] Train Loss: 0.1306, Train Acc: 0.9557 | Val Loss: 0.2128, Val Acc: 0.9302
[Fold 5 Epoch 5/20] Train Loss: 0.1179, Train Acc: 0.9597 | Val Loss: 0.1328, Val Acc: 0.9606
[Fold 5 Epoch 6/20] Train Loss: 0.1008, Train Acc: 0.9665 | Val Loss: 0.1531, Val Acc: 0.9521
[Fold 5 Epoch 7/20] Train Loss: 0.0940, Train Acc: 0.9693 | Val Loss: 0.1231, Val Acc: 0.9574
[Fold 5 Epoch 8/20] Train Loss: 0.0915, Train Acc: 0.9689 | Val Loss: 0.1534, Val Acc: 0.9512
[Fold 5 Epoch 9/20] Train Loss: 0.0692, Train Acc: 0.9762 | Val Loss: 0.1007, Val Acc: 0.9685
[Fold 5 Epoch 10/20] Train Loss: 0.0729, Train Acc: 0.9748 | Val Loss: 0.2408, Val Acc: 0.9296
[Fold 5 Epoch 11/20] Train Loss: 0.0771, Train Acc: 0.9752 | Val Loss: 0.1170, Val Acc: 0.9640
[INFO] Early stopping on fold 5 at epoch 11
[INFO] <<< Finished fold 5, best val acc = 0.9685

[OPTUNA] Trial #6 done. Fold Accuracies: [0.946950354609929, 0.9602836879432625, 0.9670921985815603, 0.9529078014184397, 0.9685106382978723]. Avg Acc=0.9591

[OPTUNA] Starting Trial #7 with lr=0.000018, weight_decay=0.000003
[OPTUNA] Trial #7: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=1.8328099553559333e-05, weight_decay=3.4058011277544586e-06
[INFO] >>> Starting fold 1 training (Trial #7) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.5382, Train Acc: 0.8301 | Val Loss: 0.2017, Val Acc: 0.9333
[Fold 1 Epoch 2/20] Train Loss: 0.1309, Train Acc: 0.9614 | Val Loss: 0.1187, Val Acc: 0.9611
[Fold 1 Epoch 3/20] Train Loss: 0.0466, Train Acc: 0.9884 | Val Loss: 0.1057, Val Acc: 0.9623
[Fold 1 Epoch 4/20] Train Loss: 0.0199, Train Acc: 0.9967 | Val Loss: 0.1027, Val Acc: 0.9691
[Fold 1 Epoch 5/20] Train Loss: 0.0103, Train Acc: 0.9988 | Val Loss: 0.0965, Val Acc: 0.9696
[Fold 1 Epoch 6/20] Train Loss: 0.0078, Train Acc: 0.9989 | Val Loss: 0.1174, Val Acc: 0.9637
[Fold 1 Epoch 7/20] Train Loss: 0.0075, Train Acc: 0.9988 | Val Loss: 0.1233, Val Acc: 0.9660
[INFO] Early stopping on fold 1 at epoch 7
[INFO] <<< Finished fold 1, best val acc = 0.9696

[OPTUNA] Trial #7: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=1.8328099553559333e-05, weight_decay=3.4058011277544586e-06
[INFO] >>> Starting fold 2 training (Trial #7) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.5071, Train Acc: 0.8424 | Val Loss: 0.1693, Val Acc: 0.9427
[Fold 2 Epoch 2/20] Train Loss: 0.1207, Train Acc: 0.9640 | Val Loss: 0.1087, Val Acc: 0.9628
[Fold 2 Epoch 3/20] Train Loss: 0.0449, Train Acc: 0.9888 | Val Loss: 0.0921, Val Acc: 0.9688
[Fold 2 Epoch 4/20] Train Loss: 0.0192, Train Acc: 0.9969 | Val Loss: 0.0996, Val Acc: 0.9668
[Fold 2 Epoch 5/20] Train Loss: 0.0110, Train Acc: 0.9981 | Val Loss: 0.0879, Val Acc: 0.9696
[Fold 2 Epoch 6/20] Train Loss: 0.0068, Train Acc: 0.9996 | Val Loss: 0.0930, Val Acc: 0.9696
[Fold 2 Epoch 7/20] Train Loss: 0.0089, Train Acc: 0.9982 | Val Loss: 0.1007, Val Acc: 0.9671
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val acc = 0.9696

[OPTUNA] Trial #7: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=1.8328099553559333e-05, weight_decay=3.4058011277544586e-06
[INFO] >>> Starting fold 3 training (Trial #7) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.5149, Train Acc: 0.8381 | Val Loss: 0.1908, Val Acc: 0.9401
[Fold 3 Epoch 2/20] Train Loss: 0.1269, Train Acc: 0.9620 | Val Loss: 0.1010, Val Acc: 0.9696
[Fold 3 Epoch 3/20] Train Loss: 0.0443, Train Acc: 0.9901 | Val Loss: 0.0919, Val Acc: 0.9688
[Fold 3 Epoch 4/20] Train Loss: 0.0214, Train Acc: 0.9962 | Val Loss: 0.0824, Val Acc: 0.9682
[Fold 3 Epoch 5/20] Train Loss: 0.0114, Train Acc: 0.9982 | Val Loss: 0.0940, Val Acc: 0.9691
[Fold 3 Epoch 6/20] Train Loss: 0.0087, Train Acc: 0.9980 | Val Loss: 0.0963, Val Acc: 0.9645
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val acc = 0.9696

[OPTUNA] Trial #7: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=1.8328099553559333e-05, weight_decay=3.4058011277544586e-06
[INFO] >>> Starting fold 4 training (Trial #7) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.5362, Train Acc: 0.8291 | Val Loss: 0.2176, Val Acc: 0.9367
[Fold 4 Epoch 2/20] Train Loss: 0.1279, Train Acc: 0.9599 | Val Loss: 0.1298, Val Acc: 0.9589
[Fold 4 Epoch 3/20] Train Loss: 0.0462, Train Acc: 0.9894 | Val Loss: 0.1403, Val Acc: 0.9560
[Fold 4 Epoch 4/20] Train Loss: 0.0188, Train Acc: 0.9966 | Val Loss: 0.1357, Val Acc: 0.9574
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9589

[OPTUNA] Trial #7: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=1.8328099553559333e-05, weight_decay=3.4058011277544586e-06
[INFO] >>> Starting fold 5 training (Trial #7) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.5155, Train Acc: 0.8431 | Val Loss: 0.1884, Val Acc: 0.9399
[Fold 5 Epoch 2/20] Train Loss: 0.1223, Train Acc: 0.9618 | Val Loss: 0.1114, Val Acc: 0.9645
[Fold 5 Epoch 3/20] Train Loss: 0.0433, Train Acc: 0.9895 | Val Loss: 0.1041, Val Acc: 0.9628
[Fold 5 Epoch 4/20] Train Loss: 0.0194, Train Acc: 0.9965 | Val Loss: 0.1006, Val Acc: 0.9654
[Fold 5 Epoch 5/20] Train Loss: 0.0122, Train Acc: 0.9980 | Val Loss: 0.0997, Val Acc: 0.9682
[Fold 5 Epoch 6/20] Train Loss: 0.0078, Train Acc: 0.9989 | Val Loss: 0.1011, Val Acc: 0.9677
[Fold 5 Epoch 7/20] Train Loss: 0.0047, Train Acc: 0.9996 | Val Loss: 0.1042, Val Acc: 0.9677
[INFO] Early stopping on fold 5 at epoch 7
[INFO] <<< Finished fold 5, best val acc = 0.9682

[OPTUNA] Trial #7 done. Fold Accuracies: [0.969645390070922, 0.969645390070922, 0.969645390070922, 0.9588652482269504, 0.9682269503546099]. Avg Acc=0.9672

[OPTUNA] Starting Trial #8 with lr=0.000017, weight_decay=0.000318
[OPTUNA] Trial #8: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=1.7381564035600688e-05, weight_decay=0.00031831501293905613
[INFO] >>> Starting fold 1 training (Trial #8) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.5263, Train Acc: 0.8375 | Val Loss: 0.2085, Val Acc: 0.9325
[Fold 1 Epoch 2/20] Train Loss: 0.1270, Train Acc: 0.9624 | Val Loss: 0.1126, Val Acc: 0.9648
[Fold 1 Epoch 3/20] Train Loss: 0.0478, Train Acc: 0.9877 | Val Loss: 0.1041, Val Acc: 0.9682
[Fold 1 Epoch 4/20] Train Loss: 0.0210, Train Acc: 0.9967 | Val Loss: 0.1142, Val Acc: 0.9679
[Fold 1 Epoch 5/20] Train Loss: 0.0101, Train Acc: 0.9988 | Val Loss: 0.1041, Val Acc: 0.9660
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9682

[OPTUNA] Trial #8: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=1.7381564035600688e-05, weight_decay=0.00031831501293905613
[INFO] >>> Starting fold 2 training (Trial #8) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.5315, Train Acc: 0.8350 | Val Loss: 0.1979, Val Acc: 0.9373
[Fold 2 Epoch 2/20] Train Loss: 0.1335, Train Acc: 0.9565 | Val Loss: 0.1067, Val Acc: 0.9660
[Fold 2 Epoch 3/20] Train Loss: 0.0496, Train Acc: 0.9884 | Val Loss: 0.0991, Val Acc: 0.9643
[Fold 2 Epoch 4/20] Train Loss: 0.0217, Train Acc: 0.9958 | Val Loss: 0.1013, Val Acc: 0.9651
[Fold 2 Epoch 5/20] Train Loss: 0.0140, Train Acc: 0.9977 | Val Loss: 0.1048, Val Acc: 0.9660
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9660

[OPTUNA] Trial #8: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=1.7381564035600688e-05, weight_decay=0.00031831501293905613
[INFO] >>> Starting fold 3 training (Trial #8) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.5361, Train Acc: 0.8329 | Val Loss: 0.2078, Val Acc: 0.9359
[Fold 3 Epoch 2/20] Train Loss: 0.1403, Train Acc: 0.9577 | Val Loss: 0.1190, Val Acc: 0.9589
[Fold 3 Epoch 3/20] Train Loss: 0.0522, Train Acc: 0.9879 | Val Loss: 0.1021, Val Acc: 0.9691
[Fold 3 Epoch 4/20] Train Loss: 0.0217, Train Acc: 0.9960 | Val Loss: 0.0947, Val Acc: 0.9682
[Fold 3 Epoch 5/20] Train Loss: 0.0125, Train Acc: 0.9982 | Val Loss: 0.0928, Val Acc: 0.9699
[Fold 3 Epoch 6/20] Train Loss: 0.0076, Train Acc: 0.9991 | Val Loss: 0.0972, Val Acc: 0.9694
[Fold 3 Epoch 7/20] Train Loss: 0.0042, Train Acc: 0.9998 | Val Loss: 0.0923, Val Acc: 0.9711
[Fold 3 Epoch 8/20] Train Loss: 0.0053, Train Acc: 0.9992 | Val Loss: 0.0998, Val Acc: 0.9694
[Fold 3 Epoch 9/20] Train Loss: 0.0030, Train Acc: 0.9999 | Val Loss: 0.0922, Val Acc: 0.9725
[Fold 3 Epoch 10/20] Train Loss: 0.0034, Train Acc: 0.9996 | Val Loss: 0.1304, Val Acc: 0.9594
[Fold 3 Epoch 11/20] Train Loss: 0.0082, Train Acc: 0.9982 | Val Loss: 0.1142, Val Acc: 0.9645
[INFO] Early stopping on fold 3 at epoch 11
[INFO] <<< Finished fold 3, best val acc = 0.9725

[OPTUNA] Trial #8: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=1.7381564035600688e-05, weight_decay=0.00031831501293905613
[INFO] >>> Starting fold 4 training (Trial #8) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.5312, Train Acc: 0.8340 | Val Loss: 0.2092, Val Acc: 0.9379
[Fold 4 Epoch 2/20] Train Loss: 0.1329, Train Acc: 0.9587 | Val Loss: 0.1292, Val Acc: 0.9586
[Fold 4 Epoch 3/20] Train Loss: 0.0488, Train Acc: 0.9879 | Val Loss: 0.1193, Val Acc: 0.9611
[Fold 4 Epoch 4/20] Train Loss: 0.0207, Train Acc: 0.9970 | Val Loss: 0.1257, Val Acc: 0.9620
[Fold 4 Epoch 5/20] Train Loss: 0.0097, Train Acc: 0.9991 | Val Loss: 0.1189, Val Acc: 0.9623
[Fold 4 Epoch 6/20] Train Loss: 0.0080, Train Acc: 0.9991 | Val Loss: 0.1261, Val Acc: 0.9634
[Fold 4 Epoch 7/20] Train Loss: 0.0041, Train Acc: 0.9999 | Val Loss: 0.1208, Val Acc: 0.9631
[INFO] Early stopping on fold 4 at epoch 7
[INFO] <<< Finished fold 4, best val acc = 0.9634

[OPTUNA] Trial #8: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=1.7381564035600688e-05, weight_decay=0.00031831501293905613
[INFO] >>> Starting fold 5 training (Trial #8) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.5221, Train Acc: 0.8374 | Val Loss: 0.1987, Val Acc: 0.9396
[Fold 5 Epoch 2/20] Train Loss: 0.1277, Train Acc: 0.9618 | Val Loss: 0.1208, Val Acc: 0.9611
[Fold 5 Epoch 3/20] Train Loss: 0.0458, Train Acc: 0.9896 | Val Loss: 0.1092, Val Acc: 0.9628
[Fold 5 Epoch 4/20] Train Loss: 0.0197, Train Acc: 0.9965 | Val Loss: 0.1040, Val Acc: 0.9682
[Fold 5 Epoch 5/20] Train Loss: 0.0106, Train Acc: 0.9982 | Val Loss: 0.1074, Val Acc: 0.9631
[Fold 5 Epoch 6/20] Train Loss: 0.0097, Train Acc: 0.9984 | Val Loss: 0.1171, Val Acc: 0.9640
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9682

[OPTUNA] Trial #8 done. Fold Accuracies: [0.9682269503546099, 0.9659574468085106, 0.9724822695035461, 0.963404255319149, 0.9682269503546099]. Avg Acc=0.9677

[OPTUNA] Starting Trial #9 with lr=0.000044, weight_decay=0.000004
[OPTUNA] Trial #9: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=4.401180662197339e-05, weight_decay=4.421966797416062e-06
[INFO] >>> Starting fold 1 training (Trial #9) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3386, Train Acc: 0.8866 | Val Loss: 0.1221, Val Acc: 0.9645
[Fold 1 Epoch 2/20] Train Loss: 0.0770, Train Acc: 0.9746 | Val Loss: 0.0971, Val Acc: 0.9696
[Fold 1 Epoch 3/20] Train Loss: 0.0363, Train Acc: 0.9894 | Val Loss: 0.1129, Val Acc: 0.9660
[Fold 1 Epoch 4/20] Train Loss: 0.0215, Train Acc: 0.9944 | Val Loss: 0.0931, Val Acc: 0.9696
[Fold 1 Epoch 5/20] Train Loss: 0.0113, Train Acc: 0.9970 | Val Loss: 0.0775, Val Acc: 0.9779
[Fold 1 Epoch 6/20] Train Loss: 0.0120, Train Acc: 0.9968 | Val Loss: 0.1080, Val Acc: 0.9696
[Fold 1 Epoch 7/20] Train Loss: 0.0151, Train Acc: 0.9954 | Val Loss: 0.0968, Val Acc: 0.9682
[INFO] Early stopping on fold 1 at epoch 7
[INFO] <<< Finished fold 1, best val acc = 0.9779

[OPTUNA] Trial #9: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=4.401180662197339e-05, weight_decay=4.421966797416062e-06
[INFO] >>> Starting fold 2 training (Trial #9) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3445, Train Acc: 0.8882 | Val Loss: 0.1288, Val Acc: 0.9577
[Fold 2 Epoch 2/20] Train Loss: 0.0743, Train Acc: 0.9778 | Val Loss: 0.1000, Val Acc: 0.9657
[Fold 2 Epoch 3/20] Train Loss: 0.0336, Train Acc: 0.9894 | Val Loss: 0.0976, Val Acc: 0.9662
[Fold 2 Epoch 4/20] Train Loss: 0.0205, Train Acc: 0.9940 | Val Loss: 0.1126, Val Acc: 0.9671
[Fold 2 Epoch 5/20] Train Loss: 0.0130, Train Acc: 0.9966 | Val Loss: 0.1336, Val Acc: 0.9677
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9671

[OPTUNA] Trial #9: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=4.401180662197339e-05, weight_decay=4.421966797416062e-06
[INFO] >>> Starting fold 3 training (Trial #9) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3391, Train Acc: 0.8898 | Val Loss: 0.1399, Val Acc: 0.9549
[Fold 3 Epoch 2/20] Train Loss: 0.0814, Train Acc: 0.9738 | Val Loss: 0.0822, Val Acc: 0.9730
[Fold 3 Epoch 3/20] Train Loss: 0.0317, Train Acc: 0.9904 | Val Loss: 0.0785, Val Acc: 0.9742
[Fold 3 Epoch 4/20] Train Loss: 0.0193, Train Acc: 0.9942 | Val Loss: 0.0781, Val Acc: 0.9748
[Fold 3 Epoch 5/20] Train Loss: 0.0114, Train Acc: 0.9970 | Val Loss: 0.0851, Val Acc: 0.9705
[Fold 3 Epoch 6/20] Train Loss: 0.0107, Train Acc: 0.9974 | Val Loss: 0.1131, Val Acc: 0.9702
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val acc = 0.9748

[OPTUNA] Trial #9: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=4.401180662197339e-05, weight_decay=4.421966797416062e-06
[INFO] >>> Starting fold 4 training (Trial #9) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3223, Train Acc: 0.8970 | Val Loss: 0.1193, Val Acc: 0.9628
[Fold 4 Epoch 2/20] Train Loss: 0.0708, Train Acc: 0.9781 | Val Loss: 0.1319, Val Acc: 0.9603
[Fold 4 Epoch 3/20] Train Loss: 0.0305, Train Acc: 0.9921 | Val Loss: 0.1100, Val Acc: 0.9679
[Fold 4 Epoch 4/20] Train Loss: 0.0180, Train Acc: 0.9951 | Val Loss: 0.1097, Val Acc: 0.9662
[Fold 4 Epoch 5/20] Train Loss: 0.0130, Train Acc: 0.9962 | Val Loss: 0.1298, Val Acc: 0.9685
[Fold 4 Epoch 6/20] Train Loss: 0.0108, Train Acc: 0.9972 | Val Loss: 0.1136, Val Acc: 0.9674
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9685

[OPTUNA] Trial #9: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=4.401180662197339e-05, weight_decay=4.421966797416062e-06
[INFO] >>> Starting fold 5 training (Trial #9) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.3380, Train Acc: 0.8867 | Val Loss: 0.1165, Val Acc: 0.9606
[Fold 5 Epoch 2/20] Train Loss: 0.0774, Train Acc: 0.9744 | Val Loss: 0.0975, Val Acc: 0.9685
[Fold 5 Epoch 3/20] Train Loss: 0.0344, Train Acc: 0.9912 | Val Loss: 0.0808, Val Acc: 0.9730
[Fold 5 Epoch 4/20] Train Loss: 0.0210, Train Acc: 0.9935 | Val Loss: 0.1026, Val Acc: 0.9711
[Fold 5 Epoch 5/20] Train Loss: 0.0087, Train Acc: 0.9981 | Val Loss: 0.0939, Val Acc: 0.9708
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9730

[OPTUNA] Trial #9 done. Fold Accuracies: [0.977872340425532, 0.9670921985815603, 0.9747517730496454, 0.9685106382978723, 0.9730496453900709]. Avg Acc=0.9723

[OPTUNA] Starting Trial #10 with lr=0.000388, weight_decay=0.000008
[OPTUNA] Trial #10: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0003882807156871483, weight_decay=8.034550502712234e-06
[INFO] >>> Starting fold 1 training (Trial #10) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2934, Train Acc: 0.8987 | Val Loss: 0.3476, Val Acc: 0.9081
[Fold 1 Epoch 2/20] Train Loss: 0.1635, Train Acc: 0.9450 | Val Loss: 0.2075, Val Acc: 0.9452
[Fold 1 Epoch 3/20] Train Loss: 0.1089, Train Acc: 0.9635 | Val Loss: 0.1407, Val Acc: 0.9543
[Fold 1 Epoch 4/20] Train Loss: 0.0853, Train Acc: 0.9713 | Val Loss: 0.1221, Val Acc: 0.9591
[Fold 1 Epoch 5/20] Train Loss: 0.0687, Train Acc: 0.9765 | Val Loss: 0.1246, Val Acc: 0.9643
[Fold 1 Epoch 6/20] Train Loss: 0.0607, Train Acc: 0.9801 | Val Loss: 0.1492, Val Acc: 0.9594
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9643

[OPTUNA] Trial #10: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0003882807156871483, weight_decay=8.034550502712234e-06
[INFO] >>> Starting fold 2 training (Trial #10) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2838, Train Acc: 0.9009 | Val Loss: 0.1885, Val Acc: 0.9401
[Fold 2 Epoch 2/20] Train Loss: 0.1413, Train Acc: 0.9526 | Val Loss: 0.1278, Val Acc: 0.9523
[Fold 2 Epoch 3/20] Train Loss: 0.0995, Train Acc: 0.9652 | Val Loss: 0.1344, Val Acc: 0.9597
[Fold 2 Epoch 4/20] Train Loss: 0.0831, Train Acc: 0.9716 | Val Loss: 0.1596, Val Acc: 0.9424
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9597

[OPTUNA] Trial #10: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0003882807156871483, weight_decay=8.034550502712234e-06
[INFO] >>> Starting fold 3 training (Trial #10) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2887, Train Acc: 0.8986 | Val Loss: 0.1941, Val Acc: 0.9350
[Fold 3 Epoch 2/20] Train Loss: 0.1477, Train Acc: 0.9502 | Val Loss: 0.1769, Val Acc: 0.9461
[Fold 3 Epoch 3/20] Train Loss: 0.1008, Train Acc: 0.9665 | Val Loss: 0.1242, Val Acc: 0.9591
[Fold 3 Epoch 4/20] Train Loss: 0.0771, Train Acc: 0.9729 | Val Loss: 0.1079, Val Acc: 0.9654
[Fold 3 Epoch 5/20] Train Loss: 0.0602, Train Acc: 0.9791 | Val Loss: 0.2001, Val Acc: 0.9424
[Fold 3 Epoch 6/20] Train Loss: 0.0580, Train Acc: 0.9816 | Val Loss: 0.1947, Val Acc: 0.9447
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val acc = 0.9654

[OPTUNA] Trial #10: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0003882807156871483, weight_decay=8.034550502712234e-06
[INFO] >>> Starting fold 4 training (Trial #10) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2784, Train Acc: 0.9045 | Val Loss: 0.2238, Val Acc: 0.9254
[Fold 4 Epoch 2/20] Train Loss: 0.1398, Train Acc: 0.9530 | Val Loss: 0.1767, Val Acc: 0.9401
[Fold 4 Epoch 3/20] Train Loss: 0.1102, Train Acc: 0.9629 | Val Loss: 0.2121, Val Acc: 0.9470
[Fold 4 Epoch 4/20] Train Loss: 0.0831, Train Acc: 0.9731 | Val Loss: 0.1652, Val Acc: 0.9475
[Fold 4 Epoch 5/20] Train Loss: 0.0617, Train Acc: 0.9794 | Val Loss: 0.1906, Val Acc: 0.9435
[Fold 4 Epoch 6/20] Train Loss: 0.0611, Train Acc: 0.9804 | Val Loss: 0.1762, Val Acc: 0.9532
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9475

[OPTUNA] Trial #10: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0003882807156871483, weight_decay=8.034550502712234e-06
[INFO] >>> Starting fold 5 training (Trial #10) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2767, Train Acc: 0.9041 | Val Loss: 0.1977, Val Acc: 0.9359
[Fold 5 Epoch 2/20] Train Loss: 0.1376, Train Acc: 0.9515 | Val Loss: 0.1347, Val Acc: 0.9566
[Fold 5 Epoch 3/20] Train Loss: 0.1015, Train Acc: 0.9646 | Val Loss: 0.1314, Val Acc: 0.9623
[Fold 5 Epoch 4/20] Train Loss: 0.0818, Train Acc: 0.9721 | Val Loss: 0.1136, Val Acc: 0.9674
[Fold 5 Epoch 5/20] Train Loss: 0.0752, Train Acc: 0.9729 | Val Loss: 0.0975, Val Acc: 0.9728
[Fold 5 Epoch 6/20] Train Loss: 0.0434, Train Acc: 0.9860 | Val Loss: 0.1332, Val Acc: 0.9609
[Fold 5 Epoch 7/20] Train Loss: 0.0442, Train Acc: 0.9860 | Val Loss: 0.1441, Val Acc: 0.9643
[INFO] Early stopping on fold 5 at epoch 7
[INFO] <<< Finished fold 5, best val acc = 0.9728

[OPTUNA] Trial #10 done. Fold Accuracies: [0.9642553191489361, 0.9597163120567376, 0.9653900709219858, 0.9475177304964539, 0.9727659574468085]. Avg Acc=0.9619

[OPTUNA] Starting Trial #11 with lr=0.000099, weight_decay=0.000301
[OPTUNA] Trial #11: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=9.916274020360132e-05, weight_decay=0.00030112576995332886
[INFO] >>> Starting fold 1 training (Trial #11) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2672, Train Acc: 0.9101 | Val Loss: 0.1454, Val Acc: 0.9523
[Fold 1 Epoch 2/20] Train Loss: 0.0840, Train Acc: 0.9723 | Val Loss: 0.1111, Val Acc: 0.9713
[Fold 1 Epoch 3/20] Train Loss: 0.0527, Train Acc: 0.9820 | Val Loss: 0.1123, Val Acc: 0.9628
[Fold 1 Epoch 4/20] Train Loss: 0.0310, Train Acc: 0.9903 | Val Loss: 0.1023, Val Acc: 0.9728
[Fold 1 Epoch 5/20] Train Loss: 0.0276, Train Acc: 0.9914 | Val Loss: 0.1360, Val Acc: 0.9600
[Fold 1 Epoch 6/20] Train Loss: 0.0316, Train Acc: 0.9896 | Val Loss: 0.1178, Val Acc: 0.9677
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9728

[OPTUNA] Trial #11: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=9.916274020360132e-05, weight_decay=0.00030112576995332886
[INFO] >>> Starting fold 2 training (Trial #11) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2704, Train Acc: 0.9115 | Val Loss: 0.1562, Val Acc: 0.9498
[Fold 2 Epoch 2/20] Train Loss: 0.0869, Train Acc: 0.9706 | Val Loss: 0.0964, Val Acc: 0.9668
[Fold 2 Epoch 3/20] Train Loss: 0.0452, Train Acc: 0.9852 | Val Loss: 0.1033, Val Acc: 0.9699
[Fold 2 Epoch 4/20] Train Loss: 0.0417, Train Acc: 0.9855 | Val Loss: 0.1006, Val Acc: 0.9682
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9699

[OPTUNA] Trial #11: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=9.916274020360132e-05, weight_decay=0.00030112576995332886
[INFO] >>> Starting fold 3 training (Trial #11) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2715, Train Acc: 0.9113 | Val Loss: 0.1229, Val Acc: 0.9569
[Fold 3 Epoch 2/20] Train Loss: 0.0844, Train Acc: 0.9711 | Val Loss: 0.1392, Val Acc: 0.9495
[Fold 3 Epoch 3/20] Train Loss: 0.0464, Train Acc: 0.9855 | Val Loss: 0.1116, Val Acc: 0.9657
[Fold 3 Epoch 4/20] Train Loss: 0.0424, Train Acc: 0.9865 | Val Loss: 0.1204, Val Acc: 0.9660
[Fold 3 Epoch 5/20] Train Loss: 0.0258, Train Acc: 0.9920 | Val Loss: 0.0962, Val Acc: 0.9682
[Fold 3 Epoch 6/20] Train Loss: 0.0272, Train Acc: 0.9925 | Val Loss: 0.0905, Val Acc: 0.9708
[Fold 3 Epoch 7/20] Train Loss: 0.0174, Train Acc: 0.9949 | Val Loss: 0.1039, Val Acc: 0.9665
[Fold 3 Epoch 8/20] Train Loss: 0.0167, Train Acc: 0.9955 | Val Loss: 0.0759, Val Acc: 0.9767
[Fold 3 Epoch 9/20] Train Loss: 0.0166, Train Acc: 0.9946 | Val Loss: 0.1278, Val Acc: 0.9685
[Fold 3 Epoch 10/20] Train Loss: 0.0299, Train Acc: 0.9911 | Val Loss: 0.1484, Val Acc: 0.9614
[INFO] Early stopping on fold 3 at epoch 10
[INFO] <<< Finished fold 3, best val acc = 0.9767

[OPTUNA] Trial #11: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=9.916274020360132e-05, weight_decay=0.00030112576995332886
[INFO] >>> Starting fold 4 training (Trial #11) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2557, Train Acc: 0.9133 | Val Loss: 0.1100, Val Acc: 0.9609
[Fold 4 Epoch 2/20] Train Loss: 0.0797, Train Acc: 0.9751 | Val Loss: 0.0969, Val Acc: 0.9645
[Fold 4 Epoch 3/20] Train Loss: 0.0450, Train Acc: 0.9850 | Val Loss: 0.1037, Val Acc: 0.9637
[Fold 4 Epoch 4/20] Train Loss: 0.0343, Train Acc: 0.9895 | Val Loss: 0.1068, Val Acc: 0.9657
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9645

[OPTUNA] Trial #11: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=9.916274020360132e-05, weight_decay=0.00030112576995332886
[INFO] >>> Starting fold 5 training (Trial #11) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2566, Train Acc: 0.9142 | Val Loss: 0.1346, Val Acc: 0.9572
[Fold 5 Epoch 2/20] Train Loss: 0.0807, Train Acc: 0.9732 | Val Loss: 0.1240, Val Acc: 0.9563
[Fold 5 Epoch 3/20] Train Loss: 0.0444, Train Acc: 0.9849 | Val Loss: 0.1117, Val Acc: 0.9634
[Fold 5 Epoch 4/20] Train Loss: 0.0475, Train Acc: 0.9848 | Val Loss: 0.0845, Val Acc: 0.9770
[Fold 5 Epoch 5/20] Train Loss: 0.0246, Train Acc: 0.9925 | Val Loss: 0.0870, Val Acc: 0.9765
[Fold 5 Epoch 6/20] Train Loss: 0.0245, Train Acc: 0.9924 | Val Loss: 0.1172, Val Acc: 0.9657
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9770

[OPTUNA] Trial #11 done. Fold Accuracies: [0.9727659574468085, 0.9699290780141844, 0.9767375886524823, 0.9645390070921985, 0.9770212765957447]. Avg Acc=0.9722

[OPTUNA] Starting Trial #12 with lr=0.000070, weight_decay=0.000583
[OPTUNA] Trial #12: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=6.966555146050738e-05, weight_decay=0.0005828246307112184
[INFO] >>> Starting fold 1 training (Trial #12) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2942, Train Acc: 0.9052 | Val Loss: 0.1080, Val Acc: 0.9662
[Fold 1 Epoch 2/20] Train Loss: 0.0783, Train Acc: 0.9750 | Val Loss: 0.1313, Val Acc: 0.9600
[Fold 1 Epoch 3/20] Train Loss: 0.0411, Train Acc: 0.9871 | Val Loss: 0.1107, Val Acc: 0.9668
[INFO] Early stopping on fold 1 at epoch 3
[INFO] <<< Finished fold 1, best val acc = 0.9662

[OPTUNA] Trial #12: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=6.966555146050738e-05, weight_decay=0.0005828246307112184
[INFO] >>> Starting fold 2 training (Trial #12) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2936, Train Acc: 0.9024 | Val Loss: 0.1304, Val Acc: 0.9523
[Fold 2 Epoch 2/20] Train Loss: 0.0730, Train Acc: 0.9762 | Val Loss: 0.0993, Val Acc: 0.9679
[Fold 2 Epoch 3/20] Train Loss: 0.0437, Train Acc: 0.9855 | Val Loss: 0.1200, Val Acc: 0.9634
[Fold 2 Epoch 4/20] Train Loss: 0.0256, Train Acc: 0.9923 | Val Loss: 0.1241, Val Acc: 0.9626
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9679

[OPTUNA] Trial #12: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=6.966555146050738e-05, weight_decay=0.0005828246307112184
[INFO] >>> Starting fold 3 training (Trial #12) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2913, Train Acc: 0.9018 | Val Loss: 0.1205, Val Acc: 0.9600
[Fold 3 Epoch 2/20] Train Loss: 0.0801, Train Acc: 0.9744 | Val Loss: 0.1383, Val Acc: 0.9594
[Fold 3 Epoch 3/20] Train Loss: 0.0378, Train Acc: 0.9879 | Val Loss: 0.1028, Val Acc: 0.9643
[Fold 3 Epoch 4/20] Train Loss: 0.0370, Train Acc: 0.9882 | Val Loss: 0.1011, Val Acc: 0.9671
[Fold 3 Epoch 5/20] Train Loss: 0.0248, Train Acc: 0.9932 | Val Loss: 0.1080, Val Acc: 0.9623
[Fold 3 Epoch 6/20] Train Loss: 0.0195, Train Acc: 0.9943 | Val Loss: 0.1002, Val Acc: 0.9691
[Fold 3 Epoch 7/20] Train Loss: 0.0202, Train Acc: 0.9945 | Val Loss: 0.1277, Val Acc: 0.9634
[Fold 3 Epoch 8/20] Train Loss: 0.0200, Train Acc: 0.9945 | Val Loss: 0.0840, Val Acc: 0.9725
[Fold 3 Epoch 9/20] Train Loss: 0.0208, Train Acc: 0.9944 | Val Loss: 0.0787, Val Acc: 0.9736
[Fold 3 Epoch 10/20] Train Loss: 0.0198, Train Acc: 0.9943 | Val Loss: 0.0883, Val Acc: 0.9705
[Fold 3 Epoch 11/20] Train Loss: 0.0130, Train Acc: 0.9964 | Val Loss: 0.1535, Val Acc: 0.9611
[INFO] Early stopping on fold 3 at epoch 11
[INFO] <<< Finished fold 3, best val acc = 0.9736

[OPTUNA] Trial #12: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=6.966555146050738e-05, weight_decay=0.0005828246307112184
[INFO] >>> Starting fold 4 training (Trial #12) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2825, Train Acc: 0.9033 | Val Loss: 0.1437, Val Acc: 0.9557
[Fold 4 Epoch 2/20] Train Loss: 0.0773, Train Acc: 0.9737 | Val Loss: 0.1368, Val Acc: 0.9538
[Fold 4 Epoch 3/20] Train Loss: 0.0403, Train Acc: 0.9876 | Val Loss: 0.1133, Val Acc: 0.9603
[Fold 4 Epoch 4/20] Train Loss: 0.0289, Train Acc: 0.9912 | Val Loss: 0.1389, Val Acc: 0.9597
[Fold 4 Epoch 5/20] Train Loss: 0.0262, Train Acc: 0.9921 | Val Loss: 0.1096, Val Acc: 0.9654
[Fold 4 Epoch 6/20] Train Loss: 0.0262, Train Acc: 0.9928 | Val Loss: 0.1785, Val Acc: 0.9586
[Fold 4 Epoch 7/20] Train Loss: 0.0167, Train Acc: 0.9948 | Val Loss: 0.0956, Val Acc: 0.9688
[Fold 4 Epoch 8/20] Train Loss: 0.0135, Train Acc: 0.9960 | Val Loss: 0.1295, Val Acc: 0.9662
[Fold 4 Epoch 9/20] Train Loss: 0.0207, Train Acc: 0.9932 | Val Loss: 0.1785, Val Acc: 0.9540
[INFO] Early stopping on fold 4 at epoch 9
[INFO] <<< Finished fold 4, best val acc = 0.9688

[OPTUNA] Trial #12: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=6.966555146050738e-05, weight_decay=0.0005828246307112184
[INFO] >>> Starting fold 5 training (Trial #12) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2884, Train Acc: 0.9036 | Val Loss: 0.1241, Val Acc: 0.9611
[Fold 5 Epoch 2/20] Train Loss: 0.0756, Train Acc: 0.9758 | Val Loss: 0.1103, Val Acc: 0.9637
[Fold 5 Epoch 3/20] Train Loss: 0.0408, Train Acc: 0.9866 | Val Loss: 0.1430, Val Acc: 0.9569
[Fold 5 Epoch 4/20] Train Loss: 0.0271, Train Acc: 0.9918 | Val Loss: 0.1117, Val Acc: 0.9677
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9637

[OPTUNA] Trial #12 done. Fold Accuracies: [0.9662411347517731, 0.9679432624113475, 0.9736170212765958, 0.9687943262411347, 0.9636879432624114]. Avg Acc=0.9681

[OPTUNA] Starting Trial #13 with lr=0.000202, weight_decay=0.000899
[OPTUNA] Trial #13: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00020192483808336754, weight_decay=0.000898643385843988
[INFO] >>> Starting fold 1 training (Trial #13) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2695, Train Acc: 0.9065 | Val Loss: 0.1609, Val Acc: 0.9501
[Fold 1 Epoch 2/20] Train Loss: 0.1195, Train Acc: 0.9606 | Val Loss: 0.2009, Val Acc: 0.9401
[Fold 1 Epoch 3/20] Train Loss: 0.0986, Train Acc: 0.9678 | Val Loss: 0.1915, Val Acc: 0.9416
[INFO] Early stopping on fold 1 at epoch 3
[INFO] <<< Finished fold 1, best val acc = 0.9501

[OPTUNA] Trial #13: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00020192483808336754, weight_decay=0.000898643385843988
[INFO] >>> Starting fold 2 training (Trial #13) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2692, Train Acc: 0.9087 | Val Loss: 0.3708, Val Acc: 0.8993
[Fold 2 Epoch 2/20] Train Loss: 0.1314, Train Acc: 0.9554 | Val Loss: 0.2351, Val Acc: 0.9234
[Fold 2 Epoch 3/20] Train Loss: 0.1000, Train Acc: 0.9675 | Val Loss: 0.2447, Val Acc: 0.9262
[Fold 2 Epoch 4/20] Train Loss: 0.0793, Train Acc: 0.9730 | Val Loss: 0.1283, Val Acc: 0.9606
[Fold 2 Epoch 5/20] Train Loss: 0.0759, Train Acc: 0.9760 | Val Loss: 0.0957, Val Acc: 0.9688
[Fold 2 Epoch 6/20] Train Loss: 0.0674, Train Acc: 0.9776 | Val Loss: 0.1447, Val Acc: 0.9532
[Fold 2 Epoch 7/20] Train Loss: 0.0677, Train Acc: 0.9789 | Val Loss: 0.1896, Val Acc: 0.9421
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val acc = 0.9688

[OPTUNA] Trial #13: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00020192483808336754, weight_decay=0.000898643385843988
[INFO] >>> Starting fold 3 training (Trial #13) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2680, Train Acc: 0.9068 | Val Loss: 0.1526, Val Acc: 0.9487
[Fold 3 Epoch 2/20] Train Loss: 0.1183, Train Acc: 0.9611 | Val Loss: 0.1266, Val Acc: 0.9549
[Fold 3 Epoch 3/20] Train Loss: 0.0978, Train Acc: 0.9670 | Val Loss: 0.1118, Val Acc: 0.9637
[Fold 3 Epoch 4/20] Train Loss: 0.0781, Train Acc: 0.9739 | Val Loss: 0.1295, Val Acc: 0.9589
[Fold 3 Epoch 5/20] Train Loss: 0.0775, Train Acc: 0.9750 | Val Loss: 0.1077, Val Acc: 0.9640
[Fold 3 Epoch 6/20] Train Loss: 0.0732, Train Acc: 0.9760 | Val Loss: 0.1441, Val Acc: 0.9549
[Fold 3 Epoch 7/20] Train Loss: 0.0673, Train Acc: 0.9791 | Val Loss: 0.1871, Val Acc: 0.9404
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9640

[OPTUNA] Trial #13: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00020192483808336754, weight_decay=0.000898643385843988
[INFO] >>> Starting fold 4 training (Trial #13) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2529, Train Acc: 0.9137 | Val Loss: 0.1322, Val Acc: 0.9532
[Fold 4 Epoch 2/20] Train Loss: 0.1135, Train Acc: 0.9636 | Val Loss: 0.1811, Val Acc: 0.9424
[Fold 4 Epoch 3/20] Train Loss: 0.0897, Train Acc: 0.9697 | Val Loss: 0.1678, Val Acc: 0.9452
[INFO] Early stopping on fold 4 at epoch 3
[INFO] <<< Finished fold 4, best val acc = 0.9532

[OPTUNA] Trial #13: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00020192483808336754, weight_decay=0.000898643385843988
[INFO] >>> Starting fold 5 training (Trial #13) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2700, Train Acc: 0.9055 | Val Loss: 0.1673, Val Acc: 0.9498
[Fold 5 Epoch 2/20] Train Loss: 0.1182, Train Acc: 0.9601 | Val Loss: 0.1549, Val Acc: 0.9543
[Fold 5 Epoch 3/20] Train Loss: 0.0954, Train Acc: 0.9693 | Val Loss: 0.1141, Val Acc: 0.9665
[Fold 5 Epoch 4/20] Train Loss: 0.0858, Train Acc: 0.9721 | Val Loss: 0.1569, Val Acc: 0.9521
[Fold 5 Epoch 5/20] Train Loss: 0.0723, Train Acc: 0.9770 | Val Loss: 0.1218, Val Acc: 0.9628
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9665

[OPTUNA] Trial #13 done. Fold Accuracies: [0.9500709219858156, 0.9687943262411347, 0.9639716312056738, 0.9531914893617022, 0.9665248226950355]. Avg Acc=0.9605

[OPTUNA] Starting Trial #14 with lr=0.000073, weight_decay=0.000050
[OPTUNA] Trial #14: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=7.291835574193059e-05, weight_decay=4.969799360427908e-05
[INFO] >>> Starting fold 1 training (Trial #14) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2801, Train Acc: 0.9084 | Val Loss: 0.1253, Val Acc: 0.9594
[Fold 1 Epoch 2/20] Train Loss: 0.0770, Train Acc: 0.9745 | Val Loss: 0.0998, Val Acc: 0.9694
[Fold 1 Epoch 3/20] Train Loss: 0.0396, Train Acc: 0.9872 | Val Loss: 0.1112, Val Acc: 0.9640
[Fold 1 Epoch 4/20] Train Loss: 0.0216, Train Acc: 0.9940 | Val Loss: 0.0863, Val Acc: 0.9742
[Fold 1 Epoch 5/20] Train Loss: 0.0262, Train Acc: 0.9920 | Val Loss: 0.0912, Val Acc: 0.9713
[Fold 1 Epoch 6/20] Train Loss: 0.0165, Train Acc: 0.9955 | Val Loss: 0.1580, Val Acc: 0.9620
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9742

[OPTUNA] Trial #14: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=7.291835574193059e-05, weight_decay=4.969799360427908e-05
[INFO] >>> Starting fold 2 training (Trial #14) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2786, Train Acc: 0.9074 | Val Loss: 0.1211, Val Acc: 0.9609
[Fold 2 Epoch 2/20] Train Loss: 0.0727, Train Acc: 0.9772 | Val Loss: 0.1024, Val Acc: 0.9651
[Fold 2 Epoch 3/20] Train Loss: 0.0423, Train Acc: 0.9865 | Val Loss: 0.0974, Val Acc: 0.9682
[Fold 2 Epoch 4/20] Train Loss: 0.0286, Train Acc: 0.9906 | Val Loss: 0.0876, Val Acc: 0.9736
[Fold 2 Epoch 5/20] Train Loss: 0.0209, Train Acc: 0.9934 | Val Loss: 0.0833, Val Acc: 0.9762
[Fold 2 Epoch 6/20] Train Loss: 0.0151, Train Acc: 0.9950 | Val Loss: 0.0725, Val Acc: 0.9756
[Fold 2 Epoch 7/20] Train Loss: 0.0120, Train Acc: 0.9968 | Val Loss: 0.1736, Val Acc: 0.9574
[Fold 2 Epoch 8/20] Train Loss: 0.0267, Train Acc: 0.9921 | Val Loss: 0.1073, Val Acc: 0.9691
[INFO] Early stopping on fold 2 at epoch 8
[INFO] <<< Finished fold 2, best val acc = 0.9762

[OPTUNA] Trial #14: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=7.291835574193059e-05, weight_decay=4.969799360427908e-05
[INFO] >>> Starting fold 3 training (Trial #14) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2878, Train Acc: 0.9048 | Val Loss: 0.1249, Val Acc: 0.9600
[Fold 3 Epoch 2/20] Train Loss: 0.0762, Train Acc: 0.9762 | Val Loss: 0.1141, Val Acc: 0.9617
[Fold 3 Epoch 3/20] Train Loss: 0.0394, Train Acc: 0.9878 | Val Loss: 0.1031, Val Acc: 0.9668
[Fold 3 Epoch 4/20] Train Loss: 0.0253, Train Acc: 0.9923 | Val Loss: 0.0979, Val Acc: 0.9699
[Fold 3 Epoch 5/20] Train Loss: 0.0171, Train Acc: 0.9948 | Val Loss: 0.1078, Val Acc: 0.9682
[Fold 3 Epoch 6/20] Train Loss: 0.0229, Train Acc: 0.9924 | Val Loss: 0.0813, Val Acc: 0.9745
[Fold 3 Epoch 7/20] Train Loss: 0.0141, Train Acc: 0.9955 | Val Loss: 0.1001, Val Acc: 0.9677
[Fold 3 Epoch 8/20] Train Loss: 0.0157, Train Acc: 0.9954 | Val Loss: 0.0775, Val Acc: 0.9787
[Fold 3 Epoch 9/20] Train Loss: 0.0057, Train Acc: 0.9987 | Val Loss: 0.0863, Val Acc: 0.9736
[Fold 3 Epoch 10/20] Train Loss: 0.0148, Train Acc: 0.9963 | Val Loss: 0.1067, Val Acc: 0.9665
[INFO] Early stopping on fold 3 at epoch 10
[INFO] <<< Finished fold 3, best val acc = 0.9787

[OPTUNA] Trial #14: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=7.291835574193059e-05, weight_decay=4.969799360427908e-05
[INFO] >>> Starting fold 4 training (Trial #14) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2840, Train Acc: 0.9060 | Val Loss: 0.1351, Val Acc: 0.9543
[Fold 4 Epoch 2/20] Train Loss: 0.0782, Train Acc: 0.9750 | Val Loss: 0.1108, Val Acc: 0.9626
[Fold 4 Epoch 3/20] Train Loss: 0.0359, Train Acc: 0.9897 | Val Loss: 0.1273, Val Acc: 0.9611
[Fold 4 Epoch 4/20] Train Loss: 0.0265, Train Acc: 0.9925 | Val Loss: 0.1291, Val Acc: 0.9611
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9626

[OPTUNA] Trial #14: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=7.291835574193059e-05, weight_decay=4.969799360427908e-05
[INFO] >>> Starting fold 5 training (Trial #14) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2879, Train Acc: 0.9023 | Val Loss: 0.1133, Val Acc: 0.9623
[Fold 5 Epoch 2/20] Train Loss: 0.0703, Train Acc: 0.9765 | Val Loss: 0.0966, Val Acc: 0.9696
[Fold 5 Epoch 3/20] Train Loss: 0.0394, Train Acc: 0.9876 | Val Loss: 0.1141, Val Acc: 0.9631
[Fold 5 Epoch 4/20] Train Loss: 0.0251, Train Acc: 0.9924 | Val Loss: 0.1339, Val Acc: 0.9577
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9696

[OPTUNA] Trial #14 done. Fold Accuracies: [0.9741843971631206, 0.9761702127659575, 0.9787234042553191, 0.9625531914893617, 0.969645390070922]. Avg Acc=0.9723

[OPTUNA] Starting Trial #15 with lr=0.000031, weight_decay=0.000001
[OPTUNA] Trial #15: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=3.0522302708591426e-05, weight_decay=1.0085334798770266e-06
[INFO] >>> Starting fold 1 training (Trial #15) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.4047, Train Acc: 0.8713 | Val Loss: 0.1438, Val Acc: 0.9549
[Fold 1 Epoch 2/20] Train Loss: 0.0874, Train Acc: 0.9731 | Val Loss: 0.1237, Val Acc: 0.9648
[Fold 1 Epoch 3/20] Train Loss: 0.0358, Train Acc: 0.9910 | Val Loss: 0.1068, Val Acc: 0.9699
[Fold 1 Epoch 4/20] Train Loss: 0.0172, Train Acc: 0.9954 | Val Loss: 0.1257, Val Acc: 0.9660
[Fold 1 Epoch 5/20] Train Loss: 0.0094, Train Acc: 0.9984 | Val Loss: 0.1105, Val Acc: 0.9696
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9699

[OPTUNA] Trial #15: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=3.0522302708591426e-05, weight_decay=1.0085334798770266e-06
[INFO] >>> Starting fold 2 training (Trial #15) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.4072, Train Acc: 0.8680 | Val Loss: 0.1363, Val Acc: 0.9569
[Fold 2 Epoch 2/20] Train Loss: 0.0899, Train Acc: 0.9718 | Val Loss: 0.1029, Val Acc: 0.9679
[Fold 2 Epoch 3/20] Train Loss: 0.0341, Train Acc: 0.9911 | Val Loss: 0.0943, Val Acc: 0.9728
[Fold 2 Epoch 4/20] Train Loss: 0.0198, Train Acc: 0.9952 | Val Loss: 0.0931, Val Acc: 0.9654
[Fold 2 Epoch 5/20] Train Loss: 0.0095, Train Acc: 0.9982 | Val Loss: 0.0875, Val Acc: 0.9705
[Fold 2 Epoch 6/20] Train Loss: 0.0069, Train Acc: 0.9988 | Val Loss: 0.0888, Val Acc: 0.9702
[Fold 2 Epoch 7/20] Train Loss: 0.0056, Train Acc: 0.9988 | Val Loss: 0.1147, Val Acc: 0.9685
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val acc = 0.9728

[OPTUNA] Trial #15: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=3.0522302708591426e-05, weight_decay=1.0085334798770266e-06
[INFO] >>> Starting fold 3 training (Trial #15) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.4178, Train Acc: 0.8657 | Val Loss: 0.1399, Val Acc: 0.9569
[Fold 3 Epoch 2/20] Train Loss: 0.0911, Train Acc: 0.9720 | Val Loss: 0.0956, Val Acc: 0.9660
[Fold 3 Epoch 3/20] Train Loss: 0.0292, Train Acc: 0.9930 | Val Loss: 0.0971, Val Acc: 0.9696
[Fold 3 Epoch 4/20] Train Loss: 0.0162, Train Acc: 0.9965 | Val Loss: 0.1111, Val Acc: 0.9694
[INFO] Early stopping on fold 3 at epoch 4
[INFO] <<< Finished fold 3, best val acc = 0.9696

[OPTUNA] Trial #15: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=3.0522302708591426e-05, weight_decay=1.0085334798770266e-06
[INFO] >>> Starting fold 4 training (Trial #15) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3850, Train Acc: 0.8746 | Val Loss: 0.1337, Val Acc: 0.9597
[Fold 4 Epoch 2/20] Train Loss: 0.0821, Train Acc: 0.9738 | Val Loss: 0.1274, Val Acc: 0.9606
[Fold 4 Epoch 3/20] Train Loss: 0.0329, Train Acc: 0.9908 | Val Loss: 0.1064, Val Acc: 0.9651
[Fold 4 Epoch 4/20] Train Loss: 0.0173, Train Acc: 0.9964 | Val Loss: 0.1089, Val Acc: 0.9637
[Fold 4 Epoch 5/20] Train Loss: 0.0100, Train Acc: 0.9977 | Val Loss: 0.1382, Val Acc: 0.9603
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9651

[OPTUNA] Trial #15: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=3.0522302708591426e-05, weight_decay=1.0085334798770266e-06
[INFO] >>> Starting fold 5 training (Trial #15) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.4060, Train Acc: 0.8679 | Val Loss: 0.1249, Val Acc: 0.9589
[Fold 5 Epoch 2/20] Train Loss: 0.0873, Train Acc: 0.9726 | Val Loss: 0.0982, Val Acc: 0.9691
[Fold 5 Epoch 3/20] Train Loss: 0.0309, Train Acc: 0.9926 | Val Loss: 0.1007, Val Acc: 0.9668
[Fold 5 Epoch 4/20] Train Loss: 0.0173, Train Acc: 0.9958 | Val Loss: 0.0886, Val Acc: 0.9711
[Fold 5 Epoch 5/20] Train Loss: 0.0084, Train Acc: 0.9987 | Val Loss: 0.1080, Val Acc: 0.9685
[Fold 5 Epoch 6/20] Train Loss: 0.0085, Train Acc: 0.9977 | Val Loss: 0.1087, Val Acc: 0.9679
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9711

[OPTUNA] Trial #15 done. Fold Accuracies: [0.9699290780141844, 0.9727659574468085, 0.969645390070922, 0.9651063829787234, 0.971063829787234]. Avg Acc=0.9697

[OPTUNA] Starting Trial #16 with lr=0.000012, weight_decay=0.000007
[OPTUNA] Trial #16: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=1.2207865798266472e-05, weight_decay=6.589313753931004e-06
[INFO] >>> Starting fold 1 training (Trial #16) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.6375, Train Acc: 0.8079 | Val Loss: 0.2625, Val Acc: 0.9152
[Fold 1 Epoch 2/20] Train Loss: 0.1803, Train Acc: 0.9438 | Val Loss: 0.1395, Val Acc: 0.9572
[Fold 1 Epoch 3/20] Train Loss: 0.0735, Train Acc: 0.9821 | Val Loss: 0.1034, Val Acc: 0.9648
[Fold 1 Epoch 4/20] Train Loss: 0.0349, Train Acc: 0.9933 | Val Loss: 0.1063, Val Acc: 0.9679
[Fold 1 Epoch 5/20] Train Loss: 0.0165, Train Acc: 0.9979 | Val Loss: 0.0942, Val Acc: 0.9654
[Fold 1 Epoch 6/20] Train Loss: 0.0110, Train Acc: 0.9989 | Val Loss: 0.0942, Val Acc: 0.9688
[Fold 1 Epoch 7/20] Train Loss: 0.0069, Train Acc: 0.9996 | Val Loss: 0.1188, Val Acc: 0.9662
[Fold 1 Epoch 8/20] Train Loss: 0.0064, Train Acc: 0.9992 | Val Loss: 0.1068, Val Acc: 0.9654
[INFO] Early stopping on fold 1 at epoch 8
[INFO] <<< Finished fold 1, best val acc = 0.9688

[OPTUNA] Trial #16: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=1.2207865798266472e-05, weight_decay=6.589313753931004e-06
[INFO] >>> Starting fold 2 training (Trial #16) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.6504, Train Acc: 0.7981 | Val Loss: 0.2773, Val Acc: 0.9087
[Fold 2 Epoch 2/20] Train Loss: 0.1912, Train Acc: 0.9407 | Val Loss: 0.1357, Val Acc: 0.9569
[Fold 2 Epoch 3/20] Train Loss: 0.0821, Train Acc: 0.9788 | Val Loss: 0.1154, Val Acc: 0.9606
[Fold 2 Epoch 4/20] Train Loss: 0.0337, Train Acc: 0.9949 | Val Loss: 0.1051, Val Acc: 0.9665
[Fold 2 Epoch 5/20] Train Loss: 0.0160, Train Acc: 0.9986 | Val Loss: 0.0978, Val Acc: 0.9662
[Fold 2 Epoch 6/20] Train Loss: 0.0126, Train Acc: 0.9982 | Val Loss: 0.0956, Val Acc: 0.9660
[Fold 2 Epoch 7/20] Train Loss: 0.0069, Train Acc: 0.9996 | Val Loss: 0.0976, Val Acc: 0.9682
[Fold 2 Epoch 8/20] Train Loss: 0.0050, Train Acc: 0.9995 | Val Loss: 0.0992, Val Acc: 0.9660
[INFO] Early stopping on fold 2 at epoch 8
[INFO] <<< Finished fold 2, best val acc = 0.9682

[OPTUNA] Trial #16: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=1.2207865798266472e-05, weight_decay=6.589313753931004e-06
[INFO] >>> Starting fold 3 training (Trial #16) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.6314, Train Acc: 0.8079 | Val Loss: 0.2760, Val Acc: 0.9146
[Fold 3 Epoch 2/20] Train Loss: 0.1842, Train Acc: 0.9452 | Val Loss: 0.1291, Val Acc: 0.9580
[Fold 3 Epoch 3/20] Train Loss: 0.0759, Train Acc: 0.9803 | Val Loss: 0.1065, Val Acc: 0.9634
[Fold 3 Epoch 4/20] Train Loss: 0.0331, Train Acc: 0.9938 | Val Loss: 0.1006, Val Acc: 0.9651
[Fold 3 Epoch 5/20] Train Loss: 0.0178, Train Acc: 0.9977 | Val Loss: 0.0970, Val Acc: 0.9674
[Fold 3 Epoch 6/20] Train Loss: 0.0112, Train Acc: 0.9985 | Val Loss: 0.1028, Val Acc: 0.9654
[Fold 3 Epoch 7/20] Train Loss: 0.0066, Train Acc: 0.9997 | Val Loss: 0.1054, Val Acc: 0.9654
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9674

[OPTUNA] Trial #16: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=1.2207865798266472e-05, weight_decay=6.589313753931004e-06
[INFO] >>> Starting fold 4 training (Trial #16) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.6299, Train Acc: 0.8126 | Val Loss: 0.2807, Val Acc: 0.9098
[Fold 4 Epoch 2/20] Train Loss: 0.1771, Train Acc: 0.9459 | Val Loss: 0.1384, Val Acc: 0.9569
[Fold 4 Epoch 3/20] Train Loss: 0.0717, Train Acc: 0.9821 | Val Loss: 0.1126, Val Acc: 0.9651
[Fold 4 Epoch 4/20] Train Loss: 0.0328, Train Acc: 0.9935 | Val Loss: 0.1257, Val Acc: 0.9606
[Fold 4 Epoch 5/20] Train Loss: 0.0174, Train Acc: 0.9974 | Val Loss: 0.1129, Val Acc: 0.9628
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9651

[OPTUNA] Trial #16: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=1.2207865798266472e-05, weight_decay=6.589313753931004e-06
[INFO] >>> Starting fold 5 training (Trial #16) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.6384, Train Acc: 0.8009 | Val Loss: 0.2872, Val Acc: 0.9101
[Fold 5 Epoch 2/20] Train Loss: 0.1906, Train Acc: 0.9400 | Val Loss: 0.1473, Val Acc: 0.9543
[Fold 5 Epoch 3/20] Train Loss: 0.0755, Train Acc: 0.9809 | Val Loss: 0.1197, Val Acc: 0.9589
[Fold 5 Epoch 4/20] Train Loss: 0.0351, Train Acc: 0.9923 | Val Loss: 0.1197, Val Acc: 0.9603
[Fold 5 Epoch 5/20] Train Loss: 0.0169, Train Acc: 0.9974 | Val Loss: 0.1158, Val Acc: 0.9640
[Fold 5 Epoch 6/20] Train Loss: 0.0126, Train Acc: 0.9984 | Val Loss: 0.1256, Val Acc: 0.9611
[Fold 5 Epoch 7/20] Train Loss: 0.0070, Train Acc: 0.9994 | Val Loss: 0.1248, Val Acc: 0.9634
[INFO] Early stopping on fold 5 at epoch 7
[INFO] <<< Finished fold 5, best val acc = 0.9640

[OPTUNA] Trial #16 done. Fold Accuracies: [0.9687943262411347, 0.9682269503546099, 0.9673758865248226, 0.9651063829787234, 0.9639716312056738]. Avg Acc=0.9667

[OPTUNA] Starting Trial #17 with lr=0.000058, weight_decay=0.000050
[OPTUNA] Trial #17: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=5.777727880167612e-05, weight_decay=5.023747049622391e-05
[INFO] >>> Starting fold 1 training (Trial #17) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3133, Train Acc: 0.8998 | Val Loss: 0.1304, Val Acc: 0.9597
[Fold 1 Epoch 2/20] Train Loss: 0.0828, Train Acc: 0.9730 | Val Loss: 0.0964, Val Acc: 0.9677
[Fold 1 Epoch 3/20] Train Loss: 0.0371, Train Acc: 0.9882 | Val Loss: 0.1110, Val Acc: 0.9694
[Fold 1 Epoch 4/20] Train Loss: 0.0232, Train Acc: 0.9933 | Val Loss: 0.0916, Val Acc: 0.9713
[Fold 1 Epoch 5/20] Train Loss: 0.0180, Train Acc: 0.9945 | Val Loss: 0.1144, Val Acc: 0.9694
[Fold 1 Epoch 6/20] Train Loss: 0.0214, Train Acc: 0.9943 | Val Loss: 0.1292, Val Acc: 0.9696
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9713

[OPTUNA] Trial #17: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=5.777727880167612e-05, weight_decay=5.023747049622391e-05
[INFO] >>> Starting fold 2 training (Trial #17) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3063, Train Acc: 0.8983 | Val Loss: 0.1116, Val Acc: 0.9645
[Fold 2 Epoch 2/20] Train Loss: 0.0777, Train Acc: 0.9750 | Val Loss: 0.0934, Val Acc: 0.9677
[Fold 2 Epoch 3/20] Train Loss: 0.0329, Train Acc: 0.9896 | Val Loss: 0.0916, Val Acc: 0.9705
[Fold 2 Epoch 4/20] Train Loss: 0.0271, Train Acc: 0.9909 | Val Loss: 0.1089, Val Acc: 0.9600
[Fold 2 Epoch 5/20] Train Loss: 0.0150, Train Acc: 0.9959 | Val Loss: 0.0812, Val Acc: 0.9753
[Fold 2 Epoch 6/20] Train Loss: 0.0086, Train Acc: 0.9973 | Val Loss: 0.1276, Val Acc: 0.9657
[Fold 2 Epoch 7/20] Train Loss: 0.0198, Train Acc: 0.9943 | Val Loss: 0.1530, Val Acc: 0.9611
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val acc = 0.9753

[OPTUNA] Trial #17: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=5.777727880167612e-05, weight_decay=5.023747049622391e-05
[INFO] >>> Starting fold 3 training (Trial #17) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3040, Train Acc: 0.9020 | Val Loss: 0.1438, Val Acc: 0.9589
[Fold 3 Epoch 2/20] Train Loss: 0.0787, Train Acc: 0.9747 | Val Loss: 0.0942, Val Acc: 0.9651
[Fold 3 Epoch 3/20] Train Loss: 0.0347, Train Acc: 0.9892 | Val Loss: 0.0882, Val Acc: 0.9682
[Fold 3 Epoch 4/20] Train Loss: 0.0278, Train Acc: 0.9918 | Val Loss: 0.0726, Val Acc: 0.9762
[Fold 3 Epoch 5/20] Train Loss: 0.0084, Train Acc: 0.9981 | Val Loss: 0.0923, Val Acc: 0.9725
[Fold 3 Epoch 6/20] Train Loss: 0.0226, Train Acc: 0.9940 | Val Loss: 0.0821, Val Acc: 0.9730
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val acc = 0.9762

[OPTUNA] Trial #17: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=5.777727880167612e-05, weight_decay=5.023747049622391e-05
[INFO] >>> Starting fold 4 training (Trial #17) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2999, Train Acc: 0.9005 | Val Loss: 0.1213, Val Acc: 0.9609
[Fold 4 Epoch 2/20] Train Loss: 0.0693, Train Acc: 0.9774 | Val Loss: 0.1553, Val Acc: 0.9557
[Fold 4 Epoch 3/20] Train Loss: 0.0376, Train Acc: 0.9884 | Val Loss: 0.0996, Val Acc: 0.9648
[Fold 4 Epoch 4/20] Train Loss: 0.0241, Train Acc: 0.9935 | Val Loss: 0.1288, Val Acc: 0.9631
[Fold 4 Epoch 5/20] Train Loss: 0.0186, Train Acc: 0.9943 | Val Loss: 0.1188, Val Acc: 0.9660
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9648

[OPTUNA] Trial #17: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=5.777727880167612e-05, weight_decay=5.023747049622391e-05
[INFO] >>> Starting fold 5 training (Trial #17) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.3098, Train Acc: 0.8992 | Val Loss: 0.1687, Val Acc: 0.9410
[Fold 5 Epoch 2/20] Train Loss: 0.0711, Train Acc: 0.9775 | Val Loss: 0.1117, Val Acc: 0.9733
[Fold 5 Epoch 3/20] Train Loss: 0.0330, Train Acc: 0.9896 | Val Loss: 0.1134, Val Acc: 0.9688
[Fold 5 Epoch 4/20] Train Loss: 0.0212, Train Acc: 0.9935 | Val Loss: 0.0876, Val Acc: 0.9733
[Fold 5 Epoch 5/20] Train Loss: 0.0160, Train Acc: 0.9955 | Val Loss: 0.1065, Val Acc: 0.9691
[Fold 5 Epoch 6/20] Train Loss: 0.0162, Train Acc: 0.9953 | Val Loss: 0.1263, Val Acc: 0.9660
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9733

[OPTUNA] Trial #17 done. Fold Accuracies: [0.9713475177304964, 0.9753191489361702, 0.9761702127659575, 0.964822695035461, 0.9733333333333334]. Avg Acc=0.9722

[OPTUNA] Starting Trial #18 with lr=0.000182, weight_decay=0.000011
[OPTUNA] Trial #18: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00018163862233148243, weight_decay=1.1233854498485364e-05
[INFO] >>> Starting fold 1 training (Trial #18) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2525, Train Acc: 0.9143 | Val Loss: 0.1785, Val Acc: 0.9404
[Fold 1 Epoch 2/20] Train Loss: 0.1000, Train Acc: 0.9648 | Val Loss: 0.1320, Val Acc: 0.9617
[Fold 1 Epoch 3/20] Train Loss: 0.0729, Train Acc: 0.9757 | Val Loss: 0.2707, Val Acc: 0.9387
[Fold 1 Epoch 4/20] Train Loss: 0.0585, Train Acc: 0.9810 | Val Loss: 0.1047, Val Acc: 0.9645
[Fold 1 Epoch 5/20] Train Loss: 0.0351, Train Acc: 0.9888 | Val Loss: 0.1145, Val Acc: 0.9699
[Fold 1 Epoch 6/20] Train Loss: 0.0318, Train Acc: 0.9898 | Val Loss: 0.1066, Val Acc: 0.9708
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9699

[OPTUNA] Trial #18: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00018163862233148243, weight_decay=1.1233854498485364e-05
[INFO] >>> Starting fold 2 training (Trial #18) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2485, Train Acc: 0.9134 | Val Loss: 0.2406, Val Acc: 0.9356
[Fold 2 Epoch 2/20] Train Loss: 0.1025, Train Acc: 0.9649 | Val Loss: 0.1197, Val Acc: 0.9609
[Fold 2 Epoch 3/20] Train Loss: 0.0673, Train Acc: 0.9778 | Val Loss: 0.0919, Val Acc: 0.9688
[Fold 2 Epoch 4/20] Train Loss: 0.0466, Train Acc: 0.9838 | Val Loss: 0.1103, Val Acc: 0.9651
[Fold 2 Epoch 5/20] Train Loss: 0.0402, Train Acc: 0.9855 | Val Loss: 0.1199, Val Acc: 0.9668
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9688

[OPTUNA] Trial #18: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00018163862233148243, weight_decay=1.1233854498485364e-05
[INFO] >>> Starting fold 3 training (Trial #18) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2563, Train Acc: 0.9110 | Val Loss: 0.1397, Val Acc: 0.9580
[Fold 3 Epoch 2/20] Train Loss: 0.1045, Train Acc: 0.9645 | Val Loss: 0.0994, Val Acc: 0.9688
[Fold 3 Epoch 3/20] Train Loss: 0.0752, Train Acc: 0.9757 | Val Loss: 0.1048, Val Acc: 0.9674
[Fold 3 Epoch 4/20] Train Loss: 0.0499, Train Acc: 0.9843 | Val Loss: 0.0930, Val Acc: 0.9711
[Fold 3 Epoch 5/20] Train Loss: 0.0343, Train Acc: 0.9892 | Val Loss: 0.2088, Val Acc: 0.9382
[Fold 3 Epoch 6/20] Train Loss: 0.0385, Train Acc: 0.9870 | Val Loss: 0.0967, Val Acc: 0.9688
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val acc = 0.9711

[OPTUNA] Trial #18: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00018163862233148243, weight_decay=1.1233854498485364e-05
[INFO] >>> Starting fold 4 training (Trial #18) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2538, Train Acc: 0.9135 | Val Loss: 0.1242, Val Acc: 0.9614
[Fold 4 Epoch 2/20] Train Loss: 0.0967, Train Acc: 0.9665 | Val Loss: 0.1255, Val Acc: 0.9552
[Fold 4 Epoch 3/20] Train Loss: 0.0710, Train Acc: 0.9763 | Val Loss: 0.1286, Val Acc: 0.9614
[INFO] Early stopping on fold 4 at epoch 3
[INFO] <<< Finished fold 4, best val acc = 0.9614

[OPTUNA] Trial #18: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00018163862233148243, weight_decay=1.1233854498485364e-05
[INFO] >>> Starting fold 5 training (Trial #18) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2625, Train Acc: 0.9099 | Val Loss: 0.1603, Val Acc: 0.9455
[Fold 5 Epoch 2/20] Train Loss: 0.1038, Train Acc: 0.9657 | Val Loss: 0.1259, Val Acc: 0.9597
[Fold 5 Epoch 3/20] Train Loss: 0.0677, Train Acc: 0.9772 | Val Loss: 0.1361, Val Acc: 0.9594
[Fold 5 Epoch 4/20] Train Loss: 0.0447, Train Acc: 0.9848 | Val Loss: 0.0923, Val Acc: 0.9725
[Fold 5 Epoch 5/20] Train Loss: 0.0362, Train Acc: 0.9891 | Val Loss: 0.1416, Val Acc: 0.9580
[Fold 5 Epoch 6/20] Train Loss: 0.0392, Train Acc: 0.9886 | Val Loss: 0.0993, Val Acc: 0.9699
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9725

[OPTUNA] Trial #18 done. Fold Accuracies: [0.9699290780141844, 0.9687943262411347, 0.971063829787234, 0.961418439716312, 0.9724822695035461]. Avg Acc=0.9687

[OPTUNA] Starting Trial #19 with lr=0.000479, weight_decay=0.000114
[OPTUNA] Trial #19: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00047939488903116613, weight_decay=0.00011360451993706731
[INFO] >>> Starting fold 1 training (Trial #19) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3081, Train Acc: 0.8917 | Val Loss: 0.2200, Val Acc: 0.9407
[Fold 1 Epoch 2/20] Train Loss: 0.1662, Train Acc: 0.9434 | Val Loss: 0.1712, Val Acc: 0.9472
[Fold 1 Epoch 3/20] Train Loss: 0.1307, Train Acc: 0.9568 | Val Loss: 0.1631, Val Acc: 0.9444
[Fold 1 Epoch 4/20] Train Loss: 0.1004, Train Acc: 0.9673 | Val Loss: 0.1252, Val Acc: 0.9611
[Fold 1 Epoch 5/20] Train Loss: 0.0928, Train Acc: 0.9687 | Val Loss: 0.1227, Val Acc: 0.9648
[Fold 1 Epoch 6/20] Train Loss: 0.0749, Train Acc: 0.9756 | Val Loss: 0.1743, Val Acc: 0.9498
[Fold 1 Epoch 7/20] Train Loss: 0.0776, Train Acc: 0.9732 | Val Loss: 0.0970, Val Acc: 0.9694
[Fold 1 Epoch 8/20] Train Loss: 0.0592, Train Acc: 0.9813 | Val Loss: 0.1929, Val Acc: 0.9458
[Fold 1 Epoch 9/20] Train Loss: 0.0469, Train Acc: 0.9838 | Val Loss: 0.1460, Val Acc: 0.9626
[INFO] Early stopping on fold 1 at epoch 9
[INFO] <<< Finished fold 1, best val acc = 0.9694

[OPTUNA] Trial #19: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00047939488903116613, weight_decay=0.00011360451993706731
[INFO] >>> Starting fold 2 training (Trial #19) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3032, Train Acc: 0.8933 | Val Loss: 0.2138, Val Acc: 0.9302
[Fold 2 Epoch 2/20] Train Loss: 0.1524, Train Acc: 0.9482 | Val Loss: 0.1919, Val Acc: 0.9365
[Fold 2 Epoch 3/20] Train Loss: 0.1223, Train Acc: 0.9588 | Val Loss: 0.1060, Val Acc: 0.9671
[Fold 2 Epoch 4/20] Train Loss: 0.1028, Train Acc: 0.9654 | Val Loss: 0.1299, Val Acc: 0.9563
[Fold 2 Epoch 5/20] Train Loss: 0.0891, Train Acc: 0.9714 | Val Loss: 0.1963, Val Acc: 0.9418
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9671

[OPTUNA] Trial #19: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00047939488903116613, weight_decay=0.00011360451993706731
[INFO] >>> Starting fold 3 training (Trial #19) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3183, Train Acc: 0.8908 | Val Loss: 0.3427, Val Acc: 0.8806
[Fold 3 Epoch 2/20] Train Loss: 0.1548, Train Acc: 0.9472 | Val Loss: 0.1983, Val Acc: 0.9302
[Fold 3 Epoch 3/20] Train Loss: 0.1147, Train Acc: 0.9626 | Val Loss: 0.0968, Val Acc: 0.9694
[Fold 3 Epoch 4/20] Train Loss: 0.1036, Train Acc: 0.9644 | Val Loss: 0.1434, Val Acc: 0.9535
[Fold 3 Epoch 5/20] Train Loss: 0.0974, Train Acc: 0.9668 | Val Loss: 0.2258, Val Acc: 0.9348
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9694

[OPTUNA] Trial #19: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00047939488903116613, weight_decay=0.00011360451993706731
[INFO] >>> Starting fold 4 training (Trial #19) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2988, Train Acc: 0.8945 | Val Loss: 0.2247, Val Acc: 0.9143
[Fold 4 Epoch 2/20] Train Loss: 0.1595, Train Acc: 0.9458 | Val Loss: 0.1950, Val Acc: 0.9404
[Fold 4 Epoch 3/20] Train Loss: 0.1252, Train Acc: 0.9577 | Val Loss: 0.1361, Val Acc: 0.9526
[Fold 4 Epoch 4/20] Train Loss: 0.0998, Train Acc: 0.9667 | Val Loss: 0.1725, Val Acc: 0.9481
[Fold 4 Epoch 5/20] Train Loss: 0.0799, Train Acc: 0.9739 | Val Loss: 0.1279, Val Acc: 0.9580
[Fold 4 Epoch 6/20] Train Loss: 0.0815, Train Acc: 0.9720 | Val Loss: 0.2040, Val Acc: 0.9410
[Fold 4 Epoch 7/20] Train Loss: 0.0742, Train Acc: 0.9753 | Val Loss: 0.1604, Val Acc: 0.9521
[INFO] Early stopping on fold 4 at epoch 7
[INFO] <<< Finished fold 4, best val acc = 0.9580

[OPTUNA] Trial #19: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00047939488903116613, weight_decay=0.00011360451993706731
[INFO] >>> Starting fold 5 training (Trial #19) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2865, Train Acc: 0.9004 | Val Loss: 0.2665, Val Acc: 0.9129
[Fold 5 Epoch 2/20] Train Loss: 0.1678, Train Acc: 0.9429 | Val Loss: 0.1949, Val Acc: 0.9313
[Fold 5 Epoch 3/20] Train Loss: 0.1167, Train Acc: 0.9605 | Val Loss: 0.1345, Val Acc: 0.9560
[Fold 5 Epoch 4/20] Train Loss: 0.0926, Train Acc: 0.9696 | Val Loss: 0.1319, Val Acc: 0.9577
[Fold 5 Epoch 5/20] Train Loss: 0.0805, Train Acc: 0.9739 | Val Loss: 0.1651, Val Acc: 0.9489
[Fold 5 Epoch 6/20] Train Loss: 0.0898, Train Acc: 0.9713 | Val Loss: 0.1904, Val Acc: 0.9376
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9577

[OPTUNA] Trial #19 done. Fold Accuracies: [0.9693617021276596, 0.9670921985815603, 0.9693617021276596, 0.9580141843971631, 0.9577304964539007]. Avg Acc=0.9643
[OPTUNA] Best trial found:
  Trial number: 14
  Avg k-fold acc: 0.9723
    lr: 7.291835574193059e-05
    weight_decay: 4.969799360427908e-05

[INFO] Retraining final model on entire training set using best hyperparams...
[DEBUG] Creating ResNet50 with lr=7.291835574193059e-05, weight_decay=4.969799360427908e-05
[Final Train] Epoch 1/5 - Loss: 0.2571, Acc: 0.9136
[Final Train] Epoch 2/5 - Loss: 0.0693, Acc: 0.9768
[Final Train] Epoch 3/5 - Loss: 0.0345, Acc: 0.9888
[Final Train] Epoch 4/5 - Loss: 0.0248, Acc: 0.9930
[Final Train] Epoch 5/5 - Loss: 0.0200, Acc: 0.9943

[INFO] Evaluating final model on test set...
[RESULT] Final Test Accuracy: 0.7624

[RESULT] Classification Report:
              precision    recall  f1-score   support

      Center       0.79      0.75      0.77       832
       Donut       0.52      0.75      0.62       146
    Edge-Loc       0.72      0.89      0.80      2772
   Edge-Ring       0.92      0.77      0.84      1126
         Loc       0.77      0.61      0.68      1973
   Near-full       0.64      0.99      0.78        95
      Random       0.75      0.61      0.68       257
     Scratch       0.81      0.72      0.76       693

    accuracy                           0.76      7894
   macro avg       0.74      0.76      0.74      7894
weighted avg       0.77      0.76      0.76      7894


[INFO] Done. Logs are successfully stored in TensorBoard and the Optuna dashboard.
