PYTHONPATH=~/tmp/miniconda3/envs/MaProject/bin/python:
[I 2025-03-06 23:29:51,555] A new study created in RDB with name: resnet_wafer_1741300185
[I 2025-03-06 23:57:25,662] Trial 0 finished with value: 0.9636312056737589 and parameters: {'lr': 0.0003284236900991354, 'weight_decay': 1.7828139990609243e-06}. Best is trial 0 with value: 0.9636312056737589.
[I 2025-03-07 00:31:48,394] Trial 1 finished with value: 0.9691914893617021 and parameters: {'lr': 0.0002451742487816269, 'weight_decay': 4.538068041410125e-06}. Best is trial 1 with value: 0.9691914893617021.
[I 2025-03-07 01:00:19,117] Trial 2 finished with value: 0.9608510638297872 and parameters: {'lr': 0.0003365084346659179, 'weight_decay': 0.0003241097287711684}. Best is trial 1 with value: 0.9691914893617021.
[I 2025-03-07 01:35:01,336] Trial 3 finished with value: 0.9642553191489363 and parameters: {'lr': 1.2354025132668715e-05, 'weight_decay': 0.00012996121373752098}. Best is trial 1 with value: 0.9691914893617021.
[I 2025-03-07 01:58:29,257] Trial 4 finished with value: 0.909276595744681 and parameters: {'lr': 0.0003965065351678924, 'weight_decay': 0.003877094634607357}. Best is trial 1 with value: 0.9691914893617021.
[I 2025-03-07 02:34:59,068] Trial 5 finished with value: 0.9656170212765958 and parameters: {'lr': 1.2264688060837229e-05, 'weight_decay': 4.378273658892025e-05}. Best is trial 1 with value: 0.9691914893617021.
[I 2025-03-07 03:11:29,857] Trial 6 finished with value: 0.9674893617021277 and parameters: {'lr': 1.4720289540812558e-05, 'weight_decay': 0.0010554490854004582}. Best is trial 1 with value: 0.9691914893617021.
[I 2025-03-07 03:38:59,179] Trial 7 finished with value: 0.9685673758865248 and parameters: {'lr': 2.3907724875562525e-05, 'weight_decay': 0.002122986310370257}. Best is trial 1 with value: 0.9691914893617021.
[I 2025-03-07 04:22:24,591] Trial 8 pruned. 
[I 2025-03-07 04:47:49,294] Trial 9 pruned. 
[I 2025-03-07 05:19:14,330] Trial 10 finished with value: 0.9762269503546099 and parameters: {'lr': 6.057439180345781e-05, 'weight_decay': 1.56173875751773e-06}. Best is trial 10 with value: 0.9762269503546099.
[I 2025-03-07 05:43:39,857] Trial 11 finished with value: 0.9699858156028369 and parameters: {'lr': 5.3813433710895914e-05, 'weight_decay': 1.0591035575312295e-06}. Best is trial 10 with value: 0.9762269503546099.
[I 2025-03-07 06:09:20,803] Trial 12 finished with value: 0.9721985815602837 and parameters: {'lr': 4.965355551902275e-05, 'weight_decay': 1.1612263482444233e-05}. Best is trial 10 with value: 0.9762269503546099.
[I 2025-03-07 06:34:58,441] Trial 13 finished with value: 0.9736170212765958 and parameters: {'lr': 6.025974579576775e-05, 'weight_decay': 1.2811717237324344e-05}. Best is trial 10 with value: 0.9762269503546099.
[I 2025-03-07 07:05:28,813] Trial 14 finished with value: 0.9735602836879433 and parameters: {'lr': 7.417696402475715e-05, 'weight_decay': 1.8018265048631195e-05}. Best is trial 10 with value: 0.9762269503546099.
[I 2025-03-07 07:36:54,815] Trial 15 finished with value: 0.9718581560283688 and parameters: {'lr': 3.2278844700562526e-05, 'weight_decay': 4.755093610331608e-06}. Best is trial 10 with value: 0.9762269503546099.
[I 2025-03-07 08:03:24,653] Trial 16 finished with value: 0.9695319148936171 and parameters: {'lr': 0.00014449945412563613, 'weight_decay': 4.2640983108779306e-06}. Best is trial 10 with value: 0.9762269503546099.
[I 2025-03-07 08:27:50,693] Trial 17 finished with value: 0.9707234042553191 and parameters: {'lr': 9.8360232335757e-05, 'weight_decay': 2.610106594997609e-05}. Best is trial 10 with value: 0.9762269503546099.
[I 2025-03-07 08:50:17,668] Trial 18 pruned. 
[I 2025-03-07 09:16:43,900] Trial 19 finished with value: 0.9707234042553191 and parameters: {'lr': 5.8051573684255805e-05, 'weight_decay': 1.1630691441788127e-05}. Best is trial 10 with value: 0.9762269503546099.
Loaded configuration:
{'experiment': {'reproducibility': True, 'seed': 42, 'num_trials': 20, 'num_epochs': 20, 'final_epochs': 5, 'save_model': True, 'model_save_path': 'final_model.pth', 'continual_learning': True, 'continual_method': 'baseline', 'task_list': [[0, 1], [2, 3]], 'suggest': {'lr': {'low': '1e-5', 'high': '1e-3', 'log': True}, 'weight_decay': {'low': '1e-6', 'high': '1e-2', 'log': True}}}, 'model': {'type': 'resnet50', 'lr': '1e-4', 'weight_decay': '1e-4'}, 'dataset': {'path': '/home/anhcao/tmp/Dataset/Wafermap-dataset/WM811K.pkl'}}
[INFO] Using device: cuda
[INFO] Number of classes: 8
[INFO] Classes: ['Center' 'Donut' 'Edge-Loc' 'Edge-Ring' 'Loc' 'Near-full' 'Random'
 'Scratch']
[INFO] Creating Optuna study 'resnet_wafer_1741300185' with DB file: resnet_wafer_v2.db
[INFO] Starting study.optimize with 20 trials...


[OPTUNA] Starting Trial #0 with lr=0.000328, weight_decay=0.000002
[OPTUNA] Trial #0: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0003284236900991354, weight_decay=1.7828139990609243e-06
[INFO] >>> Starting fold 1 training (Trial #0) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2733, Train Acc: 0.9048 | Val Loss: 0.2060, Val Acc: 0.9359
[Fold 1 Epoch 2/20] Train Loss: 0.1304, Train Acc: 0.9582 | Val Loss: 0.1574, Val Acc: 0.9540
[Fold 1 Epoch 3/20] Train Loss: 0.0912, Train Acc: 0.9699 | Val Loss: 0.1157, Val Acc: 0.9660
[Fold 1 Epoch 4/20] Train Loss: 0.0719, Train Acc: 0.9758 | Val Loss: 0.1734, Val Acc: 0.9472
[Fold 1 Epoch 5/20] Train Loss: 0.0594, Train Acc: 0.9803 | Val Loss: 0.2229, Val Acc: 0.9384
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9660

[OPTUNA] Trial #0: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0003284236900991354, weight_decay=1.7828139990609243e-06
[INFO] >>> Starting fold 2 training (Trial #0) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2790, Train Acc: 0.9048 | Val Loss: 0.1705, Val Acc: 0.9413
[Fold 2 Epoch 2/20] Train Loss: 0.1292, Train Acc: 0.9565 | Val Loss: 0.1276, Val Acc: 0.9557
[Fold 2 Epoch 3/20] Train Loss: 0.0924, Train Acc: 0.9695 | Val Loss: 0.1214, Val Acc: 0.9617
[Fold 2 Epoch 4/20] Train Loss: 0.0722, Train Acc: 0.9760 | Val Loss: 0.1457, Val Acc: 0.9560
[Fold 2 Epoch 5/20] Train Loss: 0.0593, Train Acc: 0.9801 | Val Loss: 0.1489, Val Acc: 0.9529
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9617

[OPTUNA] Trial #0: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0003284236900991354, weight_decay=1.7828139990609243e-06
[INFO] >>> Starting fold 3 training (Trial #0) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2746, Train Acc: 0.9046 | Val Loss: 0.1646, Val Acc: 0.9467
[Fold 3 Epoch 2/20] Train Loss: 0.1328, Train Acc: 0.9566 | Val Loss: 0.1538, Val Acc: 0.9489
[Fold 3 Epoch 3/20] Train Loss: 0.0925, Train Acc: 0.9697 | Val Loss: 0.1361, Val Acc: 0.9623
[Fold 3 Epoch 4/20] Train Loss: 0.0842, Train Acc: 0.9718 | Val Loss: 0.0947, Val Acc: 0.9685
[Fold 3 Epoch 5/20] Train Loss: 0.0505, Train Acc: 0.9837 | Val Loss: 0.1376, Val Acc: 0.9566
[Fold 3 Epoch 6/20] Train Loss: 0.0536, Train Acc: 0.9818 | Val Loss: 0.1243, Val Acc: 0.9620
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val acc = 0.9685

[OPTUNA] Trial #0: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0003284236900991354, weight_decay=1.7828139990609243e-06
[INFO] >>> Starting fold 4 training (Trial #0) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2732, Train Acc: 0.9060 | Val Loss: 0.2236, Val Acc: 0.9296
[Fold 4 Epoch 2/20] Train Loss: 0.1299, Train Acc: 0.9557 | Val Loss: 0.2599, Val Acc: 0.9217
[Fold 4 Epoch 3/20] Train Loss: 0.0908, Train Acc: 0.9692 | Val Loss: 0.1299, Val Acc: 0.9600
[Fold 4 Epoch 4/20] Train Loss: 0.0667, Train Acc: 0.9784 | Val Loss: 0.1428, Val Acc: 0.9518
[Fold 4 Epoch 5/20] Train Loss: 0.0566, Train Acc: 0.9818 | Val Loss: 0.1177, Val Acc: 0.9609
[Fold 4 Epoch 6/20] Train Loss: 0.0494, Train Acc: 0.9828 | Val Loss: 0.1686, Val Acc: 0.9515
[Fold 4 Epoch 7/20] Train Loss: 0.0664, Train Acc: 0.9787 | Val Loss: 0.2167, Val Acc: 0.9373
[INFO] Early stopping on fold 4 at epoch 7
[INFO] <<< Finished fold 4, best val acc = 0.9609

[OPTUNA] Trial #0: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0003284236900991354, weight_decay=1.7828139990609243e-06
[INFO] >>> Starting fold 5 training (Trial #0) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2733, Train Acc: 0.9046 | Val Loss: 0.2037, Val Acc: 0.9333
[Fold 5 Epoch 2/20] Train Loss: 0.1279, Train Acc: 0.9552 | Val Loss: 0.1105, Val Acc: 0.9611
[Fold 5 Epoch 3/20] Train Loss: 0.0998, Train Acc: 0.9669 | Val Loss: 0.1341, Val Acc: 0.9557
[Fold 5 Epoch 4/20] Train Loss: 0.0686, Train Acc: 0.9781 | Val Loss: 0.1184, Val Acc: 0.9631
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9611

[OPTUNA] Trial #0 done. Fold Accuracies: [0.9659574468085106, 0.9617021276595744, 0.9685106382978723, 0.9608510638297872, 0.9611347517730496]. Avg Acc=0.9636

[OPTUNA] Starting Trial #1 with lr=0.000245, weight_decay=0.000005
[OPTUNA] Trial #1: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0002451742487816269, weight_decay=4.538068041410125e-06
[INFO] >>> Starting fold 1 training (Trial #1) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2626, Train Acc: 0.9110 | Val Loss: 0.1856, Val Acc: 0.9427
[Fold 1 Epoch 2/20] Train Loss: 0.1199, Train Acc: 0.9586 | Val Loss: 0.1228, Val Acc: 0.9597
[Fold 1 Epoch 3/20] Train Loss: 0.0715, Train Acc: 0.9766 | Val Loss: 0.1074, Val Acc: 0.9643
[Fold 1 Epoch 4/20] Train Loss: 0.0684, Train Acc: 0.9764 | Val Loss: 0.1045, Val Acc: 0.9657
[Fold 1 Epoch 5/20] Train Loss: 0.0531, Train Acc: 0.9827 | Val Loss: 0.1445, Val Acc: 0.9577
[Fold 1 Epoch 6/20] Train Loss: 0.0411, Train Acc: 0.9870 | Val Loss: 0.1012, Val Acc: 0.9733
[Fold 1 Epoch 7/20] Train Loss: 0.0297, Train Acc: 0.9904 | Val Loss: 0.1091, Val Acc: 0.9719
[Fold 1 Epoch 8/20] Train Loss: 0.0356, Train Acc: 0.9879 | Val Loss: 0.1423, Val Acc: 0.9560
[INFO] Early stopping on fold 1 at epoch 8
[INFO] <<< Finished fold 1, best val acc = 0.9733

[OPTUNA] Trial #1: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0002451742487816269, weight_decay=4.538068041410125e-06
[INFO] >>> Starting fold 2 training (Trial #1) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2586, Train Acc: 0.9096 | Val Loss: 0.1362, Val Acc: 0.9572
[Fold 2 Epoch 2/20] Train Loss: 0.1046, Train Acc: 0.9636 | Val Loss: 0.1378, Val Acc: 0.9552
[Fold 2 Epoch 3/20] Train Loss: 0.0799, Train Acc: 0.9740 | Val Loss: 0.1331, Val Acc: 0.9572
[Fold 2 Epoch 4/20] Train Loss: 0.0635, Train Acc: 0.9782 | Val Loss: 0.1087, Val Acc: 0.9637
[Fold 2 Epoch 5/20] Train Loss: 0.0453, Train Acc: 0.9858 | Val Loss: 0.1273, Val Acc: 0.9674
[Fold 2 Epoch 6/20] Train Loss: 0.0366, Train Acc: 0.9877 | Val Loss: 0.1193, Val Acc: 0.9682
[INFO] Early stopping on fold 2 at epoch 6
[INFO] <<< Finished fold 2, best val acc = 0.9674

[OPTUNA] Trial #1: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0002451742487816269, weight_decay=4.538068041410125e-06
[INFO] >>> Starting fold 3 training (Trial #1) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2501, Train Acc: 0.9168 | Val Loss: 0.1164, Val Acc: 0.9623
[Fold 3 Epoch 2/20] Train Loss: 0.1106, Train Acc: 0.9631 | Val Loss: 0.1990, Val Acc: 0.9299
[Fold 3 Epoch 3/20] Train Loss: 0.0816, Train Acc: 0.9738 | Val Loss: 0.0915, Val Acc: 0.9711
[Fold 3 Epoch 4/20] Train Loss: 0.0567, Train Acc: 0.9818 | Val Loss: 0.1156, Val Acc: 0.9577
[Fold 3 Epoch 5/20] Train Loss: 0.0455, Train Acc: 0.9838 | Val Loss: 0.0884, Val Acc: 0.9716
[Fold 3 Epoch 6/20] Train Loss: 0.0467, Train Acc: 0.9853 | Val Loss: 0.1237, Val Acc: 0.9611
[Fold 3 Epoch 7/20] Train Loss: 0.0308, Train Acc: 0.9896 | Val Loss: 0.1440, Val Acc: 0.9606
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9716

[OPTUNA] Trial #1: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0002451742487816269, weight_decay=4.538068041410125e-06
[INFO] >>> Starting fold 4 training (Trial #1) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2630, Train Acc: 0.9083 | Val Loss: 0.1522, Val Acc: 0.9495
[Fold 4 Epoch 2/20] Train Loss: 0.1142, Train Acc: 0.9616 | Val Loss: 0.1223, Val Acc: 0.9591
[Fold 4 Epoch 3/20] Train Loss: 0.0795, Train Acc: 0.9726 | Val Loss: 0.1255, Val Acc: 0.9597
[Fold 4 Epoch 4/20] Train Loss: 0.0727, Train Acc: 0.9767 | Val Loss: 0.0921, Val Acc: 0.9674
[Fold 4 Epoch 5/20] Train Loss: 0.0371, Train Acc: 0.9877 | Val Loss: 0.1498, Val Acc: 0.9546
[Fold 4 Epoch 6/20] Train Loss: 0.0411, Train Acc: 0.9869 | Val Loss: 0.1246, Val Acc: 0.9603
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9674

[OPTUNA] Trial #1: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0002451742487816269, weight_decay=4.538068041410125e-06
[INFO] >>> Starting fold 5 training (Trial #1) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2593, Train Acc: 0.9070 | Val Loss: 0.2230, Val Acc: 0.9220
[Fold 5 Epoch 2/20] Train Loss: 0.1139, Train Acc: 0.9616 | Val Loss: 0.1522, Val Acc: 0.9464
[Fold 5 Epoch 3/20] Train Loss: 0.0801, Train Acc: 0.9732 | Val Loss: 0.1113, Val Acc: 0.9660
[Fold 5 Epoch 4/20] Train Loss: 0.0605, Train Acc: 0.9788 | Val Loss: 0.1471, Val Acc: 0.9574
[Fold 5 Epoch 5/20] Train Loss: 0.0459, Train Acc: 0.9846 | Val Loss: 0.1041, Val Acc: 0.9662
[Fold 5 Epoch 6/20] Train Loss: 0.0409, Train Acc: 0.9871 | Val Loss: 0.1698, Val Acc: 0.9512
[Fold 5 Epoch 7/20] Train Loss: 0.0436, Train Acc: 0.9852 | Val Loss: 0.1333, Val Acc: 0.9614
[INFO] Early stopping on fold 5 at epoch 7
[INFO] <<< Finished fold 5, best val acc = 0.9662

[OPTUNA] Trial #1 done. Fold Accuracies: [0.9733333333333334, 0.9673758865248226, 0.9716312056737588, 0.9673758865248226, 0.9662411347517731]. Avg Acc=0.9692

[OPTUNA] Starting Trial #2 with lr=0.000337, weight_decay=0.000324
[OPTUNA] Trial #2: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0003365084346659179, weight_decay=0.0003241097287711684
[INFO] >>> Starting fold 1 training (Trial #2) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2786, Train Acc: 0.9037 | Val Loss: 0.1633, Val Acc: 0.9455
[Fold 1 Epoch 2/20] Train Loss: 0.1441, Train Acc: 0.9533 | Val Loss: 0.1578, Val Acc: 0.9470
[Fold 1 Epoch 3/20] Train Loss: 0.1212, Train Acc: 0.9600 | Val Loss: 0.1396, Val Acc: 0.9521
[Fold 1 Epoch 4/20] Train Loss: 0.1041, Train Acc: 0.9661 | Val Loss: 0.2223, Val Acc: 0.9336
[Fold 1 Epoch 5/20] Train Loss: 0.0785, Train Acc: 0.9741 | Val Loss: 0.2179, Val Acc: 0.9401
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9521

[OPTUNA] Trial #2: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0003365084346659179, weight_decay=0.0003241097287711684
[INFO] >>> Starting fold 2 training (Trial #2) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2761, Train Acc: 0.9032 | Val Loss: 0.1291, Val Acc: 0.9555
[Fold 2 Epoch 2/20] Train Loss: 0.1362, Train Acc: 0.9535 | Val Loss: 0.1194, Val Acc: 0.9574
[Fold 2 Epoch 3/20] Train Loss: 0.1114, Train Acc: 0.9652 | Val Loss: 0.1844, Val Acc: 0.9384
[Fold 2 Epoch 4/20] Train Loss: 0.0954, Train Acc: 0.9677 | Val Loss: 0.1169, Val Acc: 0.9611
[Fold 2 Epoch 5/20] Train Loss: 0.0892, Train Acc: 0.9699 | Val Loss: 0.1674, Val Acc: 0.9521
[Fold 2 Epoch 6/20] Train Loss: 0.0658, Train Acc: 0.9796 | Val Loss: 0.1353, Val Acc: 0.9591
[INFO] Early stopping on fold 2 at epoch 6
[INFO] <<< Finished fold 2, best val acc = 0.9611

[OPTUNA] Trial #2: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0003365084346659179, weight_decay=0.0003241097287711684
[INFO] >>> Starting fold 3 training (Trial #2) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2730, Train Acc: 0.9055 | Val Loss: 0.1533, Val Acc: 0.9521
[Fold 3 Epoch 2/20] Train Loss: 0.1335, Train Acc: 0.9535 | Val Loss: 0.1111, Val Acc: 0.9679
[Fold 3 Epoch 3/20] Train Loss: 0.1065, Train Acc: 0.9649 | Val Loss: 0.1037, Val Acc: 0.9626
[Fold 3 Epoch 4/20] Train Loss: 0.0896, Train Acc: 0.9700 | Val Loss: 0.1621, Val Acc: 0.9487
[Fold 3 Epoch 5/20] Train Loss: 0.0785, Train Acc: 0.9733 | Val Loss: 0.1145, Val Acc: 0.9620
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9679

[OPTUNA] Trial #2: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0003365084346659179, weight_decay=0.0003241097287711684
[INFO] >>> Starting fold 4 training (Trial #2) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2658, Train Acc: 0.9067 | Val Loss: 0.1916, Val Acc: 0.9316
[Fold 4 Epoch 2/20] Train Loss: 0.1414, Train Acc: 0.9508 | Val Loss: 0.1512, Val Acc: 0.9489
[Fold 4 Epoch 3/20] Train Loss: 0.1032, Train Acc: 0.9657 | Val Loss: 0.1601, Val Acc: 0.9470
[Fold 4 Epoch 4/20] Train Loss: 0.1007, Train Acc: 0.9666 | Val Loss: 0.1209, Val Acc: 0.9577
[Fold 4 Epoch 5/20] Train Loss: 0.0825, Train Acc: 0.9739 | Val Loss: 0.2529, Val Acc: 0.9214
[Fold 4 Epoch 6/20] Train Loss: 0.0699, Train Acc: 0.9770 | Val Loss: 0.1260, Val Acc: 0.9617
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9577

[OPTUNA] Trial #2: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0003365084346659179, weight_decay=0.0003241097287711684
[INFO] >>> Starting fold 5 training (Trial #2) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2744, Train Acc: 0.9062 | Val Loss: 0.1588, Val Acc: 0.9478
[Fold 5 Epoch 2/20] Train Loss: 0.1337, Train Acc: 0.9555 | Val Loss: 0.1498, Val Acc: 0.9518
[Fold 5 Epoch 3/20] Train Loss: 0.1071, Train Acc: 0.9636 | Val Loss: 0.1240, Val Acc: 0.9572
[Fold 5 Epoch 4/20] Train Loss: 0.0916, Train Acc: 0.9693 | Val Loss: 0.1125, Val Acc: 0.9654
[Fold 5 Epoch 5/20] Train Loss: 0.0844, Train Acc: 0.9729 | Val Loss: 0.1505, Val Acc: 0.9583
[Fold 5 Epoch 6/20] Train Loss: 0.0772, Train Acc: 0.9753 | Val Loss: 0.1420, Val Acc: 0.9577
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9654

[OPTUNA] Trial #2 done. Fold Accuracies: [0.9520567375886525, 0.9611347517730496, 0.9679432624113475, 0.9577304964539007, 0.9653900709219858]. Avg Acc=0.9609

[OPTUNA] Starting Trial #3 with lr=0.000012, weight_decay=0.000130
[OPTUNA] Trial #3: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=1.2354025132668715e-05, weight_decay=0.00012996121373752098
[INFO] >>> Starting fold 1 training (Trial #3) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.6393, Train Acc: 0.8072 | Val Loss: 0.2852, Val Acc: 0.9070
[Fold 1 Epoch 2/20] Train Loss: 0.1933, Train Acc: 0.9423 | Val Loss: 0.1446, Val Acc: 0.9546
[Fold 1 Epoch 3/20] Train Loss: 0.0776, Train Acc: 0.9802 | Val Loss: 0.1200, Val Acc: 0.9620
[Fold 1 Epoch 4/20] Train Loss: 0.0338, Train Acc: 0.9935 | Val Loss: 0.1111, Val Acc: 0.9654
[Fold 1 Epoch 5/20] Train Loss: 0.0180, Train Acc: 0.9977 | Val Loss: 0.1212, Val Acc: 0.9662
[Fold 1 Epoch 6/20] Train Loss: 0.0099, Train Acc: 0.9990 | Val Loss: 0.1246, Val Acc: 0.9662
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9662

[OPTUNA] Trial #3: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=1.2354025132668715e-05, weight_decay=0.00012996121373752098
[INFO] >>> Starting fold 2 training (Trial #3) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.6342, Train Acc: 0.8114 | Val Loss: 0.2781, Val Acc: 0.9152
[Fold 2 Epoch 2/20] Train Loss: 0.1909, Train Acc: 0.9413 | Val Loss: 0.1393, Val Acc: 0.9577
[Fold 2 Epoch 3/20] Train Loss: 0.0783, Train Acc: 0.9787 | Val Loss: 0.1134, Val Acc: 0.9603
[Fold 2 Epoch 4/20] Train Loss: 0.0333, Train Acc: 0.9943 | Val Loss: 0.1059, Val Acc: 0.9640
[Fold 2 Epoch 5/20] Train Loss: 0.0182, Train Acc: 0.9970 | Val Loss: 0.1068, Val Acc: 0.9617
[Fold 2 Epoch 6/20] Train Loss: 0.0106, Train Acc: 0.9992 | Val Loss: 0.1050, Val Acc: 0.9660
[Fold 2 Epoch 7/20] Train Loss: 0.0097, Train Acc: 0.9989 | Val Loss: 0.1102, Val Acc: 0.9640
[Fold 2 Epoch 8/20] Train Loss: 0.0071, Train Acc: 0.9993 | Val Loss: 0.1111, Val Acc: 0.9609
[INFO] Early stopping on fold 2 at epoch 8
[INFO] <<< Finished fold 2, best val acc = 0.9660

[OPTUNA] Trial #3: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=1.2354025132668715e-05, weight_decay=0.00012996121373752098
[INFO] >>> Starting fold 3 training (Trial #3) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.6363, Train Acc: 0.8035 | Val Loss: 0.2591, Val Acc: 0.9152
[Fold 3 Epoch 2/20] Train Loss: 0.1852, Train Acc: 0.9446 | Val Loss: 0.1404, Val Acc: 0.9532
[Fold 3 Epoch 3/20] Train Loss: 0.0754, Train Acc: 0.9815 | Val Loss: 0.1098, Val Acc: 0.9623
[Fold 3 Epoch 4/20] Train Loss: 0.0329, Train Acc: 0.9935 | Val Loss: 0.1009, Val Acc: 0.9671
[Fold 3 Epoch 5/20] Train Loss: 0.0175, Train Acc: 0.9972 | Val Loss: 0.0972, Val Acc: 0.9677
[Fold 3 Epoch 6/20] Train Loss: 0.0099, Train Acc: 0.9991 | Val Loss: 0.1044, Val Acc: 0.9654
[Fold 3 Epoch 7/20] Train Loss: 0.0060, Train Acc: 0.9999 | Val Loss: 0.0973, Val Acc: 0.9677
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9677

[OPTUNA] Trial #3: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=1.2354025132668715e-05, weight_decay=0.00012996121373752098
[INFO] >>> Starting fold 4 training (Trial #3) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.6188, Train Acc: 0.8120 | Val Loss: 0.2745, Val Acc: 0.9061
[Fold 4 Epoch 2/20] Train Loss: 0.1754, Train Acc: 0.9466 | Val Loss: 0.1475, Val Acc: 0.9546
[Fold 4 Epoch 3/20] Train Loss: 0.0718, Train Acc: 0.9830 | Val Loss: 0.1265, Val Acc: 0.9609
[Fold 4 Epoch 4/20] Train Loss: 0.0315, Train Acc: 0.9947 | Val Loss: 0.1280, Val Acc: 0.9606
[Fold 4 Epoch 5/20] Train Loss: 0.0146, Train Acc: 0.9981 | Val Loss: 0.1202, Val Acc: 0.9617
[Fold 4 Epoch 6/20] Train Loss: 0.0105, Train Acc: 0.9989 | Val Loss: 0.1284, Val Acc: 0.9606
[Fold 4 Epoch 7/20] Train Loss: 0.0074, Train Acc: 0.9994 | Val Loss: 0.1255, Val Acc: 0.9637
[INFO] Early stopping on fold 4 at epoch 7
[INFO] <<< Finished fold 4, best val acc = 0.9617

[OPTUNA] Trial #3: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=1.2354025132668715e-05, weight_decay=0.00012996121373752098
[INFO] >>> Starting fold 5 training (Trial #3) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.6374, Train Acc: 0.8006 | Val Loss: 0.2820, Val Acc: 0.9177
[Fold 5 Epoch 2/20] Train Loss: 0.1863, Train Acc: 0.9411 | Val Loss: 0.1440, Val Acc: 0.9552
[Fold 5 Epoch 3/20] Train Loss: 0.0725, Train Acc: 0.9829 | Val Loss: 0.1210, Val Acc: 0.9597
[Fold 5 Epoch 4/20] Train Loss: 0.0323, Train Acc: 0.9938 | Val Loss: 0.1171, Val Acc: 0.9597
[Fold 5 Epoch 5/20] Train Loss: 0.0172, Train Acc: 0.9975 | Val Loss: 0.1272, Val Acc: 0.9557
[Fold 5 Epoch 6/20] Train Loss: 0.0097, Train Acc: 0.9992 | Val Loss: 0.1220, Val Acc: 0.9591
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9597

[OPTUNA] Trial #3 done. Fold Accuracies: [0.9662411347517731, 0.9659574468085106, 0.9676595744680851, 0.9617021276595744, 0.9597163120567376]. Avg Acc=0.9643

[OPTUNA] Starting Trial #4 with lr=0.000397, weight_decay=0.003877
[OPTUNA] Trial #4: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0003965065351678924, weight_decay=0.003877094634607357
[INFO] >>> Starting fold 1 training (Trial #4) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3322, Train Acc: 0.8841 | Val Loss: 0.2948, Val Acc: 0.9146
[Fold 1 Epoch 2/20] Train Loss: 0.2415, Train Acc: 0.9196 | Val Loss: 0.2770, Val Acc: 0.9197
[Fold 1 Epoch 3/20] Train Loss: 0.2185, Train Acc: 0.9259 | Val Loss: 0.3757, Val Acc: 0.8610
[Fold 1 Epoch 4/20] Train Loss: 0.2255, Train Acc: 0.9262 | Val Loss: 0.2426, Val Acc: 0.9285
[Fold 1 Epoch 5/20] Train Loss: 0.1916, Train Acc: 0.9360 | Val Loss: 0.2025, Val Acc: 0.9305
[Fold 1 Epoch 6/20] Train Loss: 0.1801, Train Acc: 0.9408 | Val Loss: 0.2896, Val Acc: 0.9126
[Fold 1 Epoch 7/20] Train Loss: 0.1653, Train Acc: 0.9489 | Val Loss: 0.6295, Val Acc: 0.7373
[INFO] Early stopping on fold 1 at epoch 7
[INFO] <<< Finished fold 1, best val acc = 0.9305

[OPTUNA] Trial #4: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0003965065351678924, weight_decay=0.003877094634607357
[INFO] >>> Starting fold 2 training (Trial #4) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3210, Train Acc: 0.8865 | Val Loss: 0.4483, Val Acc: 0.8457
[Fold 2 Epoch 2/20] Train Loss: 0.2460, Train Acc: 0.9157 | Val Loss: 0.6571, Val Acc: 0.8028
[Fold 2 Epoch 3/20] Train Loss: 0.2253, Train Acc: 0.9266 | Val Loss: 0.2721, Val Acc: 0.9118
[Fold 2 Epoch 4/20] Train Loss: 0.2013, Train Acc: 0.9333 | Val Loss: 0.3951, Val Acc: 0.8675
[Fold 2 Epoch 5/20] Train Loss: 0.1993, Train Acc: 0.9351 | Val Loss: 0.2917, Val Acc: 0.9174
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9118

[OPTUNA] Trial #4: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0003965065351678924, weight_decay=0.003877094634607357
[INFO] >>> Starting fold 3 training (Trial #4) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3361, Train Acc: 0.8845 | Val Loss: 0.5520, Val Acc: 0.7963
[Fold 3 Epoch 2/20] Train Loss: 0.2395, Train Acc: 0.9198 | Val Loss: 0.3635, Val Acc: 0.8871
[Fold 3 Epoch 3/20] Train Loss: 0.2208, Train Acc: 0.9282 | Val Loss: 0.4748, Val Acc: 0.8582
[Fold 3 Epoch 4/20] Train Loss: 0.2229, Train Acc: 0.9259 | Val Loss: 0.5431, Val Acc: 0.8054
[INFO] Early stopping on fold 3 at epoch 4
[INFO] <<< Finished fold 3, best val acc = 0.8871

[OPTUNA] Trial #4: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0003965065351678924, weight_decay=0.003877094634607357
[INFO] >>> Starting fold 4 training (Trial #4) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3216, Train Acc: 0.8887 | Val Loss: 0.3339, Val Acc: 0.8919
[Fold 4 Epoch 2/20] Train Loss: 0.2337, Train Acc: 0.9187 | Val Loss: 0.2747, Val Acc: 0.9112
[Fold 4 Epoch 3/20] Train Loss: 0.2245, Train Acc: 0.9240 | Val Loss: 0.3947, Val Acc: 0.8888
[Fold 4 Epoch 4/20] Train Loss: 0.2085, Train Acc: 0.9291 | Val Loss: 0.2945, Val Acc: 0.9033
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9112

[OPTUNA] Trial #4: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0003965065351678924, weight_decay=0.003877094634607357
[INFO] >>> Starting fold 5 training (Trial #4) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.3088, Train Acc: 0.8936 | Val Loss: 0.2856, Val Acc: 0.9058
[Fold 5 Epoch 2/20] Train Loss: 0.2391, Train Acc: 0.9195 | Val Loss: 0.4064, Val Acc: 0.8721
[Fold 5 Epoch 3/20] Train Loss: 0.2150, Train Acc: 0.9269 | Val Loss: 0.3328, Val Acc: 0.8905
[INFO] Early stopping on fold 5 at epoch 3
[INFO] <<< Finished fold 5, best val acc = 0.9058

[OPTUNA] Trial #4 done. Fold Accuracies: [0.9304964539007092, 0.9117730496453901, 0.8870921985815603, 0.9112056737588653, 0.9058156028368795]. Avg Acc=0.9093

[OPTUNA] Starting Trial #5 with lr=0.000012, weight_decay=0.000044
[OPTUNA] Trial #5: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=1.2264688060837229e-05, weight_decay=4.378273658892025e-05
[INFO] >>> Starting fold 1 training (Trial #5) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.6230, Train Acc: 0.8127 | Val Loss: 0.2781, Val Acc: 0.9050
[Fold 1 Epoch 2/20] Train Loss: 0.1890, Train Acc: 0.9416 | Val Loss: 0.1442, Val Acc: 0.9512
[Fold 1 Epoch 3/20] Train Loss: 0.0767, Train Acc: 0.9805 | Val Loss: 0.1090, Val Acc: 0.9651
[Fold 1 Epoch 4/20] Train Loss: 0.0344, Train Acc: 0.9930 | Val Loss: 0.1084, Val Acc: 0.9665
[Fold 1 Epoch 5/20] Train Loss: 0.0149, Train Acc: 0.9985 | Val Loss: 0.1044, Val Acc: 0.9696
[Fold 1 Epoch 6/20] Train Loss: 0.0126, Train Acc: 0.9989 | Val Loss: 0.1116, Val Acc: 0.9651
[Fold 1 Epoch 7/20] Train Loss: 0.0093, Train Acc: 0.9989 | Val Loss: 0.1087, Val Acc: 0.9654
[INFO] Early stopping on fold 1 at epoch 7
[INFO] <<< Finished fold 1, best val acc = 0.9696

[OPTUNA] Trial #5: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=1.2264688060837229e-05, weight_decay=4.378273658892025e-05
[INFO] >>> Starting fold 2 training (Trial #5) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.6408, Train Acc: 0.8038 | Val Loss: 0.2817, Val Acc: 0.9001
[Fold 2 Epoch 2/20] Train Loss: 0.1950, Train Acc: 0.9391 | Val Loss: 0.1345, Val Acc: 0.9603
[Fold 2 Epoch 3/20] Train Loss: 0.0784, Train Acc: 0.9801 | Val Loss: 0.1034, Val Acc: 0.9657
[Fold 2 Epoch 4/20] Train Loss: 0.0343, Train Acc: 0.9938 | Val Loss: 0.0989, Val Acc: 0.9665
[Fold 2 Epoch 5/20] Train Loss: 0.0184, Train Acc: 0.9976 | Val Loss: 0.0989, Val Acc: 0.9662
[Fold 2 Epoch 6/20] Train Loss: 0.0107, Train Acc: 0.9991 | Val Loss: 0.1027, Val Acc: 0.9671
[Fold 2 Epoch 7/20] Train Loss: 0.0071, Train Acc: 0.9996 | Val Loss: 0.0934, Val Acc: 0.9688
[Fold 2 Epoch 8/20] Train Loss: 0.0055, Train Acc: 0.9996 | Val Loss: 0.1139, Val Acc: 0.9665
[Fold 2 Epoch 9/20] Train Loss: 0.0065, Train Acc: 0.9989 | Val Loss: 0.0941, Val Acc: 0.9691
[INFO] Early stopping on fold 2 at epoch 9
[INFO] <<< Finished fold 2, best val acc = 0.9688

[OPTUNA] Trial #5: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=1.2264688060837229e-05, weight_decay=4.378273658892025e-05
[INFO] >>> Starting fold 3 training (Trial #5) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.6897, Train Acc: 0.7830 | Val Loss: 0.2769, Val Acc: 0.9104
[Fold 3 Epoch 2/20] Train Loss: 0.1929, Train Acc: 0.9419 | Val Loss: 0.1387, Val Acc: 0.9580
[Fold 3 Epoch 3/20] Train Loss: 0.0797, Train Acc: 0.9792 | Val Loss: 0.1137, Val Acc: 0.9651
[Fold 3 Epoch 4/20] Train Loss: 0.0360, Train Acc: 0.9940 | Val Loss: 0.1098, Val Acc: 0.9660
[Fold 3 Epoch 5/20] Train Loss: 0.0203, Train Acc: 0.9963 | Val Loss: 0.1056, Val Acc: 0.9660
[Fold 3 Epoch 6/20] Train Loss: 0.0112, Train Acc: 0.9990 | Val Loss: 0.1094, Val Acc: 0.9640
[Fold 3 Epoch 7/20] Train Loss: 0.0068, Train Acc: 0.9996 | Val Loss: 0.1057, Val Acc: 0.9651
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9660

[OPTUNA] Trial #5: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=1.2264688060837229e-05, weight_decay=4.378273658892025e-05
[INFO] >>> Starting fold 4 training (Trial #5) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.6381, Train Acc: 0.8052 | Val Loss: 0.2758, Val Acc: 0.9169
[Fold 4 Epoch 2/20] Train Loss: 0.1771, Train Acc: 0.9454 | Val Loss: 0.1485, Val Acc: 0.9552
[Fold 4 Epoch 3/20] Train Loss: 0.0705, Train Acc: 0.9821 | Val Loss: 0.1163, Val Acc: 0.9611
[Fold 4 Epoch 4/20] Train Loss: 0.0298, Train Acc: 0.9956 | Val Loss: 0.1168, Val Acc: 0.9626
[Fold 4 Epoch 5/20] Train Loss: 0.0160, Train Acc: 0.9986 | Val Loss: 0.1139, Val Acc: 0.9634
[Fold 4 Epoch 6/20] Train Loss: 0.0087, Train Acc: 0.9994 | Val Loss: 0.1175, Val Acc: 0.9631
[Fold 4 Epoch 7/20] Train Loss: 0.0069, Train Acc: 0.9995 | Val Loss: 0.1188, Val Acc: 0.9631
[INFO] Early stopping on fold 4 at epoch 7
[INFO] <<< Finished fold 4, best val acc = 0.9634

[OPTUNA] Trial #5: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=1.2264688060837229e-05, weight_decay=4.378273658892025e-05
[INFO] >>> Starting fold 5 training (Trial #5) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.6322, Train Acc: 0.8066 | Val Loss: 0.2747, Val Acc: 0.9067
[Fold 5 Epoch 2/20] Train Loss: 0.1815, Train Acc: 0.9445 | Val Loss: 0.1534, Val Acc: 0.9506
[Fold 5 Epoch 3/20] Train Loss: 0.0757, Train Acc: 0.9811 | Val Loss: 0.1283, Val Acc: 0.9580
[Fold 5 Epoch 4/20] Train Loss: 0.0339, Train Acc: 0.9937 | Val Loss: 0.1146, Val Acc: 0.9603
[Fold 5 Epoch 5/20] Train Loss: 0.0183, Train Acc: 0.9976 | Val Loss: 0.1193, Val Acc: 0.9566
[Fold 5 Epoch 6/20] Train Loss: 0.0115, Train Acc: 0.9988 | Val Loss: 0.1238, Val Acc: 0.9583
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9603

[OPTUNA] Trial #5 done. Fold Accuracies: [0.969645390070922, 0.9687943262411347, 0.9659574468085106, 0.963404255319149, 0.9602836879432625]. Avg Acc=0.9656

[OPTUNA] Starting Trial #6 with lr=0.000015, weight_decay=0.001055
[OPTUNA] Trial #6: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=1.4720289540812558e-05, weight_decay=0.0010554490854004582
[INFO] >>> Starting fold 1 training (Trial #6) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.5831, Train Acc: 0.8204 | Val Loss: 0.2193, Val Acc: 0.9350
[Fold 1 Epoch 2/20] Train Loss: 0.1557, Train Acc: 0.9510 | Val Loss: 0.1382, Val Acc: 0.9617
[Fold 1 Epoch 3/20] Train Loss: 0.0633, Train Acc: 0.9830 | Val Loss: 0.1118, Val Acc: 0.9614
[Fold 1 Epoch 4/20] Train Loss: 0.0261, Train Acc: 0.9953 | Val Loss: 0.1082, Val Acc: 0.9662
[Fold 1 Epoch 5/20] Train Loss: 0.0124, Train Acc: 0.9988 | Val Loss: 0.1067, Val Acc: 0.9668
[Fold 1 Epoch 6/20] Train Loss: 0.0090, Train Acc: 0.9994 | Val Loss: 0.1139, Val Acc: 0.9674
[Fold 1 Epoch 7/20] Train Loss: 0.0054, Train Acc: 0.9996 | Val Loss: 0.1247, Val Acc: 0.9631
[INFO] Early stopping on fold 1 at epoch 7
[INFO] <<< Finished fold 1, best val acc = 0.9674

[OPTUNA] Trial #6: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=1.4720289540812558e-05, weight_decay=0.0010554490854004582
[INFO] >>> Starting fold 2 training (Trial #6) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.5938, Train Acc: 0.8160 | Val Loss: 0.2435, Val Acc: 0.9260
[Fold 2 Epoch 2/20] Train Loss: 0.1646, Train Acc: 0.9491 | Val Loss: 0.1106, Val Acc: 0.9609
[Fold 2 Epoch 3/20] Train Loss: 0.0634, Train Acc: 0.9838 | Val Loss: 0.0973, Val Acc: 0.9660
[Fold 2 Epoch 4/20] Train Loss: 0.0263, Train Acc: 0.9958 | Val Loss: 0.0909, Val Acc: 0.9645
[Fold 2 Epoch 5/20] Train Loss: 0.0148, Train Acc: 0.9981 | Val Loss: 0.0868, Val Acc: 0.9691
[Fold 2 Epoch 6/20] Train Loss: 0.0109, Train Acc: 0.9984 | Val Loss: 0.0896, Val Acc: 0.9702
[Fold 2 Epoch 7/20] Train Loss: 0.0058, Train Acc: 0.9996 | Val Loss: 0.0965, Val Acc: 0.9688
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val acc = 0.9702

[OPTUNA] Trial #6: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=1.4720289540812558e-05, weight_decay=0.0010554490854004582
[INFO] >>> Starting fold 3 training (Trial #6) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.5872, Train Acc: 0.8180 | Val Loss: 0.2393, Val Acc: 0.9191
[Fold 3 Epoch 2/20] Train Loss: 0.1694, Train Acc: 0.9484 | Val Loss: 0.1214, Val Acc: 0.9645
[Fold 3 Epoch 3/20] Train Loss: 0.0706, Train Acc: 0.9816 | Val Loss: 0.1103, Val Acc: 0.9628
[Fold 3 Epoch 4/20] Train Loss: 0.0276, Train Acc: 0.9958 | Val Loss: 0.0963, Val Acc: 0.9679
[Fold 3 Epoch 5/20] Train Loss: 0.0136, Train Acc: 0.9987 | Val Loss: 0.0885, Val Acc: 0.9691
[Fold 3 Epoch 6/20] Train Loss: 0.0087, Train Acc: 0.9992 | Val Loss: 0.0954, Val Acc: 0.9662
[Fold 3 Epoch 7/20] Train Loss: 0.0079, Train Acc: 0.9989 | Val Loss: 0.1010, Val Acc: 0.9648
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9691

[OPTUNA] Trial #6: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=1.4720289540812558e-05, weight_decay=0.0010554490854004582
[INFO] >>> Starting fold 4 training (Trial #6) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.6285, Train Acc: 0.7979 | Val Loss: 0.2794, Val Acc: 0.9098
[Fold 4 Epoch 2/20] Train Loss: 0.1776, Train Acc: 0.9476 | Val Loss: 0.1418, Val Acc: 0.9546
[Fold 4 Epoch 3/20] Train Loss: 0.0619, Train Acc: 0.9865 | Val Loss: 0.1289, Val Acc: 0.9600
[Fold 4 Epoch 4/20] Train Loss: 0.0283, Train Acc: 0.9952 | Val Loss: 0.1169, Val Acc: 0.9626
[Fold 4 Epoch 5/20] Train Loss: 0.0149, Train Acc: 0.9977 | Val Loss: 0.1114, Val Acc: 0.9634
[Fold 4 Epoch 6/20] Train Loss: 0.0106, Train Acc: 0.9987 | Val Loss: 0.1239, Val Acc: 0.9628
[Fold 4 Epoch 7/20] Train Loss: 0.0058, Train Acc: 0.9998 | Val Loss: 0.1183, Val Acc: 0.9640
[INFO] Early stopping on fold 4 at epoch 7
[INFO] <<< Finished fold 4, best val acc = 0.9634

[OPTUNA] Trial #6: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=1.4720289540812558e-05, weight_decay=0.0010554490854004582
[INFO] >>> Starting fold 5 training (Trial #6) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.5648, Train Acc: 0.8238 | Val Loss: 0.2423, Val Acc: 0.9268
[Fold 5 Epoch 2/20] Train Loss: 0.1548, Train Acc: 0.9517 | Val Loss: 0.1333, Val Acc: 0.9549
[Fold 5 Epoch 3/20] Train Loss: 0.0565, Train Acc: 0.9867 | Val Loss: 0.1164, Val Acc: 0.9600
[Fold 5 Epoch 4/20] Train Loss: 0.0256, Train Acc: 0.9957 | Val Loss: 0.1150, Val Acc: 0.9634
[Fold 5 Epoch 5/20] Train Loss: 0.0161, Train Acc: 0.9967 | Val Loss: 0.1218, Val Acc: 0.9603
[Fold 5 Epoch 6/20] Train Loss: 0.0081, Train Acc: 0.9996 | Val Loss: 0.1119, Val Acc: 0.9674
[Fold 5 Epoch 7/20] Train Loss: 0.0069, Train Acc: 0.9993 | Val Loss: 0.1243, Val Acc: 0.9626
[Fold 5 Epoch 8/20] Train Loss: 0.0045, Train Acc: 0.9999 | Val Loss: 0.1146, Val Acc: 0.9685
[INFO] Early stopping on fold 5 at epoch 8
[INFO] <<< Finished fold 5, best val acc = 0.9674

[OPTUNA] Trial #6 done. Fold Accuracies: [0.9673758865248226, 0.9702127659574468, 0.9690780141843972, 0.963404255319149, 0.9673758865248226]. Avg Acc=0.9675

[OPTUNA] Starting Trial #7 with lr=0.000024, weight_decay=0.002123
[OPTUNA] Trial #7: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=2.3907724875562525e-05, weight_decay=0.002122986310370257
[INFO] >>> Starting fold 1 training (Trial #7) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.4498, Train Acc: 0.8622 | Val Loss: 0.1644, Val Acc: 0.9444
[Fold 1 Epoch 2/20] Train Loss: 0.1034, Train Acc: 0.9697 | Val Loss: 0.1005, Val Acc: 0.9677
[Fold 1 Epoch 3/20] Train Loss: 0.0371, Train Acc: 0.9912 | Val Loss: 0.0948, Val Acc: 0.9728
[Fold 1 Epoch 4/20] Train Loss: 0.0165, Train Acc: 0.9967 | Val Loss: 0.1041, Val Acc: 0.9728
[Fold 1 Epoch 5/20] Train Loss: 0.0108, Train Acc: 0.9979 | Val Loss: 0.1049, Val Acc: 0.9699
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9728

[OPTUNA] Trial #7: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=2.3907724875562525e-05, weight_decay=0.002122986310370257
[INFO] >>> Starting fold 2 training (Trial #7) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.4531, Train Acc: 0.8576 | Val Loss: 0.1527, Val Acc: 0.9504
[Fold 2 Epoch 2/20] Train Loss: 0.1041, Train Acc: 0.9667 | Val Loss: 0.1000, Val Acc: 0.9699
[Fold 2 Epoch 3/20] Train Loss: 0.0377, Train Acc: 0.9916 | Val Loss: 0.0951, Val Acc: 0.9696
[Fold 2 Epoch 4/20] Train Loss: 0.0195, Train Acc: 0.9958 | Val Loss: 0.0899, Val Acc: 0.9705
[Fold 2 Epoch 5/20] Train Loss: 0.0102, Train Acc: 0.9983 | Val Loss: 0.1041, Val Acc: 0.9679
[Fold 2 Epoch 6/20] Train Loss: 0.0061, Train Acc: 0.9994 | Val Loss: 0.0963, Val Acc: 0.9725
[INFO] Early stopping on fold 2 at epoch 6
[INFO] <<< Finished fold 2, best val acc = 0.9705

[OPTUNA] Trial #7: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=2.3907724875562525e-05, weight_decay=0.002122986310370257
[INFO] >>> Starting fold 3 training (Trial #7) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.4221, Train Acc: 0.8667 | Val Loss: 0.1591, Val Acc: 0.9492
[Fold 3 Epoch 2/20] Train Loss: 0.1003, Train Acc: 0.9678 | Val Loss: 0.1168, Val Acc: 0.9640
[Fold 3 Epoch 3/20] Train Loss: 0.0308, Train Acc: 0.9923 | Val Loss: 0.0977, Val Acc: 0.9674
[Fold 3 Epoch 4/20] Train Loss: 0.0172, Train Acc: 0.9962 | Val Loss: 0.1011, Val Acc: 0.9660
[Fold 3 Epoch 5/20] Train Loss: 0.0139, Train Acc: 0.9964 | Val Loss: 0.1205, Val Acc: 0.9637
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9674

[OPTUNA] Trial #7: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=2.3907724875562525e-05, weight_decay=0.002122986310370257
[INFO] >>> Starting fold 4 training (Trial #7) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.4655, Train Acc: 0.8504 | Val Loss: 0.1728, Val Acc: 0.9424
[Fold 4 Epoch 2/20] Train Loss: 0.1025, Train Acc: 0.9686 | Val Loss: 0.1212, Val Acc: 0.9600
[Fold 4 Epoch 3/20] Train Loss: 0.0333, Train Acc: 0.9921 | Val Loss: 0.1246, Val Acc: 0.9603
[Fold 4 Epoch 4/20] Train Loss: 0.0177, Train Acc: 0.9962 | Val Loss: 0.1145, Val Acc: 0.9620
[Fold 4 Epoch 5/20] Train Loss: 0.0117, Train Acc: 0.9982 | Val Loss: 0.1309, Val Acc: 0.9634
[Fold 4 Epoch 6/20] Train Loss: 0.0059, Train Acc: 0.9994 | Val Loss: 0.1247, Val Acc: 0.9645
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9634

[OPTUNA] Trial #7: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=2.3907724875562525e-05, weight_decay=0.002122986310370257
[INFO] >>> Starting fold 5 training (Trial #7) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.4617, Train Acc: 0.8523 | Val Loss: 0.1701, Val Acc: 0.9433
[Fold 5 Epoch 2/20] Train Loss: 0.1106, Train Acc: 0.9662 | Val Loss: 0.1014, Val Acc: 0.9654
[Fold 5 Epoch 3/20] Train Loss: 0.0400, Train Acc: 0.9887 | Val Loss: 0.0964, Val Acc: 0.9688
[Fold 5 Epoch 4/20] Train Loss: 0.0214, Train Acc: 0.9951 | Val Loss: 0.1166, Val Acc: 0.9626
[Fold 5 Epoch 5/20] Train Loss: 0.0117, Train Acc: 0.9980 | Val Loss: 0.1102, Val Acc: 0.9668
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9688

[OPTUNA] Trial #7 done. Fold Accuracies: [0.9727659574468085, 0.9704964539007093, 0.9673758865248226, 0.963404255319149, 0.9687943262411347]. Avg Acc=0.9686

[OPTUNA] Starting Trial #8 with lr=0.000828, weight_decay=0.000304
[OPTUNA] Trial #8: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0008284640918120214, weight_decay=0.00030388916232947777
[INFO] >>> Starting fold 1 training (Trial #8) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3899, Train Acc: 0.8628 | Val Loss: 0.3383, Val Acc: 0.8984
[Fold 1 Epoch 2/20] Train Loss: 0.2180, Train Acc: 0.9256 | Val Loss: 0.3089, Val Acc: 0.9186
[Fold 1 Epoch 3/20] Train Loss: 0.1956, Train Acc: 0.9351 | Val Loss: 1.3324, Val Acc: 0.5651
[Fold 1 Epoch 4/20] Train Loss: 0.1763, Train Acc: 0.9409 | Val Loss: 0.2852, Val Acc: 0.8990
[Fold 1 Epoch 5/20] Train Loss: 0.1597, Train Acc: 0.9483 | Val Loss: 0.2339, Val Acc: 0.9251
[Fold 1 Epoch 6/20] Train Loss: 0.1502, Train Acc: 0.9486 | Val Loss: 0.1594, Val Acc: 0.9475
[Fold 1 Epoch 7/20] Train Loss: 0.1464, Train Acc: 0.9505 | Val Loss: 0.4839, Val Acc: 0.8624
[Fold 1 Epoch 8/20] Train Loss: 0.1413, Train Acc: 0.9540 | Val Loss: 0.2917, Val Acc: 0.9155
[INFO] Early stopping on fold 1 at epoch 8
[INFO] <<< Finished fold 1, best val acc = 0.9475

[OPTUNA] Trial #8: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0008284640918120214, weight_decay=0.00030388916232947777
[INFO] >>> Starting fold 2 training (Trial #8) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3802, Train Acc: 0.8646 | Val Loss: 0.4248, Val Acc: 0.8777
[Fold 2 Epoch 2/20] Train Loss: 0.2127, Train Acc: 0.9256 | Val Loss: 0.3031, Val Acc: 0.9021
[Fold 2 Epoch 3/20] Train Loss: 0.1811, Train Acc: 0.9367 | Val Loss: 0.2819, Val Acc: 0.9183
[Fold 2 Epoch 4/20] Train Loss: 0.1584, Train Acc: 0.9472 | Val Loss: 0.2406, Val Acc: 0.9316
[Fold 2 Epoch 5/20] Train Loss: 0.1601, Train Acc: 0.9452 | Val Loss: 0.1890, Val Acc: 0.9339
[Fold 2 Epoch 6/20] Train Loss: 0.1423, Train Acc: 0.9529 | Val Loss: 0.2705, Val Acc: 0.9160
[Fold 2 Epoch 7/20] Train Loss: 0.1336, Train Acc: 0.9572 | Val Loss: 0.2110, Val Acc: 0.9342
[INFO] Early stopping on fold 2 at epoch 7
[INFO] <<< Finished fold 2, best val acc = 0.9339

[OPTUNA] Trial #8: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0008284640918120214, weight_decay=0.00030388916232947777
[INFO] >>> Starting fold 3 training (Trial #8) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3551, Train Acc: 0.8736 | Val Loss: 0.2470, Val Acc: 0.9197
[Fold 3 Epoch 2/20] Train Loss: 0.2194, Train Acc: 0.9261 | Val Loss: 0.2697, Val Acc: 0.9206
[Fold 3 Epoch 3/20] Train Loss: 0.1827, Train Acc: 0.9391 | Val Loss: 0.2019, Val Acc: 0.9373
[Fold 3 Epoch 4/20] Train Loss: 0.1650, Train Acc: 0.9435 | Val Loss: 0.2312, Val Acc: 0.9172
[Fold 3 Epoch 5/20] Train Loss: 0.1599, Train Acc: 0.9458 | Val Loss: 0.1537, Val Acc: 0.9475
[Fold 3 Epoch 6/20] Train Loss: 0.1418, Train Acc: 0.9519 | Val Loss: 0.2155, Val Acc: 0.9245
[Fold 3 Epoch 7/20] Train Loss: 0.1412, Train Acc: 0.9511 | Val Loss: 0.1448, Val Acc: 0.9526
[Fold 3 Epoch 8/20] Train Loss: 0.1249, Train Acc: 0.9578 | Val Loss: 0.2260, Val Acc: 0.9282
[Fold 3 Epoch 9/20] Train Loss: 0.1333, Train Acc: 0.9552 | Val Loss: 0.1321, Val Acc: 0.9606
[Fold 3 Epoch 10/20] Train Loss: 0.1095, Train Acc: 0.9631 | Val Loss: 0.2952, Val Acc: 0.9041
[Fold 3 Epoch 11/20] Train Loss: 0.1170, Train Acc: 0.9608 | Val Loss: 0.1289, Val Acc: 0.9597
[Fold 3 Epoch 12/20] Train Loss: 0.1121, Train Acc: 0.9628 | Val Loss: 0.1998, Val Acc: 0.9299
[Fold 3 Epoch 13/20] Train Loss: 0.0964, Train Acc: 0.9674 | Val Loss: 0.1712, Val Acc: 0.9560
[INFO] Early stopping on fold 3 at epoch 13
[INFO] <<< Finished fold 3, best val acc = 0.9606

[OPTUNA] Trial #8: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0008284640918120214, weight_decay=0.00030388916232947777
[INFO] >>> Starting fold 4 training (Trial #8) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3619, Train Acc: 0.8719 | Val Loss: 0.2908, Val Acc: 0.9058
[Fold 4 Epoch 2/20] Train Loss: 0.1948, Train Acc: 0.9350 | Val Loss: 0.4272, Val Acc: 0.8709
[Fold 4 Epoch 3/20] Train Loss: 0.1744, Train Acc: 0.9396 | Val Loss: 0.2219, Val Acc: 0.9282
[Fold 4 Epoch 4/20] Train Loss: 0.1553, Train Acc: 0.9454 | Val Loss: 0.1892, Val Acc: 0.9362
[Fold 4 Epoch 5/20] Train Loss: 0.1478, Train Acc: 0.9494 | Val Loss: 0.1821, Val Acc: 0.9387
[Fold 4 Epoch 6/20] Train Loss: 0.1309, Train Acc: 0.9557 | Val Loss: 0.2844, Val Acc: 0.9118
[Fold 4 Epoch 7/20] Train Loss: 0.1330, Train Acc: 0.9577 | Val Loss: 0.1514, Val Acc: 0.9489
[Fold 4 Epoch 8/20] Train Loss: 0.1254, Train Acc: 0.9574 | Val Loss: 0.2121, Val Acc: 0.9260
[Fold 4 Epoch 9/20] Train Loss: 0.1162, Train Acc: 0.9590 | Val Loss: 0.1819, Val Acc: 0.9416
[INFO] Early stopping on fold 4 at epoch 9
[INFO] <<< Finished fold 4, best val acc = 0.9489

[OPTUNA] Trial #8: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0008284640918120214, weight_decay=0.00030388916232947777
[INFO] >>> Starting fold 5 training (Trial #8) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.3868, Train Acc: 0.8615 | Val Loss: 0.3963, Val Acc: 0.8647
[Fold 5 Epoch 2/20] Train Loss: 0.2318, Train Acc: 0.9188 | Val Loss: 0.2897, Val Acc: 0.9098
[Fold 5 Epoch 3/20] Train Loss: 0.1959, Train Acc: 0.9334 | Val Loss: 0.2130, Val Acc: 0.9322
[Fold 5 Epoch 4/20] Train Loss: 0.1646, Train Acc: 0.9435 | Val Loss: 0.1900, Val Acc: 0.9396
[Fold 5 Epoch 5/20] Train Loss: 0.1600, Train Acc: 0.9452 | Val Loss: 0.3456, Val Acc: 0.8936
[Fold 5 Epoch 6/20] Train Loss: 0.1534, Train Acc: 0.9480 | Val Loss: 1.2120, Val Acc: 0.7617
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9396

[OPTUNA] Trial #8 done. Fold Accuracies: [0.9475177304964539, 0.9339007092198581, 0.9605673758865249, 0.948936170212766, 0.9395744680851064]. Avg Acc=0.9461

[OPTUNA] Starting Trial #9 with lr=0.000159, weight_decay=0.000281
[OPTUNA] Trial #9: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.0001587934321073946, weight_decay=0.0002808840204696013
[INFO] >>> Starting fold 1 training (Trial #9) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2489, Train Acc: 0.9162 | Val Loss: 0.1312, Val Acc: 0.9597
[Fold 1 Epoch 2/20] Train Loss: 0.0986, Train Acc: 0.9663 | Val Loss: 0.1319, Val Acc: 0.9532
[Fold 1 Epoch 3/20] Train Loss: 0.0657, Train Acc: 0.9788 | Val Loss: 0.1191, Val Acc: 0.9674
[Fold 1 Epoch 4/20] Train Loss: 0.0549, Train Acc: 0.9817 | Val Loss: 0.1470, Val Acc: 0.9603
[Fold 1 Epoch 5/20] Train Loss: 0.0409, Train Acc: 0.9882 | Val Loss: 0.1923, Val Acc: 0.9572
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9674

[OPTUNA] Trial #9: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.0001587934321073946, weight_decay=0.0002808840204696013
[INFO] >>> Starting fold 2 training (Trial #9) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2687, Train Acc: 0.9047 | Val Loss: 0.1493, Val Acc: 0.9543
[Fold 2 Epoch 2/20] Train Loss: 0.1008, Train Acc: 0.9643 | Val Loss: 0.1287, Val Acc: 0.9509
[Fold 2 Epoch 3/20] Train Loss: 0.0665, Train Acc: 0.9775 | Val Loss: 0.1458, Val Acc: 0.9523
[Fold 2 Epoch 4/20] Train Loss: 0.0444, Train Acc: 0.9840 | Val Loss: 0.1823, Val Acc: 0.9532
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9543

[OPTUNA] Trial #9: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.0001587934321073946, weight_decay=0.0002808840204696013
[INFO] >>> Starting fold 3 training (Trial #9) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2692, Train Acc: 0.9074 | Val Loss: 0.1606, Val Acc: 0.9555
[Fold 3 Epoch 2/20] Train Loss: 0.1045, Train Acc: 0.9657 | Val Loss: 0.1239, Val Acc: 0.9677
[Fold 3 Epoch 3/20] Train Loss: 0.0681, Train Acc: 0.9799 | Val Loss: 0.1045, Val Acc: 0.9665
[Fold 3 Epoch 4/20] Train Loss: 0.0532, Train Acc: 0.9832 | Val Loss: 0.1076, Val Acc: 0.9654
[Fold 3 Epoch 5/20] Train Loss: 0.0379, Train Acc: 0.9885 | Val Loss: 0.0938, Val Acc: 0.9685
[Fold 3 Epoch 6/20] Train Loss: 0.0378, Train Acc: 0.9879 | Val Loss: 0.1086, Val Acc: 0.9682
[Fold 3 Epoch 7/20] Train Loss: 0.0321, Train Acc: 0.9904 | Val Loss: 0.1232, Val Acc: 0.9597
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9685

[OPTUNA] Trial #9: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.0001587934321073946, weight_decay=0.0002808840204696013
[INFO] >>> Starting fold 4 training (Trial #9) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2502, Train Acc: 0.9151 | Val Loss: 0.1325, Val Acc: 0.9572
[Fold 4 Epoch 2/20] Train Loss: 0.1097, Train Acc: 0.9631 | Val Loss: 0.1004, Val Acc: 0.9640
[Fold 4 Epoch 3/20] Train Loss: 0.0595, Train Acc: 0.9812 | Val Loss: 0.1089, Val Acc: 0.9637
[Fold 4 Epoch 4/20] Train Loss: 0.0593, Train Acc: 0.9809 | Val Loss: 0.1076, Val Acc: 0.9674
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9640

[OPTUNA] Trial #9: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.0001587934321073946, weight_decay=0.0002808840204696013
[INFO] >>> Starting fold 5 training (Trial #9) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2575, Train Acc: 0.9118 | Val Loss: 0.1421, Val Acc: 0.9506
[Fold 5 Epoch 2/20] Train Loss: 0.0916, Train Acc: 0.9691 | Val Loss: 0.1427, Val Acc: 0.9560
[Fold 5 Epoch 3/20] Train Loss: 0.0662, Train Acc: 0.9775 | Val Loss: 0.0895, Val Acc: 0.9691
[Fold 5 Epoch 4/20] Train Loss: 0.0525, Train Acc: 0.9840 | Val Loss: 0.0997, Val Acc: 0.9694
[Fold 5 Epoch 5/20] Train Loss: 0.0485, Train Acc: 0.9840 | Val Loss: 0.1282, Val Acc: 0.9643
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9694

[OPTUNA] Trial #9 done. Fold Accuracies: [0.9673758865248226, 0.9543262411347517, 0.9685106382978723, 0.9639716312056738, 0.9693617021276596]. Avg Acc=0.9647

[OPTUNA] Starting Trial #10 with lr=0.000061, weight_decay=0.000002
[OPTUNA] Trial #10: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=6.057439180345781e-05, weight_decay=1.56173875751773e-06
[INFO] >>> Starting fold 1 training (Trial #10) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3062, Train Acc: 0.8985 | Val Loss: 0.1126, Val Acc: 0.9603
[Fold 1 Epoch 2/20] Train Loss: 0.0830, Train Acc: 0.9721 | Val Loss: 0.1011, Val Acc: 0.9725
[Fold 1 Epoch 3/20] Train Loss: 0.0430, Train Acc: 0.9879 | Val Loss: 0.1030, Val Acc: 0.9694
[Fold 1 Epoch 4/20] Train Loss: 0.0230, Train Acc: 0.9931 | Val Loss: 0.0996, Val Acc: 0.9725
[Fold 1 Epoch 5/20] Train Loss: 0.0205, Train Acc: 0.9942 | Val Loss: 0.0987, Val Acc: 0.9699
[Fold 1 Epoch 6/20] Train Loss: 0.0140, Train Acc: 0.9960 | Val Loss: 0.0680, Val Acc: 0.9790
[Fold 1 Epoch 7/20] Train Loss: 0.0064, Train Acc: 0.9981 | Val Loss: 0.0998, Val Acc: 0.9767
[Fold 1 Epoch 8/20] Train Loss: 0.0085, Train Acc: 0.9971 | Val Loss: 0.1070, Val Acc: 0.9702
[INFO] Early stopping on fold 1 at epoch 8
[INFO] <<< Finished fold 1, best val acc = 0.9790

[OPTUNA] Trial #10: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=6.057439180345781e-05, weight_decay=1.56173875751773e-06
[INFO] >>> Starting fold 2 training (Trial #10) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2950, Train Acc: 0.8997 | Val Loss: 0.1174, Val Acc: 0.9609
[Fold 2 Epoch 2/20] Train Loss: 0.0775, Train Acc: 0.9763 | Val Loss: 0.0910, Val Acc: 0.9694
[Fold 2 Epoch 3/20] Train Loss: 0.0372, Train Acc: 0.9880 | Val Loss: 0.1138, Val Acc: 0.9623
[Fold 2 Epoch 4/20] Train Loss: 0.0166, Train Acc: 0.9951 | Val Loss: 0.0859, Val Acc: 0.9702
[Fold 2 Epoch 5/20] Train Loss: 0.0166, Train Acc: 0.9947 | Val Loss: 0.0961, Val Acc: 0.9711
[Fold 2 Epoch 6/20] Train Loss: 0.0204, Train Acc: 0.9941 | Val Loss: 0.1141, Val Acc: 0.9671
[INFO] Early stopping on fold 2 at epoch 6
[INFO] <<< Finished fold 2, best val acc = 0.9711

[OPTUNA] Trial #10: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=6.057439180345781e-05, weight_decay=1.56173875751773e-06
[INFO] >>> Starting fold 3 training (Trial #10) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2996, Train Acc: 0.9009 | Val Loss: 0.1189, Val Acc: 0.9626
[Fold 3 Epoch 2/20] Train Loss: 0.0753, Train Acc: 0.9745 | Val Loss: 0.1128, Val Acc: 0.9640
[Fold 3 Epoch 3/20] Train Loss: 0.0396, Train Acc: 0.9867 | Val Loss: 0.0857, Val Acc: 0.9716
[Fold 3 Epoch 4/20] Train Loss: 0.0231, Train Acc: 0.9926 | Val Loss: 0.0901, Val Acc: 0.9691
[Fold 3 Epoch 5/20] Train Loss: 0.0119, Train Acc: 0.9974 | Val Loss: 0.0775, Val Acc: 0.9784
[Fold 3 Epoch 6/20] Train Loss: 0.0095, Train Acc: 0.9973 | Val Loss: 0.1180, Val Acc: 0.9657
[Fold 3 Epoch 7/20] Train Loss: 0.0254, Train Acc: 0.9921 | Val Loss: 0.1089, Val Acc: 0.9665
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9784

[OPTUNA] Trial #10: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=6.057439180345781e-05, weight_decay=1.56173875751773e-06
[INFO] >>> Starting fold 4 training (Trial #10) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3051, Train Acc: 0.8992 | Val Loss: 0.1244, Val Acc: 0.9600
[Fold 4 Epoch 2/20] Train Loss: 0.0744, Train Acc: 0.9759 | Val Loss: 0.1060, Val Acc: 0.9643
[Fold 4 Epoch 3/20] Train Loss: 0.0348, Train Acc: 0.9891 | Val Loss: 0.0936, Val Acc: 0.9719
[Fold 4 Epoch 4/20] Train Loss: 0.0180, Train Acc: 0.9945 | Val Loss: 0.1037, Val Acc: 0.9708
[Fold 4 Epoch 5/20] Train Loss: 0.0233, Train Acc: 0.9926 | Val Loss: 0.1142, Val Acc: 0.9660
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9719

[OPTUNA] Trial #10: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=6.057439180345781e-05, weight_decay=1.56173875751773e-06
[INFO] >>> Starting fold 5 training (Trial #10) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2908, Train Acc: 0.9021 | Val Loss: 0.1247, Val Acc: 0.9580
[Fold 5 Epoch 2/20] Train Loss: 0.0759, Train Acc: 0.9760 | Val Loss: 0.0957, Val Acc: 0.9708
[Fold 5 Epoch 3/20] Train Loss: 0.0386, Train Acc: 0.9889 | Val Loss: 0.0715, Val Acc: 0.9728
[Fold 5 Epoch 4/20] Train Loss: 0.0152, Train Acc: 0.9955 | Val Loss: 0.0728, Val Acc: 0.9807
[Fold 5 Epoch 5/20] Train Loss: 0.0191, Train Acc: 0.9937 | Val Loss: 0.1137, Val Acc: 0.9679
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9807

[OPTUNA] Trial #10 done. Fold Accuracies: [0.9790070921985815, 0.971063829787234, 0.9784397163120567, 0.9719148936170213, 0.9807092198581561]. Avg Acc=0.9762

[OPTUNA] Starting Trial #11 with lr=0.000054, weight_decay=0.000001
[OPTUNA] Trial #11: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=5.3813433710895914e-05, weight_decay=1.0591035575312295e-06
[INFO] >>> Starting fold 1 training (Trial #11) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3114, Train Acc: 0.8991 | Val Loss: 0.1427, Val Acc: 0.9586
[Fold 1 Epoch 2/20] Train Loss: 0.0746, Train Acc: 0.9769 | Val Loss: 0.1244, Val Acc: 0.9640
[Fold 1 Epoch 3/20] Train Loss: 0.0322, Train Acc: 0.9907 | Val Loss: 0.0995, Val Acc: 0.9716
[Fold 1 Epoch 4/20] Train Loss: 0.0212, Train Acc: 0.9937 | Val Loss: 0.1029, Val Acc: 0.9722
[Fold 1 Epoch 5/20] Train Loss: 0.0132, Train Acc: 0.9962 | Val Loss: 0.1175, Val Acc: 0.9708
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9722

[OPTUNA] Trial #11: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=5.3813433710895914e-05, weight_decay=1.0591035575312295e-06
[INFO] >>> Starting fold 2 training (Trial #11) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3150, Train Acc: 0.8975 | Val Loss: 0.1180, Val Acc: 0.9591
[Fold 2 Epoch 2/20] Train Loss: 0.0735, Train Acc: 0.9768 | Val Loss: 0.0880, Val Acc: 0.9694
[Fold 2 Epoch 3/20] Train Loss: 0.0305, Train Acc: 0.9913 | Val Loss: 0.1057, Val Acc: 0.9671
[Fold 2 Epoch 4/20] Train Loss: 0.0243, Train Acc: 0.9930 | Val Loss: 0.0935, Val Acc: 0.9705
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9694

[OPTUNA] Trial #11: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=5.3813433710895914e-05, weight_decay=1.0591035575312295e-06
[INFO] >>> Starting fold 3 training (Trial #11) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3159, Train Acc: 0.8967 | Val Loss: 0.1105, Val Acc: 0.9580
[Fold 3 Epoch 2/20] Train Loss: 0.0708, Train Acc: 0.9775 | Val Loss: 0.1332, Val Acc: 0.9606
[Fold 3 Epoch 3/20] Train Loss: 0.0341, Train Acc: 0.9895 | Val Loss: 0.1047, Val Acc: 0.9677
[Fold 3 Epoch 4/20] Train Loss: 0.0205, Train Acc: 0.9943 | Val Loss: 0.0955, Val Acc: 0.9657
[Fold 3 Epoch 5/20] Train Loss: 0.0196, Train Acc: 0.9944 | Val Loss: 0.0757, Val Acc: 0.9748
[Fold 3 Epoch 6/20] Train Loss: 0.0201, Train Acc: 0.9942 | Val Loss: 0.1012, Val Acc: 0.9691
[Fold 3 Epoch 7/20] Train Loss: 0.0145, Train Acc: 0.9957 | Val Loss: 0.1394, Val Acc: 0.9637
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9748

[OPTUNA] Trial #11: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=5.3813433710895914e-05, weight_decay=1.0591035575312295e-06
[INFO] >>> Starting fold 4 training (Trial #11) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3253, Train Acc: 0.8908 | Val Loss: 0.1337, Val Acc: 0.9538
[Fold 4 Epoch 2/20] Train Loss: 0.0757, Train Acc: 0.9755 | Val Loss: 0.1088, Val Acc: 0.9611
[Fold 4 Epoch 3/20] Train Loss: 0.0375, Train Acc: 0.9889 | Val Loss: 0.1109, Val Acc: 0.9640
[Fold 4 Epoch 4/20] Train Loss: 0.0199, Train Acc: 0.9945 | Val Loss: 0.1095, Val Acc: 0.9662
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9640

[OPTUNA] Trial #11: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=5.3813433710895914e-05, weight_decay=1.0591035575312295e-06
[INFO] >>> Starting fold 5 training (Trial #11) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.3152, Train Acc: 0.8960 | Val Loss: 0.1122, Val Acc: 0.9614
[Fold 5 Epoch 2/20] Train Loss: 0.0730, Train Acc: 0.9768 | Val Loss: 0.0892, Val Acc: 0.9696
[Fold 5 Epoch 3/20] Train Loss: 0.0311, Train Acc: 0.9908 | Val Loss: 0.0965, Val Acc: 0.9691
[Fold 5 Epoch 4/20] Train Loss: 0.0152, Train Acc: 0.9962 | Val Loss: 0.0926, Val Acc: 0.9688
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9696

[OPTUNA] Trial #11 done. Fold Accuracies: [0.9721985815602837, 0.9693617021276596, 0.9747517730496454, 0.9639716312056738, 0.969645390070922]. Avg Acc=0.9700

[OPTUNA] Starting Trial #12 with lr=0.000050, weight_decay=0.000012
[OPTUNA] Trial #12: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=4.965355551902275e-05, weight_decay=1.1612263482444233e-05
[INFO] >>> Starting fold 1 training (Trial #12) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3132, Train Acc: 0.8965 | Val Loss: 0.1152, Val Acc: 0.9674
[Fold 1 Epoch 2/20] Train Loss: 0.0728, Train Acc: 0.9763 | Val Loss: 0.1016, Val Acc: 0.9665
[Fold 1 Epoch 3/20] Train Loss: 0.0357, Train Acc: 0.9899 | Val Loss: 0.0899, Val Acc: 0.9753
[Fold 1 Epoch 4/20] Train Loss: 0.0222, Train Acc: 0.9945 | Val Loss: 0.1099, Val Acc: 0.9748
[Fold 1 Epoch 5/20] Train Loss: 0.0125, Train Acc: 0.9967 | Val Loss: 0.1060, Val Acc: 0.9719
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9753

[OPTUNA] Trial #12: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=4.965355551902275e-05, weight_decay=1.1612263482444233e-05
[INFO] >>> Starting fold 2 training (Trial #12) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3154, Train Acc: 0.8957 | Val Loss: 0.1443, Val Acc: 0.9523
[Fold 2 Epoch 2/20] Train Loss: 0.0766, Train Acc: 0.9760 | Val Loss: 0.0772, Val Acc: 0.9742
[Fold 2 Epoch 3/20] Train Loss: 0.0303, Train Acc: 0.9916 | Val Loss: 0.1125, Val Acc: 0.9654
[Fold 2 Epoch 4/20] Train Loss: 0.0222, Train Acc: 0.9942 | Val Loss: 0.0804, Val Acc: 0.9730
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9742

[OPTUNA] Trial #12: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=4.965355551902275e-05, weight_decay=1.1612263482444233e-05
[INFO] >>> Starting fold 3 training (Trial #12) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3257, Train Acc: 0.8930 | Val Loss: 0.1203, Val Acc: 0.9591
[Fold 3 Epoch 2/20] Train Loss: 0.0690, Train Acc: 0.9799 | Val Loss: 0.0999, Val Acc: 0.9691
[Fold 3 Epoch 3/20] Train Loss: 0.0327, Train Acc: 0.9910 | Val Loss: 0.1257, Val Acc: 0.9597
[Fold 3 Epoch 4/20] Train Loss: 0.0220, Train Acc: 0.9942 | Val Loss: 0.1216, Val Acc: 0.9668
[INFO] Early stopping on fold 3 at epoch 4
[INFO] <<< Finished fold 3, best val acc = 0.9691

[OPTUNA] Trial #12: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=4.965355551902275e-05, weight_decay=1.1612263482444233e-05
[INFO] >>> Starting fold 4 training (Trial #12) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3129, Train Acc: 0.8977 | Val Loss: 0.1427, Val Acc: 0.9538
[Fold 4 Epoch 2/20] Train Loss: 0.0736, Train Acc: 0.9752 | Val Loss: 0.0982, Val Acc: 0.9674
[Fold 4 Epoch 3/20] Train Loss: 0.0294, Train Acc: 0.9916 | Val Loss: 0.1020, Val Acc: 0.9637
[Fold 4 Epoch 4/20] Train Loss: 0.0197, Train Acc: 0.9941 | Val Loss: 0.0969, Val Acc: 0.9696
[Fold 4 Epoch 5/20] Train Loss: 0.0164, Train Acc: 0.9952 | Val Loss: 0.1650, Val Acc: 0.9506
[Fold 4 Epoch 6/20] Train Loss: 0.0152, Train Acc: 0.9957 | Val Loss: 0.1359, Val Acc: 0.9634
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9696

[OPTUNA] Trial #12: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=4.965355551902275e-05, weight_decay=1.1612263482444233e-05
[INFO] >>> Starting fold 5 training (Trial #12) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.3152, Train Acc: 0.8938 | Val Loss: 0.1200, Val Acc: 0.9614
[Fold 5 Epoch 2/20] Train Loss: 0.0761, Train Acc: 0.9745 | Val Loss: 0.1138, Val Acc: 0.9594
[Fold 5 Epoch 3/20] Train Loss: 0.0292, Train Acc: 0.9918 | Val Loss: 0.1130, Val Acc: 0.9626
[Fold 5 Epoch 4/20] Train Loss: 0.0174, Train Acc: 0.9957 | Val Loss: 0.0948, Val Acc: 0.9728
[Fold 5 Epoch 5/20] Train Loss: 0.0195, Train Acc: 0.9948 | Val Loss: 0.1287, Val Acc: 0.9648
[Fold 5 Epoch 6/20] Train Loss: 0.0239, Train Acc: 0.9927 | Val Loss: 0.1025, Val Acc: 0.9711
[INFO] Early stopping on fold 5 at epoch 6
[INFO] <<< Finished fold 5, best val acc = 0.9728

[OPTUNA] Trial #12 done. Fold Accuracies: [0.9753191489361702, 0.9741843971631206, 0.9690780141843972, 0.969645390070922, 0.9727659574468085]. Avg Acc=0.9722

[OPTUNA] Starting Trial #13 with lr=0.000060, weight_decay=0.000013
[OPTUNA] Trial #13: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=6.025974579576775e-05, weight_decay=1.2811717237324344e-05
[INFO] >>> Starting fold 1 training (Trial #13) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3043, Train Acc: 0.8989 | Val Loss: 0.1125, Val Acc: 0.9597
[Fold 1 Epoch 2/20] Train Loss: 0.0734, Train Acc: 0.9761 | Val Loss: 0.0901, Val Acc: 0.9722
[Fold 1 Epoch 3/20] Train Loss: 0.0343, Train Acc: 0.9894 | Val Loss: 0.1104, Val Acc: 0.9657
[Fold 1 Epoch 4/20] Train Loss: 0.0210, Train Acc: 0.9943 | Val Loss: 0.1023, Val Acc: 0.9750
[INFO] Early stopping on fold 1 at epoch 4
[INFO] <<< Finished fold 1, best val acc = 0.9722

[OPTUNA] Trial #13: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=6.025974579576775e-05, weight_decay=1.2811717237324344e-05
[INFO] >>> Starting fold 2 training (Trial #13) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2867, Train Acc: 0.9082 | Val Loss: 0.1625, Val Acc: 0.9501
[Fold 2 Epoch 2/20] Train Loss: 0.0708, Train Acc: 0.9769 | Val Loss: 0.1127, Val Acc: 0.9591
[Fold 2 Epoch 3/20] Train Loss: 0.0305, Train Acc: 0.9914 | Val Loss: 0.0695, Val Acc: 0.9745
[Fold 2 Epoch 4/20] Train Loss: 0.0283, Train Acc: 0.9906 | Val Loss: 0.0980, Val Acc: 0.9702
[Fold 2 Epoch 5/20] Train Loss: 0.0223, Train Acc: 0.9928 | Val Loss: 0.1420, Val Acc: 0.9620
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9745

[OPTUNA] Trial #13: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=6.025974579576775e-05, weight_decay=1.2811717237324344e-05
[INFO] >>> Starting fold 3 training (Trial #13) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3068, Train Acc: 0.8991 | Val Loss: 0.1105, Val Acc: 0.9679
[Fold 3 Epoch 2/20] Train Loss: 0.0686, Train Acc: 0.9781 | Val Loss: 0.1273, Val Acc: 0.9591
[Fold 3 Epoch 3/20] Train Loss: 0.0337, Train Acc: 0.9894 | Val Loss: 0.0965, Val Acc: 0.9719
[Fold 3 Epoch 4/20] Train Loss: 0.0301, Train Acc: 0.9912 | Val Loss: 0.1695, Val Acc: 0.9620
[Fold 3 Epoch 5/20] Train Loss: 0.0213, Train Acc: 0.9949 | Val Loss: 0.0808, Val Acc: 0.9776
[Fold 3 Epoch 6/20] Train Loss: 0.0079, Train Acc: 0.9983 | Val Loss: 0.1009, Val Acc: 0.9713
[Fold 3 Epoch 7/20] Train Loss: 0.0111, Train Acc: 0.9971 | Val Loss: 0.1003, Val Acc: 0.9733
[INFO] Early stopping on fold 3 at epoch 7
[INFO] <<< Finished fold 3, best val acc = 0.9776

[OPTUNA] Trial #13: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=6.025974579576775e-05, weight_decay=1.2811717237324344e-05
[INFO] >>> Starting fold 4 training (Trial #13) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3047, Train Acc: 0.8996 | Val Loss: 0.1404, Val Acc: 0.9532
[Fold 4 Epoch 2/20] Train Loss: 0.0700, Train Acc: 0.9771 | Val Loss: 0.1258, Val Acc: 0.9591
[Fold 4 Epoch 3/20] Train Loss: 0.0334, Train Acc: 0.9897 | Val Loss: 0.1148, Val Acc: 0.9657
[Fold 4 Epoch 4/20] Train Loss: 0.0187, Train Acc: 0.9946 | Val Loss: 0.1181, Val Acc: 0.9682
[Fold 4 Epoch 5/20] Train Loss: 0.0246, Train Acc: 0.9923 | Val Loss: 0.1440, Val Acc: 0.9591
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9682

[OPTUNA] Trial #13: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=6.025974579576775e-05, weight_decay=1.2811717237324344e-05
[INFO] >>> Starting fold 5 training (Trial #13) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.3108, Train Acc: 0.8952 | Val Loss: 0.1451, Val Acc: 0.9512
[Fold 5 Epoch 2/20] Train Loss: 0.0762, Train Acc: 0.9761 | Val Loss: 0.0856, Val Acc: 0.9756
[Fold 5 Epoch 3/20] Train Loss: 0.0333, Train Acc: 0.9897 | Val Loss: 0.0877, Val Acc: 0.9702
[Fold 5 Epoch 4/20] Train Loss: 0.0269, Train Acc: 0.9916 | Val Loss: 0.1058, Val Acc: 0.9694
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9756

[OPTUNA] Trial #13 done. Fold Accuracies: [0.9721985815602837, 0.9744680851063829, 0.9775886524822694, 0.9682269503546099, 0.9756028368794326]. Avg Acc=0.9736

[OPTUNA] Starting Trial #14 with lr=0.000074, weight_decay=0.000018
[OPTUNA] Trial #14: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=7.417696402475715e-05, weight_decay=1.8018265048631195e-05
[INFO] >>> Starting fold 1 training (Trial #14) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2854, Train Acc: 0.9044 | Val Loss: 0.1189, Val Acc: 0.9611
[Fold 1 Epoch 2/20] Train Loss: 0.0794, Train Acc: 0.9744 | Val Loss: 0.1165, Val Acc: 0.9577
[Fold 1 Epoch 3/20] Train Loss: 0.0414, Train Acc: 0.9881 | Val Loss: 0.0805, Val Acc: 0.9748
[Fold 1 Epoch 4/20] Train Loss: 0.0273, Train Acc: 0.9916 | Val Loss: 0.1240, Val Acc: 0.9657
[Fold 1 Epoch 5/20] Train Loss: 0.0223, Train Acc: 0.9928 | Val Loss: 0.0960, Val Acc: 0.9722
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9748

[OPTUNA] Trial #14: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=7.417696402475715e-05, weight_decay=1.8018265048631195e-05
[INFO] >>> Starting fold 2 training (Trial #14) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2861, Train Acc: 0.9030 | Val Loss: 0.1179, Val Acc: 0.9606
[Fold 2 Epoch 2/20] Train Loss: 0.0789, Train Acc: 0.9739 | Val Loss: 0.1187, Val Acc: 0.9586
[Fold 2 Epoch 3/20] Train Loss: 0.0416, Train Acc: 0.9867 | Val Loss: 0.0898, Val Acc: 0.9696
[Fold 2 Epoch 4/20] Train Loss: 0.0236, Train Acc: 0.9933 | Val Loss: 0.1084, Val Acc: 0.9651
[Fold 2 Epoch 5/20] Train Loss: 0.0152, Train Acc: 0.9960 | Val Loss: 0.1124, Val Acc: 0.9711
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9696

[OPTUNA] Trial #14: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=7.417696402475715e-05, weight_decay=1.8018265048631195e-05
[INFO] >>> Starting fold 3 training (Trial #14) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2925, Train Acc: 0.8984 | Val Loss: 0.1608, Val Acc: 0.9538
[Fold 3 Epoch 2/20] Train Loss: 0.0825, Train Acc: 0.9728 | Val Loss: 0.1052, Val Acc: 0.9654
[Fold 3 Epoch 3/20] Train Loss: 0.0398, Train Acc: 0.9872 | Val Loss: 0.1684, Val Acc: 0.9606
[Fold 3 Epoch 4/20] Train Loss: 0.0250, Train Acc: 0.9921 | Val Loss: 0.0726, Val Acc: 0.9784
[Fold 3 Epoch 5/20] Train Loss: 0.0218, Train Acc: 0.9933 | Val Loss: 0.0805, Val Acc: 0.9770
[Fold 3 Epoch 6/20] Train Loss: 0.0233, Train Acc: 0.9942 | Val Loss: 0.0906, Val Acc: 0.9691
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val acc = 0.9784

[OPTUNA] Trial #14: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=7.417696402475715e-05, weight_decay=1.8018265048631195e-05
[INFO] >>> Starting fold 4 training (Trial #14) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2765, Train Acc: 0.9060 | Val Loss: 0.1275, Val Acc: 0.9557
[Fold 4 Epoch 2/20] Train Loss: 0.0695, Train Acc: 0.9771 | Val Loss: 0.1098, Val Acc: 0.9648
[Fold 4 Epoch 3/20] Train Loss: 0.0382, Train Acc: 0.9884 | Val Loss: 0.1316, Val Acc: 0.9623
[Fold 4 Epoch 4/20] Train Loss: 0.0345, Train Acc: 0.9894 | Val Loss: 0.1022, Val Acc: 0.9671
[Fold 4 Epoch 5/20] Train Loss: 0.0199, Train Acc: 0.9944 | Val Loss: 0.0957, Val Acc: 0.9713
[Fold 4 Epoch 6/20] Train Loss: 0.0142, Train Acc: 0.9963 | Val Loss: 0.1109, Val Acc: 0.9660
[Fold 4 Epoch 7/20] Train Loss: 0.0138, Train Acc: 0.9957 | Val Loss: 0.1353, Val Acc: 0.9654
[INFO] Early stopping on fold 4 at epoch 7
[INFO] <<< Finished fold 4, best val acc = 0.9713

[OPTUNA] Trial #14: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=7.417696402475715e-05, weight_decay=1.8018265048631195e-05
[INFO] >>> Starting fold 5 training (Trial #14) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2819, Train Acc: 0.9036 | Val Loss: 0.1097, Val Acc: 0.9648
[Fold 5 Epoch 2/20] Train Loss: 0.0742, Train Acc: 0.9757 | Val Loss: 0.1022, Val Acc: 0.9685
[Fold 5 Epoch 3/20] Train Loss: 0.0479, Train Acc: 0.9853 | Val Loss: 0.0993, Val Acc: 0.9688
[Fold 5 Epoch 4/20] Train Loss: 0.0266, Train Acc: 0.9927 | Val Loss: 0.0878, Val Acc: 0.9725
[Fold 5 Epoch 5/20] Train Loss: 0.0168, Train Acc: 0.9958 | Val Loss: 0.0865, Val Acc: 0.9736
[Fold 5 Epoch 6/20] Train Loss: 0.0160, Train Acc: 0.9953 | Val Loss: 0.1381, Val Acc: 0.9603
[Fold 5 Epoch 7/20] Train Loss: 0.0191, Train Acc: 0.9935 | Val Loss: 0.1054, Val Acc: 0.9648
[INFO] Early stopping on fold 5 at epoch 7
[INFO] <<< Finished fold 5, best val acc = 0.9736

[OPTUNA] Trial #14 done. Fold Accuracies: [0.9747517730496454, 0.969645390070922, 0.9784397163120567, 0.9713475177304964, 0.9736170212765958]. Avg Acc=0.9736

[OPTUNA] Starting Trial #15 with lr=0.000032, weight_decay=0.000005
[OPTUNA] Trial #15: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=3.2278844700562526e-05, weight_decay=4.755093610331608e-06
[INFO] >>> Starting fold 1 training (Trial #15) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3931, Train Acc: 0.8745 | Val Loss: 0.1230, Val Acc: 0.9580
[Fold 1 Epoch 2/20] Train Loss: 0.0829, Train Acc: 0.9758 | Val Loss: 0.1030, Val Acc: 0.9640
[Fold 1 Epoch 3/20] Train Loss: 0.0344, Train Acc: 0.9894 | Val Loss: 0.1261, Val Acc: 0.9665
[Fold 1 Epoch 4/20] Train Loss: 0.0207, Train Acc: 0.9942 | Val Loss: 0.0909, Val Acc: 0.9722
[Fold 1 Epoch 5/20] Train Loss: 0.0172, Train Acc: 0.9956 | Val Loss: 0.0718, Val Acc: 0.9779
[Fold 1 Epoch 6/20] Train Loss: 0.0065, Train Acc: 0.9987 | Val Loss: 0.1250, Val Acc: 0.9657
[Fold 1 Epoch 7/20] Train Loss: 0.0077, Train Acc: 0.9981 | Val Loss: 0.0884, Val Acc: 0.9733
[INFO] Early stopping on fold 1 at epoch 7
[INFO] <<< Finished fold 1, best val acc = 0.9779

[OPTUNA] Trial #15: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=3.2278844700562526e-05, weight_decay=4.755093610331608e-06
[INFO] >>> Starting fold 2 training (Trial #15) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3912, Train Acc: 0.8716 | Val Loss: 0.1271, Val Acc: 0.9617
[Fold 2 Epoch 2/20] Train Loss: 0.0883, Train Acc: 0.9721 | Val Loss: 0.0919, Val Acc: 0.9711
[Fold 2 Epoch 3/20] Train Loss: 0.0316, Train Acc: 0.9916 | Val Loss: 0.0876, Val Acc: 0.9702
[Fold 2 Epoch 4/20] Train Loss: 0.0142, Train Acc: 0.9971 | Val Loss: 0.0773, Val Acc: 0.9722
[Fold 2 Epoch 5/20] Train Loss: 0.0090, Train Acc: 0.9983 | Val Loss: 0.1096, Val Acc: 0.9662
[Fold 2 Epoch 6/20] Train Loss: 0.0127, Train Acc: 0.9972 | Val Loss: 0.0947, Val Acc: 0.9691
[INFO] Early stopping on fold 2 at epoch 6
[INFO] <<< Finished fold 2, best val acc = 0.9722

[OPTUNA] Trial #15: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=3.2278844700562526e-05, weight_decay=4.755093610331608e-06
[INFO] >>> Starting fold 3 training (Trial #15) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3859, Train Acc: 0.8777 | Val Loss: 0.1268, Val Acc: 0.9614
[Fold 3 Epoch 2/20] Train Loss: 0.0828, Train Acc: 0.9760 | Val Loss: 0.0893, Val Acc: 0.9699
[Fold 3 Epoch 3/20] Train Loss: 0.0325, Train Acc: 0.9906 | Val Loss: 0.0859, Val Acc: 0.9705
[Fold 3 Epoch 4/20] Train Loss: 0.0138, Train Acc: 0.9971 | Val Loss: 0.0883, Val Acc: 0.9682
[Fold 3 Epoch 5/20] Train Loss: 0.0114, Train Acc: 0.9973 | Val Loss: 0.1087, Val Acc: 0.9699
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9705

[OPTUNA] Trial #15: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=3.2278844700562526e-05, weight_decay=4.755093610331608e-06
[INFO] >>> Starting fold 4 training (Trial #15) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3866, Train Acc: 0.8773 | Val Loss: 0.1386, Val Acc: 0.9555
[Fold 4 Epoch 2/20] Train Loss: 0.0799, Train Acc: 0.9747 | Val Loss: 0.1070, Val Acc: 0.9662
[Fold 4 Epoch 3/20] Train Loss: 0.0317, Train Acc: 0.9915 | Val Loss: 0.1139, Val Acc: 0.9631
[Fold 4 Epoch 4/20] Train Loss: 0.0143, Train Acc: 0.9966 | Val Loss: 0.1155, Val Acc: 0.9654
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9662

[OPTUNA] Trial #15: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=3.2278844700562526e-05, weight_decay=4.755093610331608e-06
[INFO] >>> Starting fold 5 training (Trial #15) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.3806, Train Acc: 0.8781 | Val Loss: 0.1260, Val Acc: 0.9572
[Fold 5 Epoch 2/20] Train Loss: 0.0857, Train Acc: 0.9721 | Val Loss: 0.1029, Val Acc: 0.9634
[Fold 5 Epoch 3/20] Train Loss: 0.0299, Train Acc: 0.9926 | Val Loss: 0.0982, Val Acc: 0.9617
[Fold 5 Epoch 4/20] Train Loss: 0.0149, Train Acc: 0.9967 | Val Loss: 0.0999, Val Acc: 0.9699
[Fold 5 Epoch 5/20] Train Loss: 0.0097, Train Acc: 0.9978 | Val Loss: 0.0970, Val Acc: 0.9725
[Fold 5 Epoch 6/20] Train Loss: 0.0116, Train Acc: 0.9969 | Val Loss: 0.1237, Val Acc: 0.9665
[Fold 5 Epoch 7/20] Train Loss: 0.0119, Train Acc: 0.9963 | Val Loss: 0.0954, Val Acc: 0.9708
[Fold 5 Epoch 8/20] Train Loss: 0.0126, Train Acc: 0.9972 | Val Loss: 0.1123, Val Acc: 0.9685
[Fold 5 Epoch 9/20] Train Loss: 0.0087, Train Acc: 0.9979 | Val Loss: 0.1152, Val Acc: 0.9671
[INFO] Early stopping on fold 5 at epoch 9
[INFO] <<< Finished fold 5, best val acc = 0.9725

[OPTUNA] Trial #15 done. Fold Accuracies: [0.977872340425532, 0.9721985815602837, 0.9704964539007093, 0.9662411347517731, 0.9724822695035461]. Avg Acc=0.9719

[OPTUNA] Starting Trial #16 with lr=0.000144, weight_decay=0.000004
[OPTUNA] Trial #16: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=0.00014449945412563613, weight_decay=4.2640983108779306e-06
[INFO] >>> Starting fold 1 training (Trial #16) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2621, Train Acc: 0.9126 | Val Loss: 0.1511, Val Acc: 0.9572
[Fold 1 Epoch 2/20] Train Loss: 0.0925, Train Acc: 0.9688 | Val Loss: 0.1336, Val Acc: 0.9577
[Fold 1 Epoch 3/20] Train Loss: 0.0625, Train Acc: 0.9808 | Val Loss: 0.1254, Val Acc: 0.9648
[Fold 1 Epoch 4/20] Train Loss: 0.0398, Train Acc: 0.9877 | Val Loss: 0.0987, Val Acc: 0.9696
[Fold 1 Epoch 5/20] Train Loss: 0.0306, Train Acc: 0.9894 | Val Loss: 0.1124, Val Acc: 0.9688
[Fold 1 Epoch 6/20] Train Loss: 0.0311, Train Acc: 0.9901 | Val Loss: 0.1035, Val Acc: 0.9711
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9696

[OPTUNA] Trial #16: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=0.00014449945412563613, weight_decay=4.2640983108779306e-06
[INFO] >>> Starting fold 2 training (Trial #16) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2531, Train Acc: 0.9149 | Val Loss: 0.1179, Val Acc: 0.9623
[Fold 2 Epoch 2/20] Train Loss: 0.0915, Train Acc: 0.9692 | Val Loss: 0.0987, Val Acc: 0.9665
[Fold 2 Epoch 3/20] Train Loss: 0.0622, Train Acc: 0.9782 | Val Loss: 0.1185, Val Acc: 0.9620
[Fold 2 Epoch 4/20] Train Loss: 0.0384, Train Acc: 0.9882 | Val Loss: 0.1054, Val Acc: 0.9671
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9665

[OPTUNA] Trial #16: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=0.00014449945412563613, weight_decay=4.2640983108779306e-06
[INFO] >>> Starting fold 3 training (Trial #16) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2521, Train Acc: 0.9169 | Val Loss: 0.1318, Val Acc: 0.9560
[Fold 3 Epoch 2/20] Train Loss: 0.0901, Train Acc: 0.9696 | Val Loss: 0.1235, Val Acc: 0.9611
[Fold 3 Epoch 3/20] Train Loss: 0.0613, Train Acc: 0.9789 | Val Loss: 0.0915, Val Acc: 0.9679
[Fold 3 Epoch 4/20] Train Loss: 0.0473, Train Acc: 0.9846 | Val Loss: 0.0820, Val Acc: 0.9699
[Fold 3 Epoch 5/20] Train Loss: 0.0302, Train Acc: 0.9906 | Val Loss: 0.1304, Val Acc: 0.9654
[Fold 3 Epoch 6/20] Train Loss: 0.0298, Train Acc: 0.9902 | Val Loss: 0.1030, Val Acc: 0.9694
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val acc = 0.9699

[OPTUNA] Trial #16: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=0.00014449945412563613, weight_decay=4.2640983108779306e-06
[INFO] >>> Starting fold 4 training (Trial #16) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2538, Train Acc: 0.9133 | Val Loss: 0.1365, Val Acc: 0.9540
[Fold 4 Epoch 2/20] Train Loss: 0.0966, Train Acc: 0.9670 | Val Loss: 0.1316, Val Acc: 0.9566
[Fold 4 Epoch 3/20] Train Loss: 0.0541, Train Acc: 0.9821 | Val Loss: 0.0950, Val Acc: 0.9702
[Fold 4 Epoch 4/20] Train Loss: 0.0367, Train Acc: 0.9879 | Val Loss: 0.1006, Val Acc: 0.9671
[Fold 4 Epoch 5/20] Train Loss: 0.0314, Train Acc: 0.9894 | Val Loss: 0.0986, Val Acc: 0.9711
[INFO] Early stopping on fold 4 at epoch 5
[INFO] <<< Finished fold 4, best val acc = 0.9702

[OPTUNA] Trial #16: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=0.00014449945412563613, weight_decay=4.2640983108779306e-06
[INFO] >>> Starting fold 5 training (Trial #16) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2558, Train Acc: 0.9089 | Val Loss: 0.1291, Val Acc: 0.9580
[Fold 5 Epoch 2/20] Train Loss: 0.0880, Train Acc: 0.9703 | Val Loss: 0.1273, Val Acc: 0.9586
[Fold 5 Epoch 3/20] Train Loss: 0.0603, Train Acc: 0.9801 | Val Loss: 0.0896, Val Acc: 0.9713
[Fold 5 Epoch 4/20] Train Loss: 0.0401, Train Acc: 0.9862 | Val Loss: 0.1290, Val Acc: 0.9620
[Fold 5 Epoch 5/20] Train Loss: 0.0332, Train Acc: 0.9894 | Val Loss: 0.1067, Val Acc: 0.9691
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9713

[OPTUNA] Trial #16 done. Fold Accuracies: [0.969645390070922, 0.9665248226950355, 0.9699290780141844, 0.9702127659574468, 0.9713475177304964]. Avg Acc=0.9695

[OPTUNA] Starting Trial #17 with lr=0.000098, weight_decay=0.000026
[OPTUNA] Trial #17: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=9.8360232335757e-05, weight_decay=2.610106594997609e-05
[INFO] >>> Starting fold 1 training (Trial #17) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.2656, Train Acc: 0.9107 | Val Loss: 0.1180, Val Acc: 0.9705
[Fold 1 Epoch 2/20] Train Loss: 0.0774, Train Acc: 0.9736 | Val Loss: 0.1384, Val Acc: 0.9637
[Fold 1 Epoch 3/20] Train Loss: 0.0513, Train Acc: 0.9825 | Val Loss: 0.0929, Val Acc: 0.9716
[Fold 1 Epoch 4/20] Train Loss: 0.0374, Train Acc: 0.9882 | Val Loss: 0.0698, Val Acc: 0.9753
[Fold 1 Epoch 5/20] Train Loss: 0.0307, Train Acc: 0.9911 | Val Loss: 0.1184, Val Acc: 0.9645
[Fold 1 Epoch 6/20] Train Loss: 0.0226, Train Acc: 0.9928 | Val Loss: 0.1108, Val Acc: 0.9699
[INFO] Early stopping on fold 1 at epoch 6
[INFO] <<< Finished fold 1, best val acc = 0.9753

[OPTUNA] Trial #17: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=9.8360232335757e-05, weight_decay=2.610106594997609e-05
[INFO] >>> Starting fold 2 training (Trial #17) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.2718, Train Acc: 0.9048 | Val Loss: 0.1502, Val Acc: 0.9549
[Fold 2 Epoch 2/20] Train Loss: 0.0850, Train Acc: 0.9728 | Val Loss: 0.0910, Val Acc: 0.9651
[Fold 2 Epoch 3/20] Train Loss: 0.0436, Train Acc: 0.9860 | Val Loss: 0.0937, Val Acc: 0.9699
[Fold 2 Epoch 4/20] Train Loss: 0.0321, Train Acc: 0.9892 | Val Loss: 0.0927, Val Acc: 0.9688
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9699

[OPTUNA] Trial #17: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=9.8360232335757e-05, weight_decay=2.610106594997609e-05
[INFO] >>> Starting fold 3 training (Trial #17) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.2752, Train Acc: 0.9062 | Val Loss: 0.1584, Val Acc: 0.9489
[Fold 3 Epoch 2/20] Train Loss: 0.0755, Train Acc: 0.9748 | Val Loss: 0.0966, Val Acc: 0.9713
[Fold 3 Epoch 3/20] Train Loss: 0.0471, Train Acc: 0.9844 | Val Loss: 0.0897, Val Acc: 0.9682
[Fold 3 Epoch 4/20] Train Loss: 0.0327, Train Acc: 0.9897 | Val Loss: 0.0996, Val Acc: 0.9725
[Fold 3 Epoch 5/20] Train Loss: 0.0328, Train Acc: 0.9896 | Val Loss: 0.0939, Val Acc: 0.9671
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9725

[OPTUNA] Trial #17: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=9.8360232335757e-05, weight_decay=2.610106594997609e-05
[INFO] >>> Starting fold 4 training (Trial #17) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.2673, Train Acc: 0.9104 | Val Loss: 0.1394, Val Acc: 0.9538
[Fold 4 Epoch 2/20] Train Loss: 0.0831, Train Acc: 0.9728 | Val Loss: 0.1128, Val Acc: 0.9623
[Fold 4 Epoch 3/20] Train Loss: 0.0455, Train Acc: 0.9855 | Val Loss: 0.1209, Val Acc: 0.9611
[Fold 4 Epoch 4/20] Train Loss: 0.0299, Train Acc: 0.9911 | Val Loss: 0.1541, Val Acc: 0.9580
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9623

[OPTUNA] Trial #17: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=9.8360232335757e-05, weight_decay=2.610106594997609e-05
[INFO] >>> Starting fold 5 training (Trial #17) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2608, Train Acc: 0.9105 | Val Loss: 0.1823, Val Acc: 0.9523
[Fold 5 Epoch 2/20] Train Loss: 0.0844, Train Acc: 0.9726 | Val Loss: 0.0930, Val Acc: 0.9728
[Fold 5 Epoch 3/20] Train Loss: 0.0576, Train Acc: 0.9804 | Val Loss: 0.0737, Val Acc: 0.9736
[Fold 5 Epoch 4/20] Train Loss: 0.0220, Train Acc: 0.9935 | Val Loss: 0.1049, Val Acc: 0.9699
[Fold 5 Epoch 5/20] Train Loss: 0.0332, Train Acc: 0.9891 | Val Loss: 0.1146, Val Acc: 0.9691
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9736

[OPTUNA] Trial #17 done. Fold Accuracies: [0.9753191489361702, 0.9699290780141844, 0.9724822695035461, 0.9622695035460993, 0.9736170212765958]. Avg Acc=0.9707

[OPTUNA] Starting Trial #18 with lr=0.000031, weight_decay=0.000060
[OPTUNA] Trial #18: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=3.1387331074857426e-05, weight_decay=6.0119226252369804e-05
[INFO] >>> Starting fold 1 training (Trial #18) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.4057, Train Acc: 0.8674 | Val Loss: 0.1302, Val Acc: 0.9583
[Fold 1 Epoch 2/20] Train Loss: 0.0884, Train Acc: 0.9723 | Val Loss: 0.0998, Val Acc: 0.9668
[Fold 1 Epoch 3/20] Train Loss: 0.0324, Train Acc: 0.9913 | Val Loss: 0.1092, Val Acc: 0.9679
[Fold 1 Epoch 4/20] Train Loss: 0.0165, Train Acc: 0.9962 | Val Loss: 0.1150, Val Acc: 0.9648
[INFO] Early stopping on fold 1 at epoch 4
[INFO] <<< Finished fold 1, best val acc = 0.9679

[OPTUNA] Trial #18: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=3.1387331074857426e-05, weight_decay=6.0119226252369804e-05
[INFO] >>> Starting fold 2 training (Trial #18) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.4021, Train Acc: 0.8700 | Val Loss: 0.1406, Val Acc: 0.9557
[Fold 2 Epoch 2/20] Train Loss: 0.0919, Train Acc: 0.9716 | Val Loss: 0.0854, Val Acc: 0.9705
[Fold 2 Epoch 3/20] Train Loss: 0.0361, Train Acc: 0.9900 | Val Loss: 0.0889, Val Acc: 0.9685
[Fold 2 Epoch 4/20] Train Loss: 0.0154, Train Acc: 0.9967 | Val Loss: 0.1008, Val Acc: 0.9640
[INFO] Early stopping on fold 2 at epoch 4
[INFO] <<< Finished fold 2, best val acc = 0.9705

[OPTUNA] Trial #18: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=3.1387331074857426e-05, weight_decay=6.0119226252369804e-05
[INFO] >>> Starting fold 3 training (Trial #18) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3952, Train Acc: 0.8705 | Val Loss: 0.1231, Val Acc: 0.9643
[Fold 3 Epoch 2/20] Train Loss: 0.0837, Train Acc: 0.9743 | Val Loss: 0.1033, Val Acc: 0.9651
[Fold 3 Epoch 3/20] Train Loss: 0.0319, Train Acc: 0.9926 | Val Loss: 0.0986, Val Acc: 0.9674
[Fold 3 Epoch 4/20] Train Loss: 0.0164, Train Acc: 0.9967 | Val Loss: 0.0939, Val Acc: 0.9679
[Fold 3 Epoch 5/20] Train Loss: 0.0103, Train Acc: 0.9977 | Val Loss: 0.1007, Val Acc: 0.9665
[Fold 3 Epoch 6/20] Train Loss: 0.0070, Train Acc: 0.9987 | Val Loss: 0.1044, Val Acc: 0.9711
[INFO] Early stopping on fold 3 at epoch 6
[INFO] <<< Finished fold 3, best val acc = 0.9679

[OPTUNA] Trial #18: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=3.1387331074857426e-05, weight_decay=6.0119226252369804e-05
[INFO] >>> Starting fold 4 training (Trial #18) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3826, Train Acc: 0.8774 | Val Loss: 0.1386, Val Acc: 0.9523
[Fold 4 Epoch 2/20] Train Loss: 0.0849, Train Acc: 0.9737 | Val Loss: 0.1009, Val Acc: 0.9654
[Fold 4 Epoch 3/20] Train Loss: 0.0311, Train Acc: 0.9923 | Val Loss: 0.1270, Val Acc: 0.9620
[Fold 4 Epoch 4/20] Train Loss: 0.0198, Train Acc: 0.9952 | Val Loss: 0.1136, Val Acc: 0.9668
[INFO] Early stopping on fold 4 at epoch 4
[INFO] <<< Finished fold 4, best val acc = 0.9654

[OPTUNA] Trial #18: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=3.1387331074857426e-05, weight_decay=6.0119226252369804e-05
[INFO] >>> Starting fold 5 training (Trial #18) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.3932, Train Acc: 0.8728 | Val Loss: 0.1222, Val Acc: 0.9626
[Fold 5 Epoch 2/20] Train Loss: 0.0858, Train Acc: 0.9721 | Val Loss: 0.0991, Val Acc: 0.9677
[Fold 5 Epoch 3/20] Train Loss: 0.0259, Train Acc: 0.9940 | Val Loss: 0.1017, Val Acc: 0.9671
[Fold 5 Epoch 4/20] Train Loss: 0.0147, Train Acc: 0.9965 | Val Loss: 0.1012, Val Acc: 0.9694
[INFO] Early stopping on fold 5 at epoch 4
[INFO] <<< Finished fold 5, best val acc = 0.9677

[OPTUNA] Trial #18 done. Fold Accuracies: [0.9679432624113475, 0.9704964539007093, 0.9679432624113475, 0.9653900709219858, 0.9676595744680851]. Avg Acc=0.9679

[OPTUNA] Starting Trial #19 with lr=0.000058, weight_decay=0.000012
[OPTUNA] Trial #19: Starting fold 1/5
[DEBUG] Creating ResNet50 with lr=5.8051573684255805e-05, weight_decay=1.1630691441788127e-05
[INFO] >>> Starting fold 1 training (Trial #19) for 20 epochs...
[Fold 1 Epoch 1/20] Train Loss: 0.3120, Train Acc: 0.8974 | Val Loss: 0.1356, Val Acc: 0.9504
[Fold 1 Epoch 2/20] Train Loss: 0.0758, Train Acc: 0.9756 | Val Loss: 0.0848, Val Acc: 0.9660
[Fold 1 Epoch 3/20] Train Loss: 0.0326, Train Acc: 0.9910 | Val Loss: 0.0787, Val Acc: 0.9725
[Fold 1 Epoch 4/20] Train Loss: 0.0233, Train Acc: 0.9931 | Val Loss: 0.1050, Val Acc: 0.9688
[Fold 1 Epoch 5/20] Train Loss: 0.0243, Train Acc: 0.9930 | Val Loss: 0.1127, Val Acc: 0.9733
[INFO] Early stopping on fold 1 at epoch 5
[INFO] <<< Finished fold 1, best val acc = 0.9725

[OPTUNA] Trial #19: Starting fold 2/5
[DEBUG] Creating ResNet50 with lr=5.8051573684255805e-05, weight_decay=1.1630691441788127e-05
[INFO] >>> Starting fold 2 training (Trial #19) for 20 epochs...
[Fold 2 Epoch 1/20] Train Loss: 0.3017, Train Acc: 0.9031 | Val Loss: 0.1077, Val Acc: 0.9626
[Fold 2 Epoch 2/20] Train Loss: 0.0776, Train Acc: 0.9752 | Val Loss: 0.0946, Val Acc: 0.9648
[Fold 2 Epoch 3/20] Train Loss: 0.0344, Train Acc: 0.9896 | Val Loss: 0.0910, Val Acc: 0.9657
[Fold 2 Epoch 4/20] Train Loss: 0.0208, Train Acc: 0.9938 | Val Loss: 0.1243, Val Acc: 0.9634
[Fold 2 Epoch 5/20] Train Loss: 0.0206, Train Acc: 0.9940 | Val Loss: 0.1201, Val Acc: 0.9643
[INFO] Early stopping on fold 2 at epoch 5
[INFO] <<< Finished fold 2, best val acc = 0.9657

[OPTUNA] Trial #19: Starting fold 3/5
[DEBUG] Creating ResNet50 with lr=5.8051573684255805e-05, weight_decay=1.1630691441788127e-05
[INFO] >>> Starting fold 3 training (Trial #19) for 20 epochs...
[Fold 3 Epoch 1/20] Train Loss: 0.3150, Train Acc: 0.8944 | Val Loss: 0.1032, Val Acc: 0.9688
[Fold 3 Epoch 2/20] Train Loss: 0.0719, Train Acc: 0.9765 | Val Loss: 0.1062, Val Acc: 0.9657
[Fold 3 Epoch 3/20] Train Loss: 0.0410, Train Acc: 0.9877 | Val Loss: 0.0742, Val Acc: 0.9725
[Fold 3 Epoch 4/20] Train Loss: 0.0198, Train Acc: 0.9938 | Val Loss: 0.0746, Val Acc: 0.9756
[Fold 3 Epoch 5/20] Train Loss: 0.0289, Train Acc: 0.9923 | Val Loss: 0.0926, Val Acc: 0.9708
[INFO] Early stopping on fold 3 at epoch 5
[INFO] <<< Finished fold 3, best val acc = 0.9756

[OPTUNA] Trial #19: Starting fold 4/5
[DEBUG] Creating ResNet50 with lr=5.8051573684255805e-05, weight_decay=1.1630691441788127e-05
[INFO] >>> Starting fold 4 training (Trial #19) for 20 epochs...
[Fold 4 Epoch 1/20] Train Loss: 0.3118, Train Acc: 0.8962 | Val Loss: 0.1394, Val Acc: 0.9543
[Fold 4 Epoch 2/20] Train Loss: 0.0739, Train Acc: 0.9767 | Val Loss: 0.1070, Val Acc: 0.9631
[Fold 4 Epoch 3/20] Train Loss: 0.0343, Train Acc: 0.9894 | Val Loss: 0.1077, Val Acc: 0.9617
[Fold 4 Epoch 4/20] Train Loss: 0.0230, Train Acc: 0.9931 | Val Loss: 0.0989, Val Acc: 0.9648
[Fold 4 Epoch 5/20] Train Loss: 0.0123, Train Acc: 0.9967 | Val Loss: 0.1327, Val Acc: 0.9617
[Fold 4 Epoch 6/20] Train Loss: 0.0170, Train Acc: 0.9949 | Val Loss: 0.1060, Val Acc: 0.9637
[INFO] Early stopping on fold 4 at epoch 6
[INFO] <<< Finished fold 4, best val acc = 0.9648

[OPTUNA] Trial #19: Starting fold 5/5
[DEBUG] Creating ResNet50 with lr=5.8051573684255805e-05, weight_decay=1.1630691441788127e-05
[INFO] >>> Starting fold 5 training (Trial #19) for 20 epochs...
[Fold 5 Epoch 1/20] Train Loss: 0.2977, Train Acc: 0.8996 | Val Loss: 0.0907, Val Acc: 0.9725
[Fold 5 Epoch 2/20] Train Loss: 0.0719, Train Acc: 0.9781 | Val Loss: 0.1135, Val Acc: 0.9660
[Fold 5 Epoch 3/20] Train Loss: 0.0300, Train Acc: 0.9906 | Val Loss: 0.0839, Val Acc: 0.9750
[Fold 5 Epoch 4/20] Train Loss: 0.0254, Train Acc: 0.9925 | Val Loss: 0.1068, Val Acc: 0.9728
[Fold 5 Epoch 5/20] Train Loss: 0.0232, Train Acc: 0.9933 | Val Loss: 0.1256, Val Acc: 0.9589
[INFO] Early stopping on fold 5 at epoch 5
[INFO] <<< Finished fold 5, best val acc = 0.9750

[OPTUNA] Trial #19 done. Fold Accuracies: [0.9724822695035461, 0.9656737588652482, 0.9756028368794326, 0.964822695035461, 0.9750354609929078]. Avg Acc=0.9707
[OPTUNA] Best trial found:
  Trial number: 10
  Avg k-fold acc: 0.9762
    lr: 6.057439180345781e-05
    weight_decay: 1.56173875751773e-06

[INFO] Retraining final model on entire training set using best hyperparams...
[DEBUG] Creating ResNet50 with lr=6.057439180345781e-05, weight_decay=1.56173875751773e-06
[Final Train] Epoch 1/5 - Loss: 0.2646, Acc: 0.9138
[Final Train] Epoch 2/5 - Loss: 0.0716, Acc: 0.9766
[Final Train] Epoch 3/5 - Loss: 0.0338, Acc: 0.9893
[Final Train] Epoch 4/5 - Loss: 0.0247, Acc: 0.9924
[Final Train] Epoch 5/5 - Loss: 0.0227, Acc: 0.9936

[INFO] Evaluating final model on test set...
[RESULT] Final Test Accuracy: 0.7580

[RESULT] Classification Report:
              precision    recall  f1-score   support

      Center       0.73      0.83      0.78       832
       Donut       0.72      0.47      0.56       146
    Edge-Loc       0.74      0.90      0.81      2772
   Edge-Ring       0.98      0.55      0.70      1126
         Loc       0.72      0.72      0.72      1973
   Near-full       0.80      0.98      0.88        95
      Random       0.78      0.78      0.78       257
     Scratch       0.78      0.59      0.67       693

    accuracy                           0.76      7894
   macro avg       0.78      0.73      0.74      7894
weighted avg       0.77      0.76      0.75      7894


[INFO] Done. Logs are successfully stored in TensorBoard and the Optuna dashboard.
